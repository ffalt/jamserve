!function(e){var t={};function r(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=63)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.root=0]="root",e[e.user=1]="user",e[e.folder=2]="folder",e[e.track=3]="track",e[e.state=4]="state",e[e.playlist=5]="playlist",e[e.podcast=6]="podcast",e[e.episode=7]="episode",e[e.bookmark=8]="bookmark",e[e.album=9]="album",e[e.artist=10]="artist",e[e.playqueue=11]="playqueue",e[e.radio=12]="radio",e[e.metadata=13]="metadata",e[e.settings=14]="settings",e[e.session=15]="session",e[e.series=16]="series"}(t.DBObjectType||(t.DBObjectType={}))},function(e,t,r){"use strict";var i,s,a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.root="root",e.user="user",e.folder="folder",e.track="track",e.state="state",e.playlist="playlist",e.podcast="podcast",e.episode="episode",e.series="series",e.bookmark="bookmark",e.album="album",e.artist="artist",e.playqueue="playqueue",e.radio="radio"}(t.JamObjectType||(t.JamObjectType={})),function(e){e.auto="auto",e.artistalbum="artistalbum",e.compilation="compilation",e.audiobook="audiobook"}(t.RootScanStrategy||(t.RootScanStrategy={})),t.AudioMimeTypes={mp3:"audio/mpeg",m4a:"audio/mp4",mp4:"audio/mp4",ogg:"audio/ogg",oga:"audio/ogg",flv:"aaudio/x-flv",flac:"audio/flac",webma:"audio/webm",webm:"audio/webm",wav:"audio/wav"},function(e){e.svg="svg",e.json="json",e.dat="dat"}(i=t.WaveformFormatType||(t.WaveformFormatType={})),function(e){e.mp3="mp3",e.m4a="m4a",e.mp4="mp4",e.ogg="ogg",e.oga="oga",e.flv="flv",e.flac="flac",e.webma="webma",e.wav="wav"}(t.AudioFormatType||(t.AudioFormatType={})),t.VideoMimeTypes={mp4:"audio/mp4",m4v:"audio/mp4",ogv:"audio/ogg",webmv:"audio/webm",webm:"audio/webm"},function(e){e.unknown="unknown",e.artist="artist",e.collection="collection",e.album="album",e.multialbum="multialbum",e.extras="extras"}(s=t.FolderType||(t.FolderType={})),function(e){e.new="new",e.downloading="downloading",e.completed="completed",e.error="error",e.deleted="deleted"}(t.PodcastStatus||(t.PodcastStatus={})),t.FolderTypeImageName={unknown:"folder",artist:"artist",collection:"folder",album:"cover",multialbum:"cover",extras:"folder"},function(e){e.front="front",e.back="back",e.booklet="booklet",e.medium="medium",e.tray="tray",e.obi="obi",e.spine="spine",e.track="track",e.liner="liner",e.sticker="sticker",e.poster="poster",e.watermark="watermark",e.raw="raw",e.unedited="unedited",e.other="other",e.artist="artist"}(t.ArtworkImageType||(t.ArtworkImageType={})),t.FolderTypesAlbum=[s.album,s.multialbum],function(e){e[e.ascending=0]="ascending",e[e.descending=1]="descending"}(t.DatabaseQuerySortType||(t.DatabaseQuerySortType={})),function(e){e.unknown="unknown",e.album="album",e.compilation="compilation",e.live="live",e.bootleg="bootleg",e.soundtrack="soundtrack",e.audiobook="audiobook",e.ep="ep",e.single="single",e.series="series"}(a=t.AlbumType||(t.AlbumType={})),t.AlbumTypesArtistMusic=[a.album,a.live,a.bootleg,a.ep,a.single],function(e){e.UNKNOWN="unknown",e.AUDIO="audio",e.IMAGE="image",e.TAG="tag",e.BACKUP="backup",e.OTHER="other"}(t.FileTyp||(t.FileTyp={})),function(e){e.album="album",e.albumToptracks="album-toptracks",e.artist="artist",e.track="track",e.trackSimilar="track-similar",e.artistToptracks="artist-toptracks"}(t.LastFMLookupType||(t.LastFMLookupType={})),function(e){e.area="area",e.artist="artist",e.collection="collection",e.event="event",e.instrument="instrument",e.label="label",e.place="place",e.recording="recording",e.release="release",e.releaseGroup="release-group",e.series="series",e.work="work",e.url="url"}(t.MusicBrainzLookupType||(t.MusicBrainzLookupType={})),function(e){e.artist="artist",e.label="label",e.recording="recording",e.release="release",e.releaseGroup="release-group",e.work="work",e.area="area"}(t.MusicBrainzSearchType||(t.MusicBrainzSearchType={})),function(e){e.release="release",e.releaseGroup="release-group"}(t.CoverArtArchiveLookupType||(t.CoverArtArchiveLookupType={})),function(e){e.none="none",e.ffmpeg="ffmpeg",e.id3v20="id3v20",e.id3v21="id3v21",e.id3v22="id3v22",e.id3v23="id3v23",e.id3v24="id3v24",e.id3v1="id3v1",e.vorbis="vorbis"}(t.TrackTagFormatType||(t.TrackTagFormatType={})),function(e){e.album="Album",e.single="Single",e.ep="EP",e.broadcast="Broadcast",e.other="Other"}(t.MusicBrainzAlbumPrimaryType||(t.MusicBrainzAlbumPrimaryType={})),function(e){e.compilation="Compilation",e.soundtrack="Soundtrack",e.spokenword="Spokenword",e.interview="Interview",e.audiobook="Audiobook",e.audiodrama="Audio drama",e.live="Live",e.remix="Remix",e.djmix="DJ-mix",e.mixtape="Mixtape"}(t.MusicBrainzAlbumSecondaryType||(t.MusicBrainzAlbumSecondaryType={})),t.MUSICBRAINZ_VARIOUS_ARTISTS_ID="89ad4ac3-39f7-470e-963a-56509c546377",t.MUSICBRAINZ_VARIOUS_ARTISTS_NAME="Various Artists",t.cUnknownArtist="[Unknown Artist]",t.cUnknownAlbum="[Unknown Album]",function(e){e.tagValuesExists="track.tag.values.exists",e.id3v2Exists="track.mp3.id3v2.exists",e.id3v2Valid="track.mp3.id3v2.valid",e.id3v2Garbage="track.mp3.id3v2.garbage.frames",e.mp3HeaderExists="track.mp3.vbr.header.exists",e.mp3HeaderValid="track.mp3.vbr.header.valid",e.mp3MediaValid="track.mp3.media.valid",e.flacMediaValid="track.flac.media.valid",e.id3v2NoId3v1="track.mp3.id3v2.no.id3v1",e.mp3Garbage="track.mp3.garbage.data"}(t.TrackHealthID||(t.TrackHealthID={})),function(e){e.albumTagsExists="folder.album.tags.exists",e.albumMBIDExists="folder.album.mbid.exists",e.albumTracksComplete="folder.album.tracks.complete",e.albumNameConform="folder.album.name.conform",e.albumImageExists="folder.album.image.exists",e.albumImageValid="folder.album.image.valid",e.albumImageQuality="folder.album.image.quality",e.artistNameConform="folder.artist.name.conform",e.artistImageExists="folder.artist.image.exists",e.artistImageValid="folder.artist.image.valid"}(t.FolderHealthID||(t.FolderHealthID={})),t.AudioFormats=["mp3","m4a","mp4","ogg","oga","flv","flac","webma","wav"],t.DownloadFormats=["zip","tar"],t.DefaultDownloadFormat="zip",t.WaveformFormats=["svg","json","dat"],t.WaveformDefaultFormat=i.svg},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(68));t.configureLogger=function(e){s.default.configure({level:e,transports:[new s.default.transports.Console({format:s.default.format.combine(s.default.format.colorize(),s.default.format.simple())})]})};class a{constructor(e){this.name=e}applyLog(e,t,...r){s.default.log(e,`${(new Date).toISOString()} ${this.name}: ${[t].concat(r).join(" ")}`)}debug(e,...t){this.applyLog("debug",e,t)}info(e,...t){this.applyLog("info",e,t)}warn(e,...t){this.applyLog("warn",e,t)}error(e,...t){this.applyLog("error",e.toString(),t)}}t.Logger=a,t.logger=function(e){return new a(e)}},function(e,t){e.exports=require("path")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3));t.fileDeleteIfExists=function(e){return i(this,void 0,void 0,(function*(){(yield a.default.pathExists(e))&&(yield a.default.unlink(e))}))},t.pathDeleteIfExists=function(e){return i(this,void 0,void 0,(function*(){(yield a.default.pathExists(e))&&(yield a.default.remove(e))}))},t.fileSuffix=function(e){return n.default.extname(e).slice(1).toLowerCase()},t.fileExt=function(e){return n.default.extname(e).toLowerCase()},t.basenameStripExt=function(e){return n.default.basename(e,n.default.extname(e))},t.replaceFileSystemChars=function(e,t){return e.toString().replace(/:/g," - ").replace(/[?/!\\"]/g,t)};const o=/[<>:"/\\|?*\x00-\x1F]|^(?:aux|con|clock\$|nul|prn|com[1-9]|lpt[1-9])$/i;t.containsFolderSystemChars=function(e){return o.test(e)},t.replaceFolderSystemChars=function(e,t){return e.toString().replace(/:/g," -").replace(/[|*?/!\\<>"]/g,t)},t.ensureTrailingPathSeparator=function(e){return e.length>0&&e[e.length-1]!==n.default.sep?e+n.default.sep:e},t.removeTrailingPathSeparator=function(e){return e.length>0&&e[e.length-1]===n.default.sep?e.slice(0,e.length-1):e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(e),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor),this.failCode=t||500}}t.Errors={itemNotFound:"Item not found",invalidParameter:"Invalid/Missing parameter",internalError:"Guru Meditation",unauthorized:"Unauthorized"},t.InvalidParamError=function(e){return new i(e||t.Errors.invalidParameter,400)},t.NotFoundError=function(e){return new i(e||t.Errors.itemNotFound,404)},t.UnauthError=function(e){return new i(e||t.Errors.unauthorized,401)},t.GenericError=function(e){return new i(e||"Guru Meditation",500)}},function(e,t){e.exports=require("fs-extra")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1);t.QueryHelper=class{constructor(){this.q={}}term(e,t){null!=t&&(this.q.term=this.q.term||{},this.q.term[e]=t)}match(e,t){null!=t&&(this.q.match=this.q.match||{},this.q.match[e]=t)}startsWith(e,t){null!=t&&(this.q.startsWith=this.q.startsWith||{},this.q.startsWith[e]=t)}startsWiths(e,t){null!=t&&(this.q.startsWiths=this.q.startsWiths||{},this.q.startsWiths[e]=t)}terms(e,t){null!=t&&(this.q.terms=this.q.terms||{},this.q.terms[e]=t)}bool(e,t){null!=t&&(this.q.term=this.q.term||{},this.q.term[e]=t)}notNull(e,t){null!=t&&(this.q.notNull=this.q.notNull||[],this.q.notNull.push(e))}range(e,t,r){void 0===t&&void 0===r||(this.q.range=this.q.range||{},this.q.range[e]={gte:r,lte:t})}get(e,t){if(this.terms("id",e.ids),this.term("id",e.id),0===Object.keys(this.q).length&&(this.q.all=!0),e.sorts&&e.sorts.length>0){const r={};e.sorts.forEach(e=>{const s=t?t[e.field]:void 0;s&&(r[s]=e.descending?i.DatabaseQuerySortType.descending:i.DatabaseQuerySortType.ascending)}),this.q.sort=r}return void 0!==e.amount&&e.amount>0&&(this.q.amount=e.amount),void 0!==e.offset&&e.offset>0&&(this.q.offset=e.offset),this.q}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.BaseStore=class{constructor(e,t){this.type=e,this.client=t.getDBIndex(e)}exists(e){return i(this,void 0,void 0,(function*(){try{return!!(yield this.byId(e))}catch(e){return!1}}))}clear(){return i(this,void 0,void 0,(function*(){const e=yield this.allIds();yield this.remove(e)}))}getNewId(){return i(this,void 0,void 0,(function*(){return this.client.getNewId()}))}add(e){return i(this,void 0,void 0,(function*(){return this.client.add(e)}))}bulk(e){return i(this,void 0,void 0,(function*(){return this.client.bulk(e)}))}replace(e){return i(this,void 0,void 0,(function*(){return this.client.replace(e.id,e)}))}remove(e){return i(this,void 0,void 0,(function*(){return this.client.remove(e)}))}replaceMany(e){return i(this,void 0,void 0,(function*(){for(const t of e)yield this.client.replace(t.id,t)}))}byId(e){return i(this,void 0,void 0,(function*(){return this.client.byId(e)}))}byIds(e){return i(this,void 0,void 0,(function*(){return this.client.byIds(e)}))}random(){return i(this,void 0,void 0,(function*(){return this.client.queryOne({all:!0})}))}all(){return i(this,void 0,void 0,(function*(){return(yield this.client.query({all:!0})).items}))}allIds(){return i(this,void 0,void 0,(function*(){return this.client.queryIds({all:!0})}))}count(){return i(this,void 0,void 0,(function*(){return this.client.count({all:!0})}))}iterate(e){return i(this,void 0,void 0,(function*(){yield this.client.iterate({all:!0},e)}))}upsert(e){return i(this,void 0,void 0,(function*(){for(const t of e)yield this.client.upsert(t.id,t)}))}removeByQuery(e){return i(this,void 0,void 0,(function*(){return this.client.removeByQuery(this.transformQuery(e))}))}searchIDs(e){return i(this,void 0,void 0,(function*(){return this.client.queryIds(this.transformQuery(e))}))}search(e){return i(this,void 0,void 0,(function*(){return this.client.query(this.transformQuery(e))}))}searchOne(e){return i(this,void 0,void 0,(function*(){return this.client.queryOne(this.transformQuery(e))}))}searchCount(e){return i(this,void 0,void 0,(function*(){return this.client.count(this.transformQuery(e))}))}searchDistinct(e,t){return i(this,void 0,void 0,(function*(){return this.client.distinct(this.transformQuery(e),t)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paginate=function(e,t,r){return void 0===t||t<0?{items:e,total:e.length,amount:t,offset:r}:(r=r||0,{items:e.slice(r,r+t),total:e.length,amount:t,offset:r})}},function(e,t,r){"use strict";function i(e){return{played:e&&e.played>0?e.played:void 0,lastplayed:e&&e.lastplayed>0?e.lastplayed:void 0,faved:e?e.faved:void 0,rated:e&&void 0!==e.rated&&e.rated>0?e.rated:void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatState=i,t.formatStates=function(e){const t={};return Object.keys(e).forEach(r=>{t[r]=i(e[r])}),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseStoreService=class{constructor(e){this.store=e}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),a=r(9),n=r(15),o=r(21);class c extends o.BaseController{constructor(e,t,r,i){super(e,t,r,i),this.listService=e,this.stateService=t,this.imageService=r,this.downloadService=i}getList(e,t,r,o){return i(this,void 0,void 0,(function*(){const i=yield this.translateQuery(t,o);let c,d=[];switch(e.list){case"random":d=yield this.listService.store.searchIDs(Object.assign(Object.assign({},i),{amount:-1,offset:0})),e.amount=e.amount||20,c=d.length,d=n.randomItems(d,e.amount||20);break;case"highest":d=yield this.listService.getHighestRatedIDs(i,o),c=d.length,d=a.paginate(d,e.amount,e.offset).items;break;case"avghighest":d=yield this.listService.getAvgHighestIDs(i),c=d.length,d=a.paginate(d,e.amount,e.offset).items;break;case"frequent":d=yield this.listService.getFrequentlyPlayedIDs(i,o),c=d.length,d=a.paginate(d,e.amount,e.offset).items;break;case"faved":d=yield this.listService.getFavedIDs(i,o),c=d.length,d=a.paginate(d,e.amount,e.offset).items;break;case"recent":d=yield this.listService.getRecentlyPlayedIDs(i,o),c=d.length,d=a.paginate(d,e.amount,e.offset).items;break;default:return Promise.reject(s.InvalidParamError("Unknown List Type"))}const u=yield this.prepareListByIDs(d,r,o);return{total:c,offset:e.offset,amount:e.amount,items:u}}))}list(e){return i(this,void 0,void 0,(function*(){return this.getList(e.query,e.query,e.query,e.user)}))}download(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.downloadService.getObjDownload(t,e.query.format,e.user)}))}}t.BaseListController=c},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(11);class a extends s.BaseStoreService{constructor(e,t){super(e),this.stateService=t}getFilteredIDs(e,t){return i(this,void 0,void 0,(function*(){return(yield this.store.searchIDs(Object.assign(Object.assign({},t),{ids:e,amount:-1,offset:0}))).sort((t,r)=>e.indexOf(t)-e.indexOf(r))}))}getAvgHighestIDs(e){return i(this,void 0,void 0,(function*(){const t=yield this.stateService.getAvgHighestDestIDs(this.store.type);return this.getFilteredIDs(t,e)}))}getHighestRatedIDs(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.stateService.getHighestRatedDestIDs(this.store.type,t.id);return this.getFilteredIDs(r,e)}))}getFrequentlyPlayedIDs(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.stateService.getFrequentlyPlayedDestIDs(this.store.type,t.id);return this.getFilteredIDs(r,e)}))}getFavedIDs(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.stateService.getFavedDestIDs(this.store.type,t.id);return this.getFilteredIDs(r,e)}))}getRecentlyPlayedIDs(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.stateService.getRecentlyPlayedDestIDs(this.store.type,t.id);return this.getFilteredIDs(r,e)}))}}t.BaseListService=a},function(e,t){e.exports=require("moment")},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(41));function a(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}function n(e,t){return Math.floor(Math.random()*(t-e+1))+e}t.shuffle=a,t.randomInt=n,t.randomItem=function(e){return e[n(0,e.length-1)]},t.randomItems=function(e,t){if(void 0===t||t<0||e.length<=t)return a(e);const r=[],i=[];for(;r.length<t;){const t=n(0,e.length-1);i.includes(t)||(r.push(e[t]),i.push(t))}return r},t.randomString=function(e){return s.default.randomBytes(Math.ceil(e/2)).toString("hex").slice(0,e)}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(82)),n=r(83),o=r(5),c=r(23);function d(e,t,r){return i(this,void 0,void 0,(function*(){const i=(e||"").trim();if(!i||0===i.length)return Promise.reject(o.InvalidParamError());const s=i.split("."),a=s[0];if(!a||0===a.length)return Promise.reject(o.InvalidParamError());const n=void 0!==s[1]?s[1]:r;return void 0===n||t.includes(n)?{id:a,format:n}:Promise.reject(o.InvalidParamError())}))}!function(){const e={get:{parameters:[{in:"path",name:"pathParameter",schema:{type:"string"},required:!0}]}},t=a.default.paths;t["image/{pathParameter}"]=e,t["download/{pathParameter}"]=e,t["waveform/{pathParameter}"]=e,t["waveform_svg/{pathParameter}"]=e,t["stream/{pathParameter}"]=e}(),t.apiCheck=function(e){return function(t,r,s){(function(e,t){return i(this,void 0,void 0,(function*(){yield n.checkOpenApiParameters(e,t,a.default)}))})(e,t).then(()=>{s()}).catch(e=>{c.ApiResponder.error(t,r,o.InvalidParamError(e.message))})}},t.validatePathParameterIDFormat=d,t.validatePathParameterIDSizeFormat=function(e,t,r,s,a){return i(this,void 0,void 0,(function*(){const{id:i,format:n}=yield d(e,t,r),c=i.split("-"),u=c[0];if(!u||0===u.length)return Promise.reject(o.InvalidParamError());const l=void 0!==c[1]?Number(c[1]):void 0;if(void 0!==l){if(isNaN(l))return Promise.reject(o.InvalidParamError("parameter is not a number"));if(l<s||l>a)return Promise.reject(o.InvalidParamError("parameter number not in allowed range"))}return{id:u,format:n,size:l}}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),s=r(4);t.SupportedReadImageFormat=["png","jpeg","jpg","gif","tiff"],t.SupportedWriteImageFormat=["png","jpeg","jpg","tiff"],t.SupportedAudioFormat=[i.AudioFormatType.mp3,i.AudioFormatType.flac,i.AudioFormatType.m4a,i.AudioFormatType.mp4,i.AudioFormatType.ogg,i.AudioFormatType.oga,i.AudioFormatType.webma,i.AudioFormatType.wav],t.SupportedTranscodeAudioFormat=[i.AudioFormatType.mp3,i.AudioFormatType.flv,i.AudioFormatType.ogg,i.AudioFormatType.oga,i.AudioFormatType.flac,i.AudioFormatType.m4a],t.getFileType=function(e){const r=s.fileSuffix(e);return t.SupportedReadImageFormat.includes(r)?i.FileTyp.IMAGE:t.SupportedAudioFormat.includes(r)?i.FileTyp.AUDIO:["tag"].includes(r)?i.FileTyp.TAG:["bak"].includes(r)?i.FileTyp.BACKUP:i.FileTyp.OTHER}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(119)),n=s(r(37));t.WebserviceClient=class{constructor(e,t,r){this.enabled=!1,this.limiter=new a.default.RateLimiter(e,t),this.userAgent=r}parseResult(e,t){return i(this,void 0,void 0,(function*(){if(404===e.statusCode)return Promise.reject(Error(`${e.statusCode} ${e.statusMessage||""}`));try{return Promise.resolve(JSON.parse(t))}catch(e){return Promise.reject(e)}}))}getJson(e,t){return i(this,void 0,void 0,(function*(){if(!this.enabled)return Promise.reject(Error("External service is disabled"));const r={url:e,headers:{"User-Agent":this.userAgent},qs:t,timeout:2e4},i=this.limiter;return new Promise((e,t)=>{i.removeTokens(1,()=>{n.default(r,(r,i,s)=>{r?t(r):this.parseResult(i,s).then(e).catch(t)})})})}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(149));t.processQueue=function(e,t,r){return i(this,void 0,void 0,(function*(){if(0===t.length)return;const e=new a.default({concurrency:10});for(const s of t)e.add(()=>i(this,void 0,void 0,(function*(){yield r(s)}))).then(()=>{});yield e.onIdle()}))}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(41)),a=r(15);function n(e,t){const r=s.default.createHmac("sha512",t);return r.update(e),r.digest("hex")}t.hashSaltSHA512=n,t.hashAndSaltSHA512=function(e){const t=a.randomString(16);return{salt:t,hash:n(e,t)}},t.hashMD5=function(e){return s.default.createHash("md5").update(e).digest("hex")}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),a=r(10);t.BaseController=class{constructor(e,t,r,i){this.service=e,this.stateService=t,this.imageService=r,this.downloadService=i}byID(e){return i(this,void 0,void 0,(function*(){if(!e)return Promise.reject(s.InvalidParamError());const t=yield this.service.store.byId(e);return t||Promise.reject(s.NotFoundError())}))}byIDs(e){return i(this,void 0,void 0,(function*(){return e?this.service.store.byIds(e):Promise.reject(s.InvalidParamError())}))}prepareList(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=[];s&&(e=e.sort(s));for(const s of e){const e=yield this.prepare(s,t,r);i.push(e)}return i}))}prepareListByIDs(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=yield this.service.store.byIds(e);let a=yield this.prepareList(i,t,r,s);return s||(a=a.sort((t,r)=>e.indexOf(t.id)-e.indexOf(r.id))),a}))}prepareByID(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.byID(e);return this.prepare(i,t,r)}))}prepareByQuery(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.service.store.search(e);return i.items=this.service.defaultSort(i.items),{total:i.total,amount:i.amount,offset:i.offset,items:yield this.prepareList(i.items,t,r)}}))}id(e){return i(this,void 0,void 0,(function*(){return this.prepareByID(e.query.id,e.query,e.user)}))}ids(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids);return this.prepareList(t,e.query,e.user)}))}state(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id),r=yield this.stateService.findOrCreate(t.id,e.user.id,this.service.store.type);return a.formatState(r)}))}states(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids),r=yield this.stateService.findOrCreateMany(t.map(e=>e.id),e.user.id,this.service.store.type);return a.formatStates(r)}))}favUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id),r=yield this.stateService.fav(t.id,this.service.store.type,e.user.id,!!e.query.remove&&e.query.remove);return a.formatState(r)}))}rateUpdate(e){return i(this,void 0,void 0,(function*(){const t=e.query.rating||0;if(t<0||t>5)return Promise.reject(s.InvalidParamError());const r=yield this.byID(e.query.id),i=yield this.stateService.rate(r.id,this.service.store.type,e.user.id,t);return a.formatState(i)}))}search(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.store.search(yield this.translateQuery(e.query,e.user));return{total:t.total,amount:t.amount,offset:t.offset,items:yield this.prepareList(t.items,e.query,e.user)}}))}image(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.imageService.getObjImage(t,e.query.size,e.query.format)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatSeriesIndex=function(e){return{lastModified:e.lastModified,groups:e.groups.map(e=>({name:e.name,entries:e.entries.map(e=>({name:e.series.name,trackCount:e.series.trackIDs.length,albumCount:e.series.albumIDs.length,seriesID:e.series.id}))}))}},t.formatArtistIndex=function(e){return{lastModified:e.lastModified,groups:e.groups.map(e=>({name:e.name,entries:e.entries.map(e=>({name:e.artist.name,trackCount:e.artist.trackIDs.length,albumCount:e.artist.albumIDs.length,artistID:e.artist.id}))}))}},t.formatFolderIndex=function(e){return{lastModified:e.lastModified,groups:e.groups.map(e=>({name:e.name,entries:e.entries.map(e=>({name:e.name,trackCount:e.trackCount,folderID:e.folder.id}))}))}},t.formatAlbumIndex=function(e){return{lastModified:e.lastModified,groups:e.groups.map(e=>({name:e.name,entries:e.entries.map(e=>({id:e.album.id,name:e.album.name,artist:e.album.artist||"",artistID:e.album.artistID,trackCount:e.album.trackIDs.length}))}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(42);t.ApiResponder=class{static ok(e,t){i.ApiBaseResponder.sendJSON(e,t,{})}static data(e,t,r){i.ApiBaseResponder.sendJSON(e,t,r)}static error(e,t,r){i.ApiBaseResponder.sendError(e,t,r)}static binary(e,t,r){i.ApiBaseResponder.sendBinary(e,t,r)}}},function(e,t){e.exports=require("jamp3")},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.DebouncePromises=class{constructor(){this.pendingPromises=new Map}getPendingArray(e){return this.pendingPromises.get(e)||[]}append(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{this.pendingPromises.set(e,this.getPendingArray(e).concat([(e,i)=>{e?r(e):t(i)}]))})}))}setPending(e){this.pendingPromises.set(e,[])}isPending(e){return!!this.pendingPromises.get(e)}resolve(e,t){const r=this.getPendingArray(e);this.pendingPromises.delete(e);for(const e of r)e(null,t)}reject(e,t){const r=this.getPendingArray(e);this.pendingPromises.delete(e);for(const e of r)e(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.slugify=function(e){return e.replace(/[[\]. -]/g,"").toLowerCase()}},function(e,t,r){"use strict";function i(e){return{trackNr:e.track,disc:void 0!==e.discTotal&&e.discTotal>1?e.disc:void 0,year:e.year,title:e.title,artist:e.artist,album:e.album,genre:e.genre,mbRecordingID:e.mbRecordingID,mbReleaseTrackID:e.mbReleaseTrackID,mbReleaseGroupID:e.mbReleaseGroupID,mbTrackID:e.mbTrackID,mbArtistID:e.mbArtistID,mbReleaseID:e.mbReleaseID}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatTrackTag=i,t.formatTrack=function(e,t){return t=t||{},{id:e.id,parentID:e.parentID,artistID:e.artistID,seriesID:e.seriesID,albumArtistID:e.albumArtistID,albumID:e.albumID,name:e.name,created:e.stat.created,duration:e.media.duration||-1,media:t.trackMedia?{bitRate:e.media.bitRate,format:e.media.format||"",channels:e.media.channels,sampleRate:e.media.sampleRate,size:e.stat.size}:void 0,tag:t.trackTag?i(e.tag):void 0}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(3)),a=r(1);function n(e){return{id:e.id,name:e.name,types:e.types,format:e.image?e.image.format:void 0,height:e.image?e.image.height:void 0,width:e.image?e.image.width:void 0,size:e.stat.size}}function o(e){return e.tag.artworks?e.tag.artworks.map(n):[]}function c(e){const t=a.FolderTypesAlbum.includes(e.tag.type),r=e.tag.type===a.FolderType.artist;return{artist:t||r?e.tag.artist||a.cUnknownArtist:void 0,artistSort:t||r?e.tag.artistSort:void 0,album:t?e.tag.album||a.cUnknownAlbum:void 0,albumType:t?e.tag.albumType:void 0,genres:e.tag.genres,mbArtistID:r||t?e.tag.mbArtistID:void 0,mbReleaseID:t?e.tag.mbReleaseID:void 0,mbReleaseGroupID:t?e.tag.mbReleaseGroupID:void 0,year:t?e.tag.year:void 0}}t.formatFolderArtwork=n,t.formatFolderArtworks=o,t.formatFolder=function(e,t){return t=t||{},{id:e.id,level:e.tag?e.tag.level:-1,parentID:e.parentID,name:s.default.basename(e.path),created:e.stat.created,trackCount:t.folderCounts?e.tag.trackCount:void 0,folderCount:t.folderCounts?e.tag.folderCount:void 0,type:void 0!==e.tag.type&&a.FolderType[e.tag.type]||"unknown",tag:t.folderTag?c(e):void 0,artworks:t.folderArtworks?o(e):void 0}},t.artWorkImageNameToType=function(e){const t=e.toLowerCase(),r=[];for(const e in a.ArtworkImageType)!Number(e)&&t.includes(e)&&r.push(e);return r.includes(a.ArtworkImageType.front)||!t.includes("cover")&&!t.includes("folder")||r.push(a.ArtworkImageType.front),0===r.length&&r.push(a.ArtworkImageType.other),r.sort((e,t)=>e.localeCompare(t)),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JAMAPI_VERSION="0.1.14",t.JAMAPI_URL_VERSION="v1"},function(e,t,r){"use strict";function i(e){return{stream:!!e.stream||void 0,upload:!!e.upload||void 0,admin:!!e.admin||void 0,podcast:!!e.podcast||void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatUser=function(e){return{id:e.id,created:e.created,name:e.name,email:e.email,roles:i(e.roles)}},t.formatSessionUser=function(e){return{id:e.id,created:e.created,name:e.name,roles:i(e.roles)}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(24),n=s(r(14)),o=r(45),c=r(47);function d(e){if(e&&e.value&&e.value.bin){const t=e.value;t.bin=t.bin.toString("base64")}e&&e.subframes&&e.subframes.forEach(d)}function u(e){Object.keys(e.frames).forEach(t=>{const r=e.frames[t];r&&r.forEach(d)})}function l(e){if(e&&e.value&&e.value.bin){const t=e.value.bin;"string"==typeof t&&(e.value.bin=Buffer.from(t,"base64"))}e&&e.subframes&&e.subframes.forEach(l)}t.prepareResponseTag=u,t.flacToRawTag=function(e){return i(this,void 0,void 0,(function*(){if(!e||!e.comment||!e.comment.tag)return;const t=e.comment.tag,r=new a.ID3V24TagBuilder("utf8");r.album(t.ALBUM).albumSort(t.ALBUMSORT).originalAlbum(t.ORIGINALALBUM).originalArtist(t.ORIGINALARTIST).originalDate(t.ORIGINALDATE).title(t.TITLE).titleSort(t.TITLESORT).work(t.WORK).artist(t.ARTIST).artistSort(t.ARTISTSORT).albumArtist(t.ALBUMARTIST).albumArtistSort(t.ALBUMARTISTSORT).artists(t.ARTISTS).isCompilation(t.COMPILATION).grouping(t.GROUPING).date(t.DATE).composer(t.COMPOSER).composerSort(t.COMPOSER).remixer(t.REMIXER).label(t.LABEL).subtitle(t.SUBTITLE).discSubtitle(t.DISCSUBTITLE).lyricist(t.LYRICIST).genre(t.GENRE).bpm(t.BPM).mood(t.MOOD).lyrics(t.LYRICS).mediaType(t.MEDIA).language(t.LANGUAGE).encoder(t.ENCODEDBY||t["ENCODED-BY"]).encoderSettings(t.ENCODERSETTINGS).initialKey(t.KEY).copyright(t.COPYRIGHT).isrc(t.ISRC).barcode(t.BARCODE).asin(t.ASIN).catalogNumber(t.CATALOGNUMBER).script(t.SCRIPT).license(t.LICENSE).website(t.WEBSITE).movement(t.MOVEMENTNAME).movementNr(t.MOVEMENT,t.MOVEMENTTOTAL).writer(t.WRITER).track(t.TRACKNUMBER,t.TRACKTOTAL||t.TOTALTRACKS).disc(t.DISCNUMBER,t.DISCTOTAL||t.TOTALDISCS).musicianCredit("instrument",t.PERFORMER).involved("arranger",t.ARRANGER).involved("engineer",t.ENGINEER).involved("producer",t.PRODUCER).involved("DJ-mix",t.DJMIXER).involved("mix",t.MIXER).mbAlbumStatus(t.RELEASESTATUS).mbAlbumType(t.RELEASETYPE).mbAlbumReleaseCountry(t.RELEASECOUNTRY).mbTrackID(t.MUSICBRAINZ_TRACKID).mbReleaseTrackID(t.MUSICBRAINZ_RELEASETRACKID).mbAlbumID(t.MUSICBRAINZ_ALBUMID).mbOriginalAlbumID(t.MUSICBRAINZ_ORIGINALALBUMID).mbArtistID(t.MUSICBRAINZ_ARTISTID).mbOriginalArtistID(t.MUSICBRAINZ_ORIGINALARTISTID).mbAlbumArtistID(t.MUSICBRAINZ_ALBUMARTISTID).mbReleaseGroupID(t.MUSICBRAINZ_RELEASEGROUPID).mbWorkID(t.MUSICBRAINZ_WORKID).mbTRMID(t.MUSICBRAINZ_TRMID).mbDiscID(t.MUSICBRAINZ_DISCID).acoustidID(t.ACOUSTID_ID).acoustidFingerprint(t.ACOUSTID_FINGERPRINT).musicIPPUID(t.MUSICIP_PUID).custom("CATALOGUE",t.CATALOGUE).custom("VERSION",t.VERSION).custom("ACCURATERIPRESULT",t.ACCURATERIPRESULT).custom("UPC",t.UPC).custom("EAN",t.EAN).custom("UPN",t.UPN).custom("STYLE",t.STYLE).custom("LOCATION",t.LOCATION).custom("PERIOD",t.PERIOD).custom("SOLOISTS",t.SOLOISTS).custom("PARTNUMBER",t.PARTNUMBER).custom("LABELNO",t.LABELNO).custom("OPUS",t.OPUS).custom("PART",t.PART).custom("SOURCE",t.SOURCE).custom("SOURCEMEDIA",t.SOURCEMEDIA).custom("SHOWMOVEMENT",t.SHOWMOVEMENT).custom("ORIGINALYEAR",t.ORIGINALYEAR).custom("REPLAYGAIN_ALBUM_GAIN",t.REPLAYGAIN_ALBUM_GAIN).custom("REPLAYGAIN_ALBUM_PEAK",t.REPLAYGAIN_ALBUM_PEAK).custom("REPLAYGAIN_TRACK_GAIN",t.REPLAYGAIN_TRACK_GAIN).custom("REPLAYGAIN_TRACK_PEAK",t.REPLAYGAIN_TRACK_PEAK).comment("comment",t.COMMENT).comment("description",t.DESCRIPTION);let i=1,s=`CHAPTER${"000".substring(0,"000".length-i.toString().length)}${i.toString()}`;for(;t[s];){const e=n.default(t[s]).valueOf()||0,o=t[s+"ID"]||s,c=t[s+"NAME"],d=t[s+"URL"],u=new a.ID3V24TagBuilder("utf8");u.title(c).website(d),r.chapter(o,e,e,0,0,u.buildFrames()),i++,s=`CHAPTER${"000".substring(0,"000".length-i.toString().length)}${i.toString()}`}if(e.pictures)for(const t of e.pictures)r.picture(t.pictureType,t.description,t.mimeType,t.pictureData);const o={version:4,frames:r.rawBuilder.build()};return u(o),o}))},t.id3v2ToRawTag=function(e){return i(this,void 0,void 0,(function*(){const t={version:e.head?e.head.ver:4,frames:{}};return e.frames.forEach(e=>{const r=t.frames[e.id]||[];r.push({id:e.id,value:e.value}),t.frames[e.id]=r}),u(t),t}))},t.id3v2ToFlacMetaData=function(e,t){return i(this,void 0,void 0,(function*(){const r=a.ID3v2.simplify(e,["TSIZ","APIC"]),i=[];Object.keys(r).forEach(e=>{i.push(`${e}=${r[e].toString()}`)});const s=[c.BlockVorbiscomment.createVorbisCommentBlock("jamserve",i)],n=e.frames.filter(e=>"APIC"===e.id);for(const e of n)if(e.value.bin&&e.value.mimeType){const r=yield t.getImageInfoBuffer(e.value.bin),i=o.MetaDataBlockPicture.createPictureBlock(e.value.pictureType,e.value.mimeType,e.value.description,r.width,r.height,r.colorDepth,r.colors,e.value.bin);s.push(i)}return s}))},t.trackTagToRawTag=function(e){const t=new a.ID3V24TagBuilder("utf8");return t.artist(e.artist).album(e.album).title(e.title).genre(e.genre).track(e.track,e.trackTotal).disc(e.disc,e.discTotal).date(e.year?e.year.toString():void 0),{version:4,frames:t.rawBuilder.build()}},t.rawTagToID3v2=function(e){const t=[];return Object.keys(e.frames).map(r=>{(e.frames[r]||[]).forEach(e=>{l(e),t.push(e)})}),{id:a.ITagID.ID3v2,head:{ver:e.version,rev:0,size:0,valid:!0},start:0,end:0,frames:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MetaDataBlock=class{constructor(e,t){this.isLast=e,this.type=t,this.hasData=!1,this.removed=!1,this.error=null,this.hasData=!1,this.removed=!1}remove(){this.removed=!0}parse(e){}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(4),n=r(35),o=r(118),c=r(120),d=r(125),u=r(126),l=r(127),m=r(128),p=r(130),f=r(131),y=r(135),h=r(137),g=r(138),v=r(139);t.ID3TrackTagRawFormatTypes=[s.TrackTagFormatType.id3v20,s.TrackTagFormatType.id3v21,s.TrackTagFormatType.id3v22,s.TrackTagFormatType.id3v23,s.TrackTagFormatType.id3v24];t.AudioModule=class{constructor(e,t,r,i){this.imageModule=i,this.musicbrainz=new m.MusicbrainzClient({userAgent:r.musicbrainz.userAgent,retryOn:!0}),this.acousticbrainz=new o.AcousticbrainzClient({userAgent:r.acousticbrainz.userAgent,retryOn:!0}),this.lastFM=new u.LastFMClient({key:r.lastfm.apiKey,userAgent:r.lastfm.userAgent}),this.acoustid=new c.AcoustidClient({key:r.acoustid.apiKey,userAgent:r.acoustid.userAgent}),this.lyricsOVH=new l.LyricsOVHClient(r.chartlyrics.userAgent),this.wikipedia=new p.WikipediaClient(r.wikipedia.userAgent),this.coverArtArchive=new d.CoverArtArchiveClient({userAgent:r.coverartarchive.userAgent,retryOn:!0}),this.transcoder=new g.TranscoderModule(t),this.mp3=new y.AudioModuleMP3,this.flac=new f.AudioModuleFLAC(i),this.waveform=new v.WaveformModule(e)}setSettings(e){const t=e&&e.enabled;this.musicbrainz.enabled=t,this.acoustid.enabled=t,this.lastFM.enabled=t,this.lyricsOVH.enabled=t,this.acousticbrainz.enabled=t,this.coverArtArchive.enabled=t,this.wikipedia.enabled=t}read(e){return i(this,void 0,void 0,(function*(){const t=a.fileSuffix(e);if(t===s.AudioFormatType.mp3)return this.mp3.read(e);if(t===s.AudioFormatType.flac)return this.flac.read(e);const r=yield h.probe(e,[]);return r?{tag:n.FORMAT.packProbeJamServeTag(r),media:n.FORMAT.packProbeJamServeMedia(r,t)}:{tag:{format:s.TrackTagFormatType.none},media:{}}}))}readRawTag(e){return i(this,void 0,void 0,(function*(){const t=a.fileSuffix(e);return t===s.AudioFormatType.mp3?this.mp3.readRaw(e):t===s.AudioFormatType.flac?this.flac.readRaw(e):void 0}))}writeRawTag(e,t){return i(this,void 0,void 0,(function*(){const r=a.fileSuffix(e);try{if(r===s.AudioFormatType.mp3)yield this.mp3.write(e,t);else{if(r!==s.AudioFormatType.flac)return Promise.reject(new Error(`Writing to format ${r} is currently not supported`));yield this.flac.write(e,t)}}catch(e){return Promise.reject(e)}}))}extractTagImage(e){return i(this,void 0,void 0,(function*(){const t=a.fileSuffix(e);return t===s.AudioFormatType.mp3?this.mp3.extractTagImage(e):t===s.AudioFormatType.flac?this.flac.extractTagImage(e):void 0}))}clearCacheByIDs(e){return i(this,void 0,void 0,(function*(){yield this.transcoder.clearCacheByIDs(e),yield this.waveform.clearCacheByIDs(e)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(24),s=r(1),a=r(116),n=r(34);class o{static packJamServeMedia(e){return e?{format:s.AudioFormatType.mp3,duration:e.durationEstimate,bitRate:e.bitRate,sampleRate:e.sampleRate,channels:e.channels,encoded:e.encoded,mode:e.mode,version:`${e.version} ${e.layer}`}:{}}static packProbeJamServeMedia(e,t){if(!e.streams)return{};const r=e.streams.filter(e=>"audio"===e.codec_type)[0];return r?{format:t,duration:Number(e.format.duration),bitRate:Number(e.format.bit_rate),sampleRate:Number(r.sample_rate),channels:r.channels,mode:r.channel_layout,version:r.codec_long_name}:{}}static packFlacMediaInfoJamServeMedia(e){return e?{format:s.AudioFormatType.flac,duration:e.duration,sampleRate:e.sampleRate,encoded:"VBR",channels:e.channels}:{}}static parseNum(e){if(void 0!==e){const t=Number(e.trim());if(isNaN(t))return;return t}}static parseYear(e){if(void 0!==e&&4===(e=e.slice(0,4).trim()).length){const t=Number(e);if(isNaN(t))return;return t}}static packProbeJamServeTag(e){if(!e||!e.format||!e.format.tags)return{format:s.TrackTagFormatType.none};const t={};return Object.keys(e.format.tags).forEach(r=>{t[r.toUpperCase().replace(/ /g,"_")]=o.cleanText(e.format.tags[r])}),{format:s.TrackTagFormatType.ffmpeg,artist:t.ARTIST,title:t.TITLE,album:t.ALBUM,year:o.parseNum(t.DATE),track:o.parseNum(t.TRACK),disc:o.parseNum(t.DISC),lyrics:t.LYRICS,seriesNr:t.WORK,series:t.GROUPING,genre:t.GENRE?a.cleanGenre(t.GENRE):void 0,albumArtist:t.ALBUM_ARTIST,albumSort:t.ALBUM_SORT||t.ALBUM_SORT_ORDER,albumArtistSort:t.ALBUM_ARTIST_SORT||t.ALBUM_ARTIST_SORT_ORDER,artistSort:t.ARTIST_SORT||t.ARTIST_SORT_ORDER,titleSort:t.TITLE_SORT||t.TITLE_SORT_ORDER,mbTrackID:t.TRACKID,mbAlbumType:t.ALBUMTYPE,mbAlbumArtistID:t.ALBUMARTISTID,mbArtistID:t.ARTISTID,mbReleaseID:t.ALBUMID,mbReleaseTrackID:t.RELEASETRACKID,mbReleaseGroupID:t.RELEASEGROUPID,mbRecordingID:t.RECORDINGID,mbAlbumStatus:t.ALBUMSTATUS,mbReleaseCountry:t.RELEASECOUNTRY}}static packID3v1JamServeTag(e){if(!e)return;const t=e.value;return{format:s.TrackTagFormatType.id3v1,artist:o.cleanText(t.artist),title:o.cleanText(t.title),album:o.cleanText(t.album),year:o.parseNum(t.year),track:t.track,genre:void 0!==t.genreIndex&&i.ID3v1_GENRES[t.genreIndex]?i.ID3v1_GENRES[t.genreIndex]:void 0}}static packID3v2JamServeTag(e){if(!e)return;const t=i.ID3v2.simplify(e,["CHAP","APIC"]),r=e.frames.filter(e=>"APIC"===e.id);return{format:n.ID3TrackTagRawFormatTypes[e.head?e.head.rev:-1]||s.TrackTagFormatType.none,album:o.cleanText(t.ALBUM),albumSort:o.cleanText(t.ALBUMSORT),albumArtist:o.cleanText(t.ALBUMARTIST),albumArtistSort:o.cleanText(t.ALBUMARTISTSORT),artist:o.cleanText(t.ARTIST),artistSort:o.cleanText(t.ARTISTSORT),title:o.cleanText(t.TITLE),titleSort:o.cleanText(t.TITLESORT),genre:t.GENRE?a.cleanGenre(t.GENRE):void 0,disc:o.parseNum(t.DISCNUMBER),discTotal:o.parseNum(t.DISCTOTAL),track:o.parseNum(t.TRACKNUMBER),trackTotal:o.parseNum(t.TRACKTOTAL),lyrics:t.LYRICS,seriesNr:t.WORK,series:t.GROUPING,year:o.parseYear(t.ORIGINALDATE)||o.parseYear(t.DATE)||o.parseYear(t.RELEASETIME),mbTrackID:t.MUSICBRAINZ_TRACKID,mbAlbumType:t.RELEASETYPE,mbAlbumArtistID:t.MUSICBRAINZ_ALBUMARTISTID,mbArtistID:t.MUSICBRAINZ_ARTISTID,mbReleaseID:t.MUSICBRAINZ_ALBUMID,mbReleaseTrackID:t.MUSICBRAINZ_RELEASETRACKID,mbReleaseGroupID:t.MUSICBRAINZ_RELEASEGROUPID,mbRecordingID:t.MUSICBRAINZ_RELEASETRACKID,mbAlbumStatus:t.RELEASESTATUS,mbReleaseCountry:t.RELEASECOUNTRY,nrTagImages:r.length}}static cleanText(e){return void 0!==e?e.replace(/ {2}/g," ").trim():void 0}static packFlacVorbisCommentJamServeTag(e,t){if(!e||!e.tag)return;const r=e.tag;return{format:s.TrackTagFormatType.vorbis,album:r.ALBUM,albumSort:r.ALBUMSORT,albumArtist:r.ALBUMARTIST,albumArtistSort:r.ALBUMARTISTSORT,artist:r.ARTIST,artistSort:r.ARTISTSORT,genre:r.GENRE?a.cleanGenre(r.GENRE):void 0,disc:o.parseNum(r.DISCNUMBER),discTotal:o.parseNum(r.DISCTOTAL)||o.parseNum(r.TOTALDISCS),title:r.TITLE,titleSort:r.TITLESORT,track:o.parseNum(r.TRACKNUMBER)||o.parseNum(r.TRACK),trackTotal:o.parseNum(r.TRACKTOTAL)||o.parseNum(r.TOTALTRACKS),year:o.parseYear(r.ORIGINALYEAR)||o.parseYear(r.ORIGINALDATE)||o.parseYear(r.DATE),lyrics:r.LYRICS,seriesNr:r.WORK,series:r.GROUPING,mbTrackID:r.MUSICBRAINZ_TRACKID,mbAlbumType:r.RELEASETYPE,mbAlbumArtistID:r.MUSICBRAINZ_ALBUMARTISTID,mbArtistID:r.MUSICBRAINZ_ARTISTID,mbReleaseID:r.MUSICBRAINZ_ALBUMID,mbReleaseTrackID:r.MUSICBRAINZ_RELEASETRACKID,mbReleaseGroupID:r.MUSICBRAINZ_RELEASEGROUPID,mbRecordingID:r.MUSICBRAINZ_RELEASETRACKID,mbAlbumStatus:r.RELEASESTATUS,mbReleaseCountry:r.RELEASECOUNTRY,nrTagImages:t?t.length:void 0}}}t.FORMAT=o},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),a=r(18),n=s.logger("WebserviceJSONClient");class o extends a.WebserviceClient{constructor(e,t,r,i){super(e,t,r);this.options=Object.assign(Object.assign({},{port:80,basePath:"",userAgent:"",limit:25,retryOn:!1,retryDelay:3e3,retryCount:3}),i)}reqToHost(e){const t=80!==this.options.port?":"+this.options.port:"";return`${this.options.host}${t}`}reqToUrl(e){const t=Object.keys(e.query).filter(t=>void 0!==e.query[t]&&null!==e.query[t]).map(t=>`${t}=${e.query[t]}`),r=t.length>0?"?"+t.join("&"):"";return`${this.reqToHost(e)}${e.path}${r}`}retry(e,t){return i(this,void 0,void 0,(function*(){return this.options.retryOn&&t.retry<(this.options.retryCount||0)?(t.retry++,n.info(`rate limit hit, retrying in ${this.options.retryDelay}ms`),new Promise((e,r)=>{setTimeout(()=>{this.get(t).then(e).catch(r)},this.options.retryDelay)})):Promise.reject(e)}))}processError(e,t){return i(this,void 0,void 0,(function*(){const r=e.statusCode;return 502===r||503===r?this.retry(e,t):(n.error(e),Promise.reject(e))}))}isRateLimitError(e){return e&&e.error&&e.error.includes("allowable rate limit")}get(e){return i(this,void 0,void 0,(function*(){const t=this.reqToUrl(e);n.info("requesting",t,JSON.stringify(e));try{const r=yield this.getJson(t,void 0);return this.isRateLimitError(r)?this.retry(Error(r.error),e):r}catch(t){return this.processError(t,e)}}))}}t.WebserviceJSONClient=o},function(e,t){e.exports=require("request")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(122),a=r(123);function n(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield a.getBinPath(e,t);return i&&0!==i.length?new Promise((e,t)=>{const a=s.spawn(i,r);if(!a.stdout||!a.stderr)return t(Error("Unsupported std out"));let n="",o="";a.stdout.on("data",e=>{n+=e.toString()}),a.stderr.on("data",e=>{o+=e.toString()}),a.on("close",t=>{e({result:n,errMsg:o})})}):Promise.reject(Error("Tool binary not found "+e))}))}t.spawnTool=n,t.spawnToolJson=function(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield n(e,t,r);return JSON.parse(i.result)}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(26);t.IDFolderCache=class{constructor(e,t,r){this.dataPath=e,this.filePrefix=t,this.resolveParams=r,this.cacheDebounce=new o.DebouncePromises}prefixCacheFilename(e){return`${this.filePrefix}-${e}`}cacheFilename(e,t){return`${this.prefixCacheFilename(e)}${this.resolveParams(t)}`}removeByIDs(e){return i(this,void 0,void 0,(function*(){const t=e.filter(e=>e.length>0).map(e=>this.prefixCacheFilename(e));if(t.length>0){let e=yield a.default.readdir(this.dataPath);e=e.filter(e=>t.findIndex(t=>e.startsWith(t))>=0);for(const t of e)yield a.default.unlink(n.default.resolve(this.dataPath,t))}}))}getExisting(e,t){return i(this,void 0,void 0,(function*(){const r=this.cacheFilename(e,t);if(this.cacheDebounce.isPending(r))return this.cacheDebounce.append(r);const i=n.default.join(this.dataPath,r);return(yield a.default.pathExists(i))?{file:{filename:i,name:r}}:void 0}))}get(e,t,r){return i(this,void 0,void 0,(function*(){const i=this.cacheFilename(e,t);if(this.cacheDebounce.isPending(i))return this.cacheDebounce.append(i);this.cacheDebounce.setPending(i);try{const e=n.default.join(this.dataPath,i);(yield a.default.pathExists(e))||(yield r(e));const t={file:{filename:e,name:i}};return this.cacheDebounce.resolve(i,t),t}catch(e){return this.cacheDebounce.reject(i,e),Promise.reject(e)}}))}}},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("crypto")},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(3));class a{static sendJSONP(e,t,r,i){t.writeHead(200,{"Content-Type":"application/javascript"}),t.end(`${r}(${JSON.stringify(i)});`)}static sendJSON(e,t,r){t.status(200).json(r)}static sendXML(e,t,r){t.set("Content-Type","application/xml"),t.status(200).send(r)}static sendError(e,t,r){const i=("string"==typeof r?r:r.message||"Guru Meditation").toString(),s="number"==typeof r.failCode?r.failCode:500;a.sendErrorMsg(e,t,s||500,i)}static sendErrorMsg(e,t,r,i){t.status(r).json({error:i})}static sendBinary(e,t,r){r.json?a.sendJSON(e,t,r.json):r.pipe?r.pipe.pipe(t):r.buffer?(t.set("Content-Type",r.buffer.contentType),t.set("Content-Length",r.buffer.buffer.length.toString()),t.status(200).send(r.buffer.buffer)):r.file&&t.sendFile(r.file.filename,{filename:r.file.name||s.default.basename(r.file.filename)})}}t.ApiBaseResponder=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(28);function s(e){return e.map(e=>({start:e.start,title:e.title}))}t.formatChapters=s,t.formatEpisode=function(e,t,r){return{id:e.id,parentID:"",created:e.stat?e.stat.created:0,podcastID:e.podcastID,podcast:e.podcast,status:r,errorMessage:e.error,name:e.name,duration:e.media?e.media.duration||-1:e.duration?e.duration:-1,date:e.date,summary:e.summary,guid:e.guid,author:e.author,link:e.link,media:t.trackMedia&&e.media?{bitRate:e.media.bitRate||-1,format:e.media.format||"",channels:e.media.channels||-1,sampleRate:e.media.sampleRate||-1,size:(e.stat?e.stat.size:-1)||-1}:void 0,tag:t.trackTag&&e.tag?i.formatTrackTag(e.tag):void 0,chapters:e.chapters&&e.chapters.length>0?s(e.chapters):void 0}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(1),o=r(13);function c(e){return i(this,void 0,void 0,(function*(){if(e.tag&&e.tag.artworks)return e.tag.type===n.FolderType.artist?e.tag.artworks.find(e=>e.types.includes(n.ArtworkImageType.artist)):e.tag.artworks.find(e=>e.types.includes(n.ArtworkImageType.front))}))}t.getFolderDisplayImage=c;class d extends o.BaseListService{constructor(e,t,r,i){super(e,r),this.folderStore=e,this.trackStore=t,this.imageModule=i}defaultSort(e){return e.sort((e,t)=>(e.tag&&e.tag.title?e.tag.title:a.default.basename(e.path)).localeCompare(t.tag&&t.tag.title?t.tag.title:a.default.basename(t.path)))}collectFolderPath(e,t){return i(this,void 0,void 0,(function*(){const r=[],s=this.folderStore;return yield function e(a){return i(this,void 0,void 0,(function*(){if(!a)return;let i;t&&(i=t.find(e=>e.id===a)),i||(i=yield s.byId(a),t&&i&&t.push(i)),i&&(r.unshift(i),yield e(i.parentID))}))}(e),r}))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield c(e);if(i)return this.getArtworkImage(e,i,t,r)}))}getArtworkImage(e,t,r,s){return i(this,void 0,void 0,(function*(){return this.imageModule.get(t.id,a.default.join(e.path,t.name),r,s)}))}}t.FolderService=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(46);class s extends i.MetaWriteableDataBlock{constructor(e){super(e,6),this.pictureType=0,this.mimeType="",this.description="",this.width=0,this.height=0,this.bitsPerPixel=0,this.colors=0}static createPictureBlock(e,t,r,i,a,n,o,c){const d=new s(!1);return d.pictureType=e,d.mimeType=t,d.description=r,d.width=i,d.height=a,d.bitsPerPixel=n,d.colors=o,d.pictureData=c,d.hasData=!0,d}parse(e){try{let t=0;this.pictureType=e.readUInt32BE(t),t+=4;const r=e.readUInt32BE(t);this.mimeType=e.toString("utf8",t+4,t+4+r),t+=r+4;const i=e.readUInt32BE(t);this.description=e.toString("utf8",t+4,t+4+i),t+=i+4,this.width=e.readUInt32BE(t),this.height=e.readUInt32BE(t+4),this.bitsPerPixel=e.readUInt32BE(t+8),this.colors=e.readUInt32BE(t+12),t+=16;const s=e.readUInt32BE(t);this.pictureData=Buffer.alloc(s),e.copy(this.pictureData,0,t+4,s),this.hasData=!0}catch(e){this.error=e,this.hasData=!1}}publish(){let e=0;const t=this.getSize(),r=Buffer.alloc(t+4);if(this.pictureData){let i=t;i|=this.type<<24,i|=this.isLast?2147483648:0,r.writeUInt32BE(i>>>0,e),e+=4,r.writeUInt32BE(this.pictureType,e),e+=4;const s=Buffer.byteLength(this.mimeType);r.writeUInt32BE(s,e),r.write(this.mimeType,e+4),e+=s+4;const a=Buffer.byteLength(this.description);r.writeUInt32BE(a,e),r.write(this.description,e+4),e+=a+4,r.writeUInt32BE(this.width,e),r.writeUInt32BE(this.height,e+4),r.writeUInt32BE(this.bitsPerPixel,e+8),r.writeUInt32BE(this.colors,e+12),e+=16,r.writeUInt32BE(this.pictureData.length,e),this.pictureData.copy(r,e+4)}return r}getSize(){return Buffer.byteLength(this.mimeType)+4+Buffer.byteLength(this.description)+4+16+(this.pictureData?this.pictureData.length:0)+4}}t.MetaDataBlockPicture=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(33);class s extends i.MetaDataBlock{}t.MetaWriteableDataBlock=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(46);class s extends i.MetaWriteableDataBlock{constructor(e){super(e,4),this.vendor="",this.comments=[]}static createVorbisCommentBlock(e,t){const r=new s(!1);return r.vendor=e,r.comments=t,r.hasData=!0,r}parse(e){try{let t=0;const r=e.readUInt32LE(t);this.vendor=e.toString("utf8",t+4,t+r+4),t+=r+4;let i=e.readUInt32LE(t);for(t+=4;i-- >0;){const r=e.readUInt32LE(t),i=e.toString("utf8",t+4,t+r+4);this.comments.push(i),t+=r+4}this.hasData=!0}catch(e){this.error=e,this.hasData=!1}}publish(){let e=0;const t=this.getSize(),r=Buffer.alloc(t+4);let i=t;i|=this.type<<24,i|=this.isLast?2147483648:0,r.writeUInt32BE(i>>>0,e),e+=4;const s=Buffer.byteLength(this.vendor);r.writeUInt32LE(s,e),r.write(this.vendor,e+4),e+=s+4;const a=this.comments.length;r.writeUInt32LE(a,e),e+=4;for(let t=0;t<a;t++){const i=this.comments[t],s=Buffer.byteLength(i);r.writeUInt32LE(s,e),r.write(i,e+4),e+=s+4}return r}getSize(){let e=Buffer.byteLength(this.vendor)+8;for(const t of this.comments)e+=Buffer.byteLength(t)+4;return e}}t.BlockVorbiscomment=s},function(e,t){e.exports=require("stream")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(50)),n=r(1),o=r(17),c=r(2).logger("transcoder.stream");class d{static needsTranscoding(e,t,r){return t!==e||r>0}static validTranscoding(e){return o.SupportedTranscodeAudioFormat.includes(e)}static getAvailableFormats(){return i(this,void 0,void 0,(function*(){return new Promise((e,t)=>{a.default().getAvailableFormats((r,i)=>{if(r||!i)return t(r);e(Object.keys(i).filter(e=>i[e].canDemux).map(e=>({format:e,name:i[e].description})))})})}))}static getTranscodeProc(e,t,r){const i=a.default({source:e}).withNoVideo();switch(t){case n.AudioFormatType.flv:return i.toFormat(t).addOptions(["-ar 44100",`-maxrate ${r||128}k`]);case n.AudioFormatType.ogg:case n.AudioFormatType.oga:return i.toFormat(t).withAudioCodec("libvorbis").addOptions([`-maxrate ${r||128}k`]);case n.AudioFormatType.mp3:return i.toFormat(t).withAudioBitrate((r||128)+"k").withAudioCodec("libmp3lame");case n.AudioFormatType.m4a:return i.toFormat("mp4").withAudioBitrate((r||128)+"k");default:return i.toFormat(t).withAudioBitrate((r||128)+"k")}}static transcodeToFile(e,t,r,s){return i(this,void 0,void 0,(function*(){return new Promise((i,a)=>{d.getTranscodeProc(e,r,s).on("start",e=>{c.debug("ffmpeg started with "+e)}).on("end",()=>{i()}).on("error",e=>{a(e)}).save(t)})}))}}t.TranscoderStream=d},function(e,t){e.exports=require("fluent-ffmpeg")},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(14));t.getMaxAge=function(e){let t=0;return e.value>0&&(t=s.default.duration(e.value,e.unit).asMilliseconds()),t}},function(e,t){e.exports=require("express-session")},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=53},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={type:"boolean"},s={type:"long"},a={type:"text",fields:{keyword:{type:"keyword"}}},n={type:"keyword"},o={properties:{name:a,path:n,created:s,strategy:n,id:n,type:s}},c={properties:{name:a,salt:n,hash:n,email:n,created:s,scrobblingEnabled:i,maxBitRate:s,allowedFolder:n,roles:{properties:{stream:i,upload:i,admin:i,podcast:i}},id:n,type:s}},d={properties:{rootID:n,path:n,parentID:n,tag:{properties:{level:s,trackCount:s,folderCount:s,type:n,genres:n,album:n,artist:n,artistSort:n,albumType:n,albumTrackCount:s,title:a,year:s,mbReleaseID:n,mbReleaseGroupID:n,mbAlbumType:n,mbArtistID:n,artworks:{properties:{id:n,name:a,types:n,image:{properties:{width:s,height:s,format:n}}}}}},id:n,type:s}},u={properties:{userID:n,trackIDs:n,currentID:n,position:s,changed:s,changedBy:n,id:n,type:s}},l={properties:{format:n,album:n,albumSort:n,albumArtist:n,albumArtistSort:n,artist:n,artistSort:n,genre:n,disc:s,discTotal:s,title:a,titleSort:n,track:s,trackTotal:s,year:s,nrTagImages:s,mbTrackID:n,mbAlbumType:n,mbAlbumArtistID:n,mbArtistID:n,mbReleaseID:n,mbReleaseTrackID:n,mbReleaseGroupID:n,mbRecordingID:n,mbAlbumStatus:n,mbReleaseCountry:n,series:n,seriesNr:n,lyrics:n,chapters:{properties:{start:s,end:s,title:a}}}},m={properties:{duration:s,bitRate:s,format:n,sampleRate:s,channels:s,encoded:n,mode:n,version:n}},p={properties:{rootID:n,parentID:n,name:a,path:n,seriesID:n,albumID:n,artistID:n,albumArtistID:n,tag:l,media:m,id:n,type:s}},f={properties:{slug:n,name:a,genres:n,rootIDs:n,trackIDs:n,folderIDs:n,albumType:n,series:n,seriesID:n,seriesNr:n,artistID:n,artist:n,year:s,duration:s,created:s,mbArtistID:n,mbReleaseID:n,id:n,type:s}},y={properties:{slug:n,name:a,nameSort:n,rootIDs:n,trackIDs:n,folderIDs:n,albumIDs:n,seriesIDs:n,albumTypes:n,mbArtistID:n,genres:n,created:s,id:n,type:s}},h={properties:{name:a,url:n,homepage:n,disabled:i,created:s,changed:s,id:n,type:s}},g={properties:{userID:n,destID:n,destType:s,played:s,lastplayed:s,faved:s,rated:s,id:n,type:s}},v={properties:{name:a,userID:n,comment:n,coverArt:n,changed:s,created:s,allowedUser:n,isPublic:i,duration:s,trackIDs:n,id:n,type:s}},b={properties:{url:n,created:s,lastCheck:s,status:n,image:n,errorMessage:n,tag:{properties:{title:a,link:n,author:n,description:n,generator:n,image:n,categories:n}},id:n,type:s}},k={properties:{podcastID:n,podcast:n,status:n,error:n,path:n,link:n,summary:n,date:s,duration:s,name:a,guid:n,author:n,chapters:{properties:{start:s,title:a}},enclosures:{properties:{url:n,type:n,length:s}},tag:l,media:m,id:n,type:s}},I={properties:{destID:n,userID:n,comment:n,created:s,changed:s,position:s,id:n,type:s}},q={properties:{date:s,name:a,dataType:s,id:n,type:s}},D={properties:{section:n,version:n,id:n,type:s}},S={properties:{userID:n,client:n,agent:n,expires:s,mode:n,sessionID:n,cookie:n,jwth:n,id:n,type:s}},w={properties:{name:a,artist:n,artistID:n,rootIDs:n,albumIDs:n,folderIDs:n,trackIDs:n,albumTypes:n,created:s,id:n,type:s}};t.mapping={root:o,user:c,folder:d,playqueue:u,track:p,album:f,artist:y,radio:h,state:g,playlist:v,podcast:b,episode:k,bookmark:I,metadata:q,settings:D,session:S,series:w}},function(e,t,r){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(179));t.JAMSERVE_VERSION=s.version},function(e,t){e.exports=require("sharp")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(25)),n=s(r(183)),o=s(r(37)),c=r(4);t.downloadFile=function(e,t){return i(this,void 0,void 0,(function*(){return new Promise((r,i)=>{o.default.get(e).on("error",e=>{i(e)}).on("complete",e=>{200!==e.statusCode?c.fileDeleteIfExists(t).then(()=>{i(new Error(n.default.STATUS_CODES[e.statusCode]))}).catch(t=>{i(new Error(n.default.STATUS_CODES[e.statusCode]))}):r()}).pipe(a.default.createWriteStream(t))})}))}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(193)),a=r(4),n=r(2).logger("BaseCompressStream");class o{constructor(e,t){if(this.streaming=!0,this.filename=a.replaceFileSystemChars(e,"_").replace(/ /g,"_"),this.format=t||"zip",!o.isSupportedFormat(this.format))throw new Error("Unsupported Download Format")}static isSupportedFormat(e){return["zip","tar"].includes(e)}pipe(e){const t=s.default(this.format,{zlib:{level:0}});t.on("error",e=>{throw e}),e.contentType("zip"),e.setHeader("Content-Disposition",`attachment; filename="${this.filename||"download"}.zip"`),e.on("finish",()=>{this.streaming=!1}),t.pipe(e),this.run(t),t.finalize().catch(e=>n.error(e))}}t.BaseCompressStream=o},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(13);function n(e,t){return i(this,void 0,void 0,(function*(){const r=yield e.byIds(t.trackIDs),i={};r.forEach(e=>{i[e.id]=e}),t.trackIDs=t.trackIDs.filter(e=>!!i[e]),t.duration=0,t.trackIDs.forEach(e=>{const r=i[e];t.duration+=r.media.duration||0})}))}t.updatePlayListTracks=n;class o extends a.BaseListService{constructor(e,t,r){super(e,r),this.playlistStore=e,this.trackStore=t}defaultSort(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}create(e,t,r,a,o){return i(this,void 0,void 0,(function*(){const i=Date.now(),c={id:"",type:s.DBObjectType.playlist,name:e,comment:t,isPublic:r,userID:a,created:i,changed:i,trackIDs:o,duration:0};return yield n(this.trackStore,c),c.id=yield this.playlistStore.add(c),c}))}update(e){return i(this,void 0,void 0,(function*(){yield n(this.trackStore,e),yield this.playlistStore.replace(e)}))}remove(e){return i(this,void 0,void 0,(function*(){yield this.playlistStore.remove(e.id)}))}}t.PlaylistService=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(20);t.generateArtworkId=function(e,t,r){return`${e}-${i.hashMD5(`${t}${r}${t}`)}`}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractAlbumName=function(e){const t=e.replace(/\(((\d\d\d\d)|(\d* ?cds)|(cd ?\d*)|(disc ?\d*)|(disc ?\d*:.*)|(bonus.*)|(.*edition)|(.*retail)|(\d* of \d*)|(eps?|bootleg|deluxe|promo|single|lp|limited edition|retro|ost|uvs|demp|demos|remastered|remix|live|remixes|vinyl|collection|maxi|bonus disc))\)/gi,"").replace(/\[((\d\d\d\d)|(\d* ?cds)|(cd ?\d*)|(disc ?\d*)|(disc ?\d*:.*)|(bonus.*)|(.*edition)|(.*retail)|(\d* of \d*)|(eps?|bootleg|deluxe|promo|single|lp|limited edition|retro|ost|uvs|demp|demos|remastered|remix|live|remixes|vinyl|collection|maxi|bonus disc))\]/gi,"").replace(/-? cd\d*/gi,"").trim();return 0===t.length?e.trim():t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(27);class s{constructor(){this.stats={}}static convert2Numlist(e){return Object.keys(e).map(t=>({count:e[t].count,val:Number(e[t].val)})).sort((e,t)=>e.count-t.count)}static convert2list(e){return Object.keys(e).map(t=>e[t]).sort((e,t)=>e.count-t.count)}static getMostUsedTagValue(e,t){if(0===e.length)return;if(1===e.length)return e[0].val;if((e=e.sort((e,t)=>t.count-e.count))[0].count-e[1].count>4)return e[0].val;if(e.length>3&&void 0!==t)return t;const r=e.filter(e=>e.count>1);return r.length>1&&void 0!==t?t:r.length>0?r[0].val:void 0!==t?t:e[0].val}statID(e,t){if(t&&t.trim().length>0){const r=t.split(" ")[0].trim();this.stats[e]=this.stats[e]||{},this.stats[e][r]=this.stats[e][t]||{count:0,val:r},this.stats[e][r].count+=1}}statNumber(e,t){if(void 0!==t){const r=t.toString();this.stats[e]=this.stats[e]||{},this.stats[e][r]=this.stats[e][r]||{count:0,val:t},this.stats[e][r].count+=1}}statSlugValue(e,t){if(t&&t.trim().length>0){const r=i.slugify(t);this.stats[e]=this.stats[e]||{},this.stats[e][r]=this.stats[e][r]||{count:0,val:t.trim()},this.stats[e][r].count+=1}}statTrackCount(e,t,r){if(void 0!==t){const i=`${void 0!==r?r:1}-${t}`;this.stats[e]=this.stats[e]||{},this.stats[e][i]=this.stats[e][i]||{count:0,val:t},this.stats[e][i].count+=1}}asList(e){return s.convert2list(this.stats[e]||{})}asStringList(e){return s.convert2list(this.stats[e]||{}).sort((e,t)=>e.count-t.count).map(e=>e.val)}asNumberList(e){return s.convert2Numlist(this.stats[e]||{})}mostUsed(e,t){const r=this.asList(e);return s.getMostUsedTagValue(r,t)}mostUsedNumber(e){const t=this.asNumberList(e);return s.getMostUsedTagValue(t)}}t.MetaStatBuilder=s},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(64)),n=r(65),o=r(168),c=r(169),d=r(174),u=r(177),l=r(245),m=r(2),p=r(55);a.default.version(p.JAMSERVE_VERSION,"-v, --version").usage("[options]").option("-r, --reset","reset the db").option("-c, --config <folder>","config file folder").parse(process.argv);const f=o.loadConfig(a.default.config);m.configureLogger(f.log.level);const y=m.logger("JamServe"),h="elasticsearch"===f.database.use?new c.DBElastic(f.database.options.elasticsearch):new d.DBNedb(f.getDataPath(["nedb"])),g=new l.Store(h),v=new u.Engine(f,g,p.JAMSERVE_VERSION),b=new n.Server(v);a.default.reset?function(){return i(this,void 0,void 0,(function*(){y.info(`Jamserve ${v.version} cleaning DB`),yield v.store.open(),yield v.store.reset(),y.info(`Jamserve ${v.version} removing cache files`),yield v.clearLocalFiles(),yield v.store.close()}))}().then(()=>{console.log("done.")}).catch(e=>{console.error(e)}):(process.on("SIGTERM",()=>{(function(){return i(this,void 0,void 0,(function*(){try{yield b.stop(),yield v.stop(),process.exit()}catch(e){console.error("Error on server stop",e),process.exit(1)}}))})().catch(e=>{console.error(e)})}),function(){return i(this,void 0,void 0,(function*(){try{y.info(`Jamserve ${v.version} starting`),yield v.start(),yield b.start();const e=yield v.settingsService.settingsVersion(),t=!!e&&e!==v.version;t&&y.info("Updating from version "+(e||"-")),(t||v.settingsService.settings.library.scanAtStart)&&v.ioService.refresh(t).then(()=>t?v.settingsService.saveSettings():void 0).catch(e=>{console.error("Error on startup scanning",e)})}catch(e){return void console.error("Error on startup",e)}}))}().catch(e=>{console.error(e)}))},function(e,t){e.exports=require("commander")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(66)),n=s(r(40)),o=s(r(67)),c=s(r(3)),d=r(2),u=r(69),l=r(30),m=d.logger("Server");t.Server=class{constructor(e){this.engine=e;const t=n.default();t.use(a.default.urlencoded({extended:!0,limit:"10mb"})),t.use(a.default.json({limit:"10mb"})),t.use(a.default.json({type:"application/vnd.api+json",limit:"10mb"})),t.use(o.default()),e.config.server.session.cookie.proxy&&t.enable("trust proxy"),t.use((function(t,r,i){t.engine=e,i()})),t.use("/jam/"+l.JAMAPI_URL_VERSION,u.initJamRouter(e));const r=c.default.resolve("./config/jamberry.config.js");t.get("/assets/config/config.js",(e,t)=>{t.sendFile(r)}),t.get("/*",n.default.static(c.default.resolve(e.config.paths.frontend)));const i=c.default.resolve(e.config.paths.frontend,"index.html");t.get("/*",(e,t)=>{t.sendFile(i)}),this.app=t}getURL(){return`http://${"127.0.0.1"===this.engine.config.server.listen?"localhost":this.engine.config.server.listen}:${this.engine.config.server.port}`}start(){return i(this,void 0,void 0,(function*(){this.server=this.app.listen(this.engine.config.server.port,this.engine.config.server.listen),this.server.setTimeout(24e4),m.info("listening at "+this.getURL())}))}stop(){return i(this,void 0,void 0,(function*(){return new Promise((e,t)=>{this.server?this.server.close(r=>{r?t(r):e()}):e()})}))}}},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("helmet")},function(e,t){e.exports=require("winston")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(40)),n=s(r(70)),o=s(r(3)),c=r(2),d=r(71),u=r(16),l=r(152),m=r(5),p=r(154),f=r(155),y=r(23),h=r(160),g=r(161),v=r(162),b=r(165),k=c.logger("Jam.Api");function I(e,t){!function(e,t){const r=n.default({windowMs:1e3*t.engine.config.server.limit.login.window,skipSuccessfulRequests:!0,max:t.engine.config.server.limit.login.max,message:"Too many login fails from this IP, please try again later"});e.post("/login",r,u.apiCheck("/login"),f.CallSessionLoginHandler)}(e,t);const r={get(t,r,s,a){e.get(t,u.apiCheck(a||t),(e,t)=>i(this,void 0,void 0,(function*(){try{yield r(e,t)}catch(r){k.error(r),y.ApiResponder.error(e,t,r)}})))},post(e,t,r,i){},upload(e,t,r,i,s){}};g.registerPublicApi(r,t)}t.initJamRouter=function(e){const t=new d.JamApi(e),r=a.default.Router();return function(e,t){e.use((e,t,r)=>{k.info(e.originalUrl),r()})}(r),v.registerSession(r,e),f.registerPassPort(r,e),l.registerPublicCORS(r,e),I(r,t),p.registerAuthentication(r,e),l.registerAuthenticatedCors(r,e),function(e,t){e.post("/logout",f.CallSessionLogoutHandler),e.use("/docs",a.default.static(o.default.resolve("./static/docs/api/")));const r=b.jamUpload(t.engine.config.getDataPath(["cache","uploads"])),s={get(t,r,s,a){e.get(t,u.apiCheck(a||t),(e,t)=>i(this,void 0,void 0,(function*(){try{yield h.checkRoles(e.user,s),yield r(e,t)}catch(r){k.debug(r),y.ApiResponder.error(e,t,r)}})))},post(t,r,s,a){e.post(t,u.apiCheck(a||t),(e,t)=>i(this,void 0,void 0,(function*(){try{yield h.checkRoles(e.user,s),yield r(e,t)}catch(r){k.debug(r),y.ApiResponder.error(e,t,r)}})))},upload(t,s,a,n,o){e.post(t,r.handler(s),u.apiCheck(o||t),(e,t)=>i(this,void 0,void 0,(function*(){try{yield h.checkRoles(e.user,n),yield a(e,t)}catch(r){k.debug(r),y.ApiResponder.error(e,t,r)}})))}};g.registerAccessControlApi(s,t)}(r,t),function(e,t){e.use((e,t)=>{y.ApiResponder.error(e,t,m.NotFoundError("jam api cmd not found"))})}(r),r}},function(e,t){e.exports=require("express-rate-limit")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(72),s=r(74),a=r(76),n=r(77),o=r(79),c=r(81),d=r(86),u=r(87),l=r(89),m=r(91),p=r(92),f=r(93),y=r(95),h=r(97),g=r(99),v=r(101),b=r(103),k=r(105),I=r(107),q=r(110),D=r(111),S=r(113),w=r(114),T=r(150),A=r(151);t.JamApi=class{constructor(e){this.engine=e,this.settingsController=new q.SettingsController(this.engine.settingsService),this.streamController=new S.StreamController(this.engine.streamService,this.engine.nowPlayingService,this.engine.store),this.chatController=new o.ChatController(this.engine.chatService),this.genreController=new l.GenreController(e.genreService),this.statsController=new D.StatsController(e.statsService),this.nowPlayingController=new f.NowPlayingController(e.nowPlayingService),this.imageController=new m.ImageController(this.engine.store,this.engine.imageService),this.downloadController=new c.DownloadController(this.engine.store,this.engine.downloadService),this.waveformController=new A.WaveformController(this.engine.store,this.engine.waveformService),this.autocompleteController=new a.AutocompleteController(this.engine.store),this.radioController=new v.RadioController(this.engine.radioService,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.rootController=new b.RootController(this.engine.rootService,this.engine.ioService,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.trackController=new w.TrackController(this.engine.trackService,this.engine.folderService,this.engine.audioModule,this.engine.bookmarkService,this.engine.metaDataService,this.streamController,this.engine.ioService,this.engine.rootService,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.episodeController=new d.EpisodeController(this.engine.episodeService,this.streamController,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.podcastController=new g.PodcastController(this.engine.podcastService,this.episodeController,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.albumController=new i.AlbumController(this.engine.albumService,this.trackController,this.engine.metaDataService,this.engine.indexService,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.seriesController=new k.SeriesController(this.engine.seriesService,this.trackController,this.albumController,this.engine.metaDataService,this.engine.indexService,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.artistController=new s.ArtistController(this.engine.artistService,this.trackController,this.seriesController,this.albumController,this.engine.metaDataService,this.engine.indexService,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.folderController=new u.FolderController(this.engine.folderService,this.trackController,this.engine.metaDataService,this.engine.indexService,this.engine.rootService,this.engine.stateService,this.engine.imageService,this.engine.downloadService,this.engine.ioService),this.sessionController=new I.SessionController(this.engine.sessionService,this.engine.config),this.userController=new T.UserController(this.engine.userService,this.engine.stateService,this.engine.imageService,this.engine.downloadService,this.engine.sessionService),this.playlistController=new y.PlaylistController(this.engine.playlistService,this.trackController,this.engine.stateService,this.engine.imageService,this.engine.downloadService),this.bookmarkController=new n.BookmarkController(this.engine.bookmarkService,this.trackController),this.playqueueController=new h.PlayQueueController(this.engine.playQueueService,this.trackController),this.metadataController=new p.MetadataController(this.engine.metaDataService,this.trackController)}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(9),n=r(12),o=r(22),c=r(10),d=r(73);class u extends n.BaseListController{constructor(e,t,r,i,s,a,n){super(e,s,a,n),this.albumService=e,this.trackController=t,this.metaDataService=r,this.indexService=i,this.stateService=s,this.imageService=a,this.downloadService=n}sortAlbumTracks(e,t){if(void 0!==e.tag.discTotal&&void 0!==e.tag.disc&&void 0!==t.tag.discTotal&&void 0!==t.tag.disc){const r=e.tag.disc-t.tag.disc;if(0!==r)return r}if(void 0!==e.tag.track&&void 0!==t.tag.track){const r=e.tag.track-t.tag.track;if(0!==r)return r}return e.name.localeCompare(t.name)}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=d.formatAlbum(e,t);if(t.albumState){const t=yield this.stateService.findOrCreate(e.id,r.id,s.DBObjectType.album);i.state=c.formatState(t)}return t.albumInfo&&(i.info=yield this.metaDataService.extInfo.byAlbum(e)),t.albumTracks&&(i.tracks=yield this.trackController.prepareListByIDs(e.trackIDs,t,r,(e,t)=>this.sortAlbumTracks(e,t))),i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,name:e.name,rootID:e.rootID,rootIDs:e.rootIDs,artist:e.artist,artistID:e.artistID,trackID:e.trackID,mbReleaseID:e.mbReleaseID,mbArtistID:e.mbArtistID,albumType:e.albumType,albumTypes:e.albumTypes,genre:e.genre,newerThan:e.newerThan,fromYear:e.fromYear,toYear:e.toYear,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}similarTracks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);try{const r=yield this.metaDataService.similarTracks.byAlbum(t),i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.trackController.prepareList(i.items,e.query,e.user)}}catch(t){return{total:0,amount:e.query.amount,offset:e.query.offset,items:[]}}}))}tracks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids);let r=[];return t.forEach(e=>{r=r.concat(e.trackIDs)}),{items:yield this.trackController.prepareListByIDs(r,e.query,e.user,(e,t)=>this.sortAlbumTracks(e,t))}}))}info(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return{info:yield this.metaDataService.extInfo.byAlbum(t)}}))}index(e){return i(this,void 0,void 0,(function*(){return o.formatAlbumIndex(yield this.indexService.getAlbumIndex(yield this.translateQuery(e.query,e.user)))}))}}t.AlbumController=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatAlbum=function(e,t){return{id:e.id,name:e.name,albumType:e.albumType,created:e.created,artist:e.artist,artistID:e.artistID,series:e.series,seriesID:e.seriesID,seriesNr:e.seriesNr,trackCount:e.trackIDs.length,genres:e.genres,year:e.year,duration:e.duration,mbArtistID:e.mbArtistID,mbReleaseID:e.mbReleaseID,trackIDs:t.albumTrackIDs?e.trackIDs:void 0}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(9),n=r(12),o=r(22),c=r(10),d=r(75);class u extends n.BaseListController{constructor(e,t,r,i,s,a,n,o,c){super(e,n,o,c),this.artistService=e,this.trackController=t,this.seriesController=r,this.albumController=i,this.metaDataService=s,this.indexService=a,this.stateService=n,this.imageService=o,this.downloadService=c}static sortGrouping(e,t){const r=Number(e),i=Number(t);return isNaN(r)||isNaN(i)?(e||"").localeCompare(t||""):r-i}static sortArtistAlbums(e,t){let r=e.albumType.localeCompare(t.albumType);return 0===r&&(e.seriesNr&&t.seriesNr?r=u.sortGrouping(e.seriesNr,t.seriesNr):(e.seriesNr||t.seriesNr)&&(r=e.seriesNr?1:-1)),0===r&&(r=(t.year||0)-(e.year||0)),0===r&&(r=e.name.localeCompare(t.name)),r}static sortArtistTracks(e,t){let r=e.parentID.localeCompare(t.parentID);return 0===r&&(r=(t.tag.disc||0)-(e.tag.disc||0)),0===r&&(r=(t.tag.track||0)-(e.tag.track||0)),r}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=d.formatArtist(e,t);if(t.artistState){const t=yield this.stateService.findOrCreate(e.id,r.id,s.DBObjectType.artist);i.state=c.formatState(t)}if(t.artistInfo)try{i.info=yield this.metaDataService.extInfo.byArtist(e)}catch(e){i.info=void 0}if(t.artistSimilar)try{i.similar=yield this.prepareList(yield this.metaDataService.similarArtists.byArtist(e),{},r)}catch(e){i.similar=void 0}return t.artistTracks&&(i.tracks=yield this.trackController.prepareListByIDs(e.trackIDs,t,r,u.sortArtistTracks)),t.artistAlbums&&(i.albums=yield this.albumController.prepareListByIDs(e.albumIDs,t,r,u.sortArtistAlbums)),i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,name:e.name,rootID:e.rootID,rootIDs:e.rootIDs,albumID:e.albumID,mbArtistID:e.mbArtistID,albumType:e.albumType,albumTypes:e.albumTypes,newerThan:e.newerThan,genre:e.genre,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}similar(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);try{const r=yield this.metaDataService.similarArtists.byArtist(t),i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.prepareList(i.items,e.query,e.user)}}catch(e){return{items:[]}}}))}similarTracks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);try{const r=yield this.metaDataService.similarTracks.byArtist(t),i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.trackController.prepareList(i.items,e.query,e.user)}}catch(e){return{items:[]}}}))}index(e){return i(this,void 0,void 0,(function*(){return o.formatArtistIndex(yield this.indexService.getArtistIndex(yield this.translateQuery(e.query,e.user)))}))}tracks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids);let r=[];t.forEach(e=>{r=r.concat(e.trackIDs)});const i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.trackController.prepareListByIDs(i.items,e.query,e.user,u.sortArtistTracks)}}))}albums(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids);let r=[];t.forEach(e=>{r=r.concat(e.albumIDs)});const i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.albumController.prepareListByIDs(i.items,e.query,e.user,u.sortArtistAlbums)}}))}info(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return{info:yield this.metaDataService.extInfo.byArtist(t)}}))}series(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids);let r=[];t.forEach(e=>{r=r.concat(e.seriesIDs)});const i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.seriesController.prepareListByIDs(i.items,e.query,e.user)}}))}}t.ArtistController=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatArtist=function(e,t){return{id:e.id,name:e.name,genres:e.genres,albumTypes:e.albumTypes,mbArtistID:e.mbArtistID,trackIDs:t.artistTrackIDs?e.trackIDs:void 0,albumIDs:t.artistAlbumIDs?e.albumIDs:void 0,seriesIDs:t.artistSeries?e.seriesIDs:void 0,albumCount:e.albumIDs.length,seriesCount:e.seriesIDs?e.seriesIDs.length:0,trackCount:e.trackIDs.length,created:e.created}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.AutocompleteController=class{constructor(e){this.store=e}autocomplete(e){return i(this,void 0,void 0,(function*(){return this.autocompleteQuery(e.query)}))}autocompleteQuery(e){return i(this,void 0,void 0,(function*(){const t={};if(void 0!==e.track&&e.track>0){const r=yield this.store.trackStore.search({query:e.query,amount:e.track});t.tracks=r.items.map(e=>({id:e.id,name:e.tag.title||""}))}if(void 0!==e.album&&e.album>0){const r=yield this.store.albumStore.search({query:e.query,amount:e.album});t.albums=r.items.map(e=>({id:e.id,name:e.name}))}if(void 0!==e.artist&&e.artist>0){const r=yield this.store.artistStore.search({query:e.query,amount:e.artist});t.artists=r.items.map(e=>({id:e.id,name:e.name}))}if(void 0!==e.folder&&e.folder>0){const r=yield this.store.artistStore.search({query:e.query,amount:e.folder});t.folders=r.items.map(e=>({id:e.id,name:e.name}))}if(void 0!==e.playlist&&e.playlist>0){const r=yield this.store.playlistStore.search({query:e.query,amount:e.playlist});t.playlists=r.items.map(e=>({id:e.id,name:e.name}))}if(void 0!==e.podcast&&e.podcast>0){const r=yield this.store.podcastStore.search({query:e.query,amount:e.podcast});t.podcasts=r.items.map(e=>({id:e.id,name:e.tag?e.tag.title:""}))}if(void 0!==e.episode&&e.episode>0){const r=yield this.store.episodeStore.search({query:e.query,amount:e.episode});t.episodes=r.items.map(e=>({id:e.id,name:e.name}))}if(void 0!==e.series&&e.series>0){const r=yield this.store.seriesStore.search({query:e.query,amount:e.series});t.series=r.items.map(e=>({id:e.id,name:e.name}))}return t}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),a=r(78);t.BookmarkController=class{constructor(e,t){this.bookmarkService=e,this.trackController=t}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=a.formatBookmark(e);return t.bookmarkTrack&&(i.track=yield this.trackController.prepareByID(e.destID,t,r)),i}))}prepareList(e,t,r){return i(this,void 0,void 0,(function*(){const i=e.items.map(a.formatBookmark);if(t.bookmarkTrack){const s=[];for(const t of e.items)s.includes(t.destID)||s.push(t.destID);const a=yield this.trackController.prepareListByIDs(s,t,r);i.forEach(e=>{e.track=a.find(t=>t.id===e.trackID)})}return{total:e.total,offset:e.offset,amount:e.amount,items:i}}))}id(e){return i(this,void 0,void 0,(function*(){if(!e.query.id)return Promise.reject(s.InvalidParamError());const t=yield this.bookmarkService.byID(e.query.id,e.user.id);return t?this.prepare(t,e.query,e.user):Promise.reject(s.NotFoundError())}))}ids(e){return i(this,void 0,void 0,(function*(){return e.query.ids&&0!==e.query.ids.length?this.prepareList(yield this.bookmarkService.byIDs(e.query.ids,e.user.id,e.query.amount,e.query.offset),e.query,e.user):Promise.reject(s.InvalidParamError())}))}create(e){return i(this,void 0,void 0,(function*(){const t=yield this.trackController.byID(e.query.trackID),r=yield this.bookmarkService.create(t.id,e.user.id,e.query.position||0,e.query.comment);return this.prepare(r,{},e.user)}))}delete(e){return i(this,void 0,void 0,(function*(){yield this.bookmarkService.remove(e.query.id,e.user.id)}))}byTrackDelete(e){return i(this,void 0,void 0,(function*(){yield this.bookmarkService.removeByTrack(e.query.trackID,e.user.id)}))}list(e){return i(this,void 0,void 0,(function*(){return this.prepareList(yield this.bookmarkService.byUser(e.user.id,e.query.amount,e.query.offset),e.query,e.user)}))}byTrackList(e){return i(this,void 0,void 0,(function*(){return this.prepareList(yield this.bookmarkService.byTrack(e.query.trackID,e.user.id),{},e.user)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBookmark=function(e){return{id:e.id,trackID:e.destID,comment:e.comment,created:e.created,changed:e.changed,position:e.position}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),a=r(80);t.ChatController=class{constructor(e){this.chatService=e}list(e){return i(this,void 0,void 0,(function*(){return(yield this.chatService.get(e.query.since)).map(a.formatChatMessage)}))}create(e){return i(this,void 0,void 0,(function*(){yield this.chatService.add(e.query.message,e.user)}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.chatService.find(e.query.time);return t?t.userID!==e.user.id?Promise.reject(s.UnauthError()):void(yield this.chatService.remove(t)):Promise.reject(s.NotFoundError())}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatChatMessage=function(e){return{username:e.username,userID:e.userID,time:e.time,message:e.message}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(16),a=r(5),n=r(1);t.DownloadController=class{constructor(e,t){this.store=e,this.downloadService=t}downloadByPathParameter(e){return i(this,void 0,void 0,(function*(){const{id:t,format:r}=yield s.validatePathParameterIDFormat(e.query.pathParameter,n.DownloadFormats,n.DefaultDownloadFormat);return this.download({query:{id:t,format:r},user:e.user})}))}download(e){return i(this,void 0,void 0,(function*(){const t=e.query.id;if(!t||0===t.length)return Promise.reject(a.InvalidParamError());const r=yield this.store.findInStores(t,this.store.downloadStores());if(r){const t=yield this.downloadService.getObjDownload(r,e.query.format,e.user);if(t)return t}return Promise.reject(a.NotFoundError())}))}}},function(e){e.exports=JSON.parse('{"openapi":"3.0.0","info":{"description":"Api for JamServe","version":"0.1.14","title":"JamApi","license":{"name":"MIT"}},"servers":[{"url":"http://localhost:4040/jam/{version}/","description":"A local JamServe API","variables":{"version":{"enum":["v1"],"default":"v1"}}}],"paths":{"/ping":{"get":{"operationId":"sessionController.ping","description":"is the api online?","tags":["access"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Ping"}}}}},"security":[]}},"/session":{"get":{"operationId":"sessionController.session","description":"check the login state","tags":["access"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Session"}}}}},"security":[]}},"/lastfm/lookup":{"get":{"operationId":"metadataController.lastfmLookup","description":"lookup lastfm data","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.LastFMResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"type","schema":{"$ref":"#/components/schemas/JamParameters.LastFMLookupType"},"description":"lookup by lastfm type","required":true},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/lyricsovh/search":{"get":{"operationId":"metadataController.lyricsovhSearch","description":"search lyrics.ovh data","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.LyricsOVHResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"title","schema":{"type":"string"},"description":"lookup by song title","required":true},{"in":"query","name":"artist","schema":{"type":"string"},"description":"lookup by song artist","required":true}]}},"/acoustid/lookup":{"get":{"operationId":"metadataController.acoustidLookup","description":"lookup acoustid data","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AcoustidResponse"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"inc","schema":{"type":"string"},"description":"comma-separated acoustid includes","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/musicbrainz/lookup":{"get":{"operationId":"metadataController.musicbrainzLookup","description":"lookup musicbrainz data","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.MusicBrainzResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"type","schema":{"$ref":"#/components/schemas/JamParameters.MusicBrainzLookupType"},"description":"lookup by musicbrainz type","required":true},{"in":"query","name":"inc","schema":{"type":"string"},"description":"comma-separated musicbrainz includes","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/musicbrainz/search":{"get":{"operationId":"metadataController.musicbrainzSearch","description":"search musicbrainz data","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.MusicBrainzResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"type","schema":{"$ref":"#/components/schemas/JamParameters.MusicBrainzSearchType"},"description":"search by musicbrainz type","required":true},{"in":"query","name":"recording","schema":{"type":"string"},"description":"search by recording name","required":false},{"in":"query","name":"releasegroup","schema":{"type":"string"},"description":"search by releasegroup name","required":false},{"in":"query","name":"release","schema":{"type":"string"},"description":"search by release name","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"search by artist name","required":false},{"in":"query","name":"tracks","schema":{"minimum":0,"type":"integer"},"description":"search by number of release tracks","required":false}]}},"/acousticbrainz/lookup":{"get":{"operationId":"metadataController.acousticbrainzLookup","description":"lookup acousticbrainz data","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AcousticBrainzResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"nr","schema":{"minimum":0,"type":"integer"},"description":"page parameter if more than one acousticbrainz info is available","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/coverartarchive/lookup":{"get":{"operationId":"metadataController.coverartarchiveLookup","description":"lookup coverartarchive data","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.CoverArtArchiveResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"type","schema":{"$ref":"#/components/schemas/JamParameters.CoverArtArchiveLookupType"},"description":"lookup by musicbrainz type","required":true},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/wikipedia/summary":{"get":{"operationId":"metadataController.wikipediaSummary","description":"wikipedia summary","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.WikipediaSummaryResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"title","schema":{"type":"string"},"description":"lookup by page title","required":true},{"in":"query","name":"lang","schema":{"default":"en","type":"string"},"description":"wikipedia language","required":false}]}},"/wikidata/summary":{"get":{"operationId":"metadataController.wikidataSummary","description":"wikidata summary","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.WikipediaSummaryResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"lookup by wikidata id","required":true},{"in":"query","name":"lang","schema":{"default":"en","type":"string"},"description":"get summary of wikipedia language","required":false}]}},"/wikidata/lookup":{"get":{"operationId":"metadataController.wikidataLookup","description":"wikidata lookup","tags":["metadata"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.WikidataLookupResponse"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"lookup by wikidata id","required":true}]}},"/autocomplete":{"get":{"operationId":"autocompleteController.autocomplete","description":"autocomplete","tags":["various"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AutoComplete"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"query","schema":{"type":"string"},"description":"query to complete","required":true},{"in":"query","name":"track","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of track names to complete","required":false},{"in":"query","name":"artist","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of artist names to complete","required":false},{"in":"query","name":"album","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of album names to complete","required":false},{"in":"query","name":"folder","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of folder names to complete","required":false},{"in":"query","name":"playlist","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of playlist names to complete","required":false},{"in":"query","name":"podcast","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of podcast names to complete","required":false},{"in":"query","name":"episode","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of episode names to complete","required":false},{"in":"query","name":"series","schema":{"default":0,"minimum":0,"type":"integer"},"description":"amount of series names to complete","required":false}]}},"/genre/list":{"get":{"operationId":"genreController.list","description":"get list of genres found in the library","tags":["various"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.GenreList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/stats":{"get":{"operationId":"statsController.get","description":"get count stats for folders/tracks/albums/...","tags":["various"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Stats"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false}]}},"/nowPlaying/list":{"get":{"operationId":"nowPlayingController.list","description":"get list of tracks played by all users","tags":["various"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.NowPlayingList"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/chat/list":{"get":{"operationId":"chatController.list","description":"get chat messages","tags":["chat"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.ChatMessage"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"since","schema":{"minimum":0,"type":"integer"},"description":"filter by post time (unix time)","required":false}]}},"/folder/index":{"get":{"operationId":"folderController.index","description":"get the navigation index for folders","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.FolderIndex"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"parentID","schema":{"type":"string"},"description":"filter by parent folder id","required":false},{"in":"query","name":"childOfID","schema":{"type":"string"},"description":"filter if folder is in folder id (or its subfolders)","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"album","schema":{"type":"string"},"description":"filter by album name","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"level","schema":{"minimum":0,"type":"integer"},"description":"filter by level","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"type","schema":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"},"description":"filter by folder type","required":false},{"in":"query","name":"types","schema":{"type":"array","items":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"}},"description":"filter by folder types","required":false},{"in":"query","name":"sortField","schema":{"enum":["album","artist","created","genre","parent","title","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/folder/id":{"get":{"operationId":"folderController.id","description":"get a folder by id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Folder"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"folderTag","schema":{"default":false,"type":"boolean"},"description":"include tag on folder(s)","required":false},{"in":"query","name":"folderState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on folder(s)","required":false},{"in":"query","name":"folderCounts","schema":{"default":false,"type":"boolean"},"description":"include information about children (trackCount/folderCount) on folder(s)","required":false},{"in":"query","name":"folderParents","schema":{"default":false,"type":"boolean"},"description":"include a list of all parent folder ids on folder(s)","required":false},{"in":"query","name":"folderInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on folder(s)","required":false},{"in":"query","name":"folderSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar folders list on folder(s) - only for folders of type artist","required":false},{"in":"query","name":"folderArtworks","schema":{"default":false,"type":"boolean"},"description":"include artwork images list on folder(s)","required":false},{"in":"query","name":"folderChildren","schema":{"default":false,"type":"boolean"},"description":"include tracks and sub folders on folder(s)","required":false},{"in":"query","name":"folderSubfolders","schema":{"default":false,"type":"boolean"},"description":"include sub folders on folder(s)","required":false},{"in":"query","name":"folderTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on folder(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/folder/ids":{"get":{"operationId":"folderController.ids","description":"get folders by ids","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Folder"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"folderTag","schema":{"default":false,"type":"boolean"},"description":"include tag on folder(s)","required":false},{"in":"query","name":"folderState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on folder(s)","required":false},{"in":"query","name":"folderCounts","schema":{"default":false,"type":"boolean"},"description":"include information about children (trackCount/folderCount) on folder(s)","required":false},{"in":"query","name":"folderParents","schema":{"default":false,"type":"boolean"},"description":"include a list of all parent folder ids on folder(s)","required":false},{"in":"query","name":"folderInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on folder(s)","required":false},{"in":"query","name":"folderSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar folders list on folder(s) - only for folders of type artist","required":false},{"in":"query","name":"folderArtworks","schema":{"default":false,"type":"boolean"},"description":"include artwork images list on folder(s)","required":false},{"in":"query","name":"folderChildren","schema":{"default":false,"type":"boolean"},"description":"include tracks and sub folders on folder(s)","required":false},{"in":"query","name":"folderSubfolders","schema":{"default":false,"type":"boolean"},"description":"include sub folders on folder(s)","required":false},{"in":"query","name":"folderTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on folder(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/folder/tracks":{"get":{"operationId":"folderController.tracks","description":"get tracks of a folder by id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"recursive","schema":{"default":false,"type":"boolean"},"description":"include tracks of sub folders","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/folder/subfolders":{"get":{"operationId":"folderController.subfolders","description":"get sub folders of a folder by id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.FolderList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"folderTag","schema":{"default":false,"type":"boolean"},"description":"include tag on folder(s)","required":false},{"in":"query","name":"folderState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on folder(s)","required":false},{"in":"query","name":"folderCounts","schema":{"default":false,"type":"boolean"},"description":"include information about children (trackCount/folderCount) on folder(s)","required":false},{"in":"query","name":"folderParents","schema":{"default":false,"type":"boolean"},"description":"include a list of all parent folder ids on folder(s)","required":false},{"in":"query","name":"folderInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on folder(s)","required":false},{"in":"query","name":"folderSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar folders list on folder(s) - only for folders of type artist","required":false},{"in":"query","name":"folderArtworks","schema":{"default":false,"type":"boolean"},"description":"include artwork images list on folder(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/folder/artist/similar":{"get":{"operationId":"folderController.artistSimilar","description":"get similar artist folders of a folder by id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.FolderList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"folderTag","schema":{"default":false,"type":"boolean"},"description":"include tag on folder(s)","required":false},{"in":"query","name":"folderState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on folder(s)","required":false},{"in":"query","name":"folderCounts","schema":{"default":false,"type":"boolean"},"description":"include information about children (trackCount/folderCount) on folder(s)","required":false},{"in":"query","name":"folderParents","schema":{"default":false,"type":"boolean"},"description":"include a list of all parent folder ids on folder(s)","required":false},{"in":"query","name":"folderInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on folder(s)","required":false},{"in":"query","name":"folderSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar folders list on folder(s) - only for folders of type artist","required":false},{"in":"query","name":"folderArtworks","schema":{"default":false,"type":"boolean"},"description":"include artwork images list on folder(s)","required":false},{"in":"query","name":"folderChildren","schema":{"default":false,"type":"boolean"},"description":"include tracks and sub folders on folder(s)","required":false},{"in":"query","name":"folderSubfolders","schema":{"default":false,"type":"boolean"},"description":"include sub folders on folder(s)","required":false},{"in":"query","name":"folderTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on folder(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/folder/artist/info":{"get":{"operationId":"folderController.artistInfo","description":"get external artist description of a folder by id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Info"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/folder/album/info":{"get":{"operationId":"folderController.albumInfo","description":"get external album description of a folder by id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Info"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/folder/list":{"get":{"operationId":"folderController.list","description":"get a list of folders by list type","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.FolderList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"parentID","schema":{"type":"string"},"description":"filter by parent folder id","required":false},{"in":"query","name":"childOfID","schema":{"type":"string"},"description":"filter if folder is in folder id (or its subfolders)","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"album","schema":{"type":"string"},"description":"filter by album name","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"level","schema":{"minimum":0,"type":"integer"},"description":"filter by level","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"type","schema":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"},"description":"filter by folder type","required":false},{"in":"query","name":"types","schema":{"type":"array","items":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"}},"description":"filter by folder types","required":false},{"in":"query","name":"sortField","schema":{"enum":["album","artist","created","genre","parent","title","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"folderTag","schema":{"default":false,"type":"boolean"},"description":"include tag on folder(s)","required":false},{"in":"query","name":"folderState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on folder(s)","required":false},{"in":"query","name":"folderCounts","schema":{"default":false,"type":"boolean"},"description":"include information about children (trackCount/folderCount) on folder(s)","required":false},{"in":"query","name":"folderParents","schema":{"default":false,"type":"boolean"},"description":"include a list of all parent folder ids on folder(s)","required":false},{"in":"query","name":"folderInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on folder(s)","required":false},{"in":"query","name":"folderSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar folders list on folder(s) - only for folders of type artist","required":false},{"in":"query","name":"folderArtworks","schema":{"default":false,"type":"boolean"},"description":"include artwork images list on folder(s)","required":false},{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/folder/search":{"get":{"operationId":"folderController.search","description":"search folders","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.FolderList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"parentID","schema":{"type":"string"},"description":"filter by parent folder id","required":false},{"in":"query","name":"childOfID","schema":{"type":"string"},"description":"filter if folder is in folder id (or its subfolders)","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"album","schema":{"type":"string"},"description":"filter by album name","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"level","schema":{"minimum":0,"type":"integer"},"description":"filter by level","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"type","schema":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"},"description":"filter by folder type","required":false},{"in":"query","name":"types","schema":{"type":"array","items":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"}},"description":"filter by folder types","required":false},{"in":"query","name":"sortField","schema":{"enum":["album","artist","created","genre","parent","title","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"folderChildren","schema":{"default":false,"type":"boolean"},"description":"include tracks and sub folders on folder(s)","required":false},{"in":"query","name":"folderSubfolders","schema":{"default":false,"type":"boolean"},"description":"include sub folders on folder(s)","required":false},{"in":"query","name":"folderTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on folder(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"folderTag","schema":{"default":false,"type":"boolean"},"description":"include tag on folder(s)","required":false},{"in":"query","name":"folderState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on folder(s)","required":false},{"in":"query","name":"folderCounts","schema":{"default":false,"type":"boolean"},"description":"include information about children (trackCount/folderCount) on folder(s)","required":false},{"in":"query","name":"folderParents","schema":{"default":false,"type":"boolean"},"description":"include a list of all parent folder ids on folder(s)","required":false},{"in":"query","name":"folderInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on folder(s)","required":false},{"in":"query","name":"folderSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar folders list on folder(s) - only for folders of type artist","required":false},{"in":"query","name":"folderArtworks","schema":{"default":false,"type":"boolean"},"description":"include artwork images list on folder(s)","required":false}]}},"/folder/health":{"get":{"operationId":"folderController.health","description":"list of folders with health issues","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.FolderHealth"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"parentID","schema":{"type":"string"},"description":"filter by parent folder id","required":false},{"in":"query","name":"childOfID","schema":{"type":"string"},"description":"filter if folder is in folder id (or its subfolders)","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"album","schema":{"type":"string"},"description":"filter by album name","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"level","schema":{"minimum":0,"type":"integer"},"description":"filter by level","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"type","schema":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"},"description":"filter by folder type","required":false},{"in":"query","name":"types","schema":{"type":"array","items":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"}},"description":"filter by folder types","required":false},{"in":"query","name":"sortField","schema":{"enum":["album","artist","created","genre","parent","title","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"folderTag","schema":{"default":false,"type":"boolean"},"description":"include tag on folder(s)","required":false},{"in":"query","name":"folderState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on folder(s)","required":false},{"in":"query","name":"folderCounts","schema":{"default":false,"type":"boolean"},"description":"include information about children (trackCount/folderCount) on folder(s)","required":false},{"in":"query","name":"folderParents","schema":{"default":false,"type":"boolean"},"description":"include a list of all parent folder ids on folder(s)","required":false},{"in":"query","name":"folderInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on folder(s)","required":false},{"in":"query","name":"folderSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar folders list on folder(s) - only for folders of type artist","required":false},{"in":"query","name":"folderArtworks","schema":{"default":false,"type":"boolean"},"description":"include artwork images list on folder(s)","required":false}]}},"/folder/state":{"get":{"operationId":"folderController.state","description":"get the user state (fav/rating) by folder id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/folder/states":{"get":{"operationId":"folderController.states","description":"get the user states (fav/rating) by folders ids","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/folder/artist/similar/tracks":{"get":{"operationId":"folderController.artistSimilarTracks","description":"get similar tracks of a/by artist folder id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/folder/artworks":{"get":{"operationId":"folderController.artworks","description":"get the artwork list by folder id","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.ArtworkImage"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/track/id":{"get":{"operationId":"trackController.id","description":"get a track by id","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Track"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/track/ids":{"get":{"operationId":"trackController.ids","description":"get tracks by ids","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/track/rawTag":{"get":{"operationId":"trackController.rawTag","description":"get an raw tag (eg. id3/vorbis) by track id","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.RawTag"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/track/rawTags":{"get":{"operationId":"trackController.rawTags","description":"get raw tags (eg. id3/vorbis) by track ids","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.RawTags"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/track/search":{"get":{"operationId":"trackController.search","description":"search tracks","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"artistID","schema":{"type":"string"},"description":"filter by artist id","required":false},{"in":"query","name":"albumArtistID","schema":{"type":"string"},"description":"filter by album artist id","required":false},{"in":"query","name":"parentID","schema":{"type":"string"},"description":"filter by parent folder id","required":false},{"in":"query","name":"parentIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by parent folder ids","required":false},{"in":"query","name":"childOfID","schema":{"type":"string"},"description":"filter if track is in folder id (or its subfolders)","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"album","schema":{"type":"string"},"description":"filter by album","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"sortField","schema":{"enum":["album","albumartist","artist","created","genre","parent","title","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/track/state":{"get":{"operationId":"trackController.state","description":"get the user state (fav/rating) by track id","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/track/states":{"get":{"operationId":"trackController.states","description":"get the user states (fav/rating) by track ids","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/track/list":{"get":{"operationId":"trackController.list","description":"get a track list by track list type","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"artistID","schema":{"type":"string"},"description":"filter by artist id","required":false},{"in":"query","name":"albumArtistID","schema":{"type":"string"},"description":"filter by album artist id","required":false},{"in":"query","name":"parentID","schema":{"type":"string"},"description":"filter by parent folder id","required":false},{"in":"query","name":"parentIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by parent folder ids","required":false},{"in":"query","name":"childOfID","schema":{"type":"string"},"description":"filter if track is in folder id (or its subfolders)","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"album","schema":{"type":"string"},"description":"filter by album","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"sortField","schema":{"enum":["album","albumartist","artist","created","genre","parent","title","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/track/similar":{"get":{"operationId":"trackController.similar","description":"get the similar tracks by track id","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/track/health":{"get":{"operationId":"trackController.health","description":"list of tracks with health issues","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.TrackHealth"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"media","schema":{"type":"boolean"},"description":"check the file media for errors","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"artistID","schema":{"type":"string"},"description":"filter by artist id","required":false},{"in":"query","name":"albumArtistID","schema":{"type":"string"},"description":"filter by album artist id","required":false},{"in":"query","name":"parentID","schema":{"type":"string"},"description":"filter by parent folder id","required":false},{"in":"query","name":"parentIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by parent folder ids","required":false},{"in":"query","name":"childOfID","schema":{"type":"string"},"description":"filter if track is in folder id (or its subfolders)","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"album","schema":{"type":"string"},"description":"filter by album","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"sortField","schema":{"enum":["album","albumartist","artist","created","genre","parent","title","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/track/lyrics":{"get":{"operationId":"trackController.lyrics","description":"search lyrics for the track","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackLyrics"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/episode/id":{"get":{"operationId":"episodeController.id","description":"get a podcast episode by id","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastEpisode"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/episode/ids":{"get":{"operationId":"episodeController.ids","description":"get podcast episodes by ids","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.PodcastEpisode"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/episode/search":{"get":{"operationId":"episodeController.search","description":"search podcast episodes","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastEpisodeList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"podcastID","schema":{"type":"string"},"description":"filter by podcast id","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"status","schema":{"type":"string"},"description":"filter by status","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","date","name","podcast"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/episode/retrieve":{"get":{"operationId":"episodeController.retrieve","description":"retrieve a podcast episode media file","tags":["episode"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/episode/state":{"get":{"operationId":"episodeController.state","description":"get the user state (fav/rating) by podcast episode id","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/episode/states":{"get":{"operationId":"episodeController.states","description":"get the user states (fav/rating) by podcast episode ids","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/episode/status":{"get":{"operationId":"episodeController.status","description":"get the episode state (e.g. downloading, new, etc.) by podcast episode id","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastEpisodeStatus"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/episode/list":{"get":{"operationId":"episodeController.list","description":"get a list of episodes by list type","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastEpisodeList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"podcastID","schema":{"type":"string"},"description":"filter by podcast id","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by title","required":false},{"in":"query","name":"status","schema":{"type":"string"},"description":"filter by status","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","date","name","podcast"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/podcast/id":{"get":{"operationId":"podcastController.id","description":"get a podcast by id","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Podcast"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"podcastState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on podcast(s)","required":false},{"in":"query","name":"podcastEpisodes","schema":{"default":false,"type":"boolean"},"description":"include episodes on podcast(s)","required":false},{"in":"query","name":"podcastEpisodeCount","schema":{"default":false,"type":"boolean"},"description":"include episode count on podcast(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/podcast/ids":{"get":{"operationId":"podcastController.ids","description":"get podcasts by ids","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Podcast"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"podcastState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on podcast(s)","required":false},{"in":"query","name":"podcastEpisodes","schema":{"default":false,"type":"boolean"},"description":"include episodes on podcast(s)","required":false},{"in":"query","name":"podcastEpisodeCount","schema":{"default":false,"type":"boolean"},"description":"include episode count on podcast(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/podcast/status":{"get":{"operationId":"podcastController.status","description":"get the podcast state (e.g. downloading, new, etc.) by podcast id","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastStatus"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/podcast/search":{"get":{"operationId":"podcastController.search","description":"search podcasts","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"url","schema":{"type":"string"},"description":"filter by podcast url","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by podcast title","required":false},{"in":"query","name":"status","schema":{"type":"string"},"description":"filter by podcast status","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","title"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"podcastState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on podcast(s)","required":false},{"in":"query","name":"podcastEpisodes","schema":{"default":false,"type":"boolean"},"description":"include episodes on podcast(s)","required":false},{"in":"query","name":"podcastEpisodeCount","schema":{"default":false,"type":"boolean"},"description":"include episode count on podcast(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/podcast/episodes":{"get":{"operationId":"podcastController.episodes","description":"get podcast episodes by podcast id","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastEpisodeList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/podcast/refreshAll":{"get":{"operationId":"podcastController.refreshAll","description":"check all podcast feeds for new episodes","tags":["podcast"],"responses":{"200":{"description":"ok"}}}},"/podcast/refresh":{"get":{"operationId":"podcastController.refresh","description":"check podcast feeds for new episodes by podcast id","tags":["podcast"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/podcast/state":{"get":{"operationId":"podcastController.state","description":"get the user state (fav/rating) by podcast id","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/podcast/states":{"get":{"operationId":"podcastController.states","description":"get the user states (fav/rating) by podcast ids","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/podcast/list":{"get":{"operationId":"podcastController.list","description":"get a list of podcasts by list type","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PodcastList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"url","schema":{"type":"string"},"description":"filter by podcast url","required":false},{"in":"query","name":"title","schema":{"type":"string"},"description":"filter by podcast title","required":false},{"in":"query","name":"status","schema":{"type":"string"},"description":"filter by podcast status","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","title"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"podcastState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on podcast(s)","required":false},{"in":"query","name":"podcastEpisodes","schema":{"default":false,"type":"boolean"},"description":"include episodes on podcast(s)","required":false},{"in":"query","name":"podcastEpisodeCount","schema":{"default":false,"type":"boolean"},"description":"include episode count on podcast(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/radio/id":{"get":{"operationId":"radioController.id","description":"get a radio by id","tags":["radio"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Radio"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"radioState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on radio(s)","required":true}]}},"/radio/ids":{"get":{"operationId":"radioController.ids","description":"get radios by ids","tags":["radio"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Radio"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"radioState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on radio(s)","required":true}]}},"/radio/search":{"get":{"operationId":"radioController.search","description":"search radios","tags":["radio"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.RadioList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"url","schema":{"type":"string"},"description":"filter by radio url","required":false},{"in":"query","name":"homepage","schema":{"type":"string"},"description":"filter by radio homepage url","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by radio name","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"radioState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on radio(s)","required":true}]}},"/radio/state":{"get":{"operationId":"radioController.state","description":"get the user state (fav/rating) by radio id","tags":["radio"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/radio/states":{"get":{"operationId":"radioController.states","description":"get the user states (fav/rating) by radio ids","tags":["radio"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/artist/id":{"get":{"operationId":"artistController.id","description":"get an artist by id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Artist"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"artistAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on artist(s)","required":false},{"in":"query","name":"artistAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"artistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"artistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"artistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"artistSeries","schema":{"default":false,"type":"boolean"},"description":"include series on artist(s)","required":false},{"in":"query","name":"artistSeriesIDs","schema":{"default":false,"type":"boolean"},"description":"include series ids on artist(s)","required":false},{"in":"query","name":"artistInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"artistSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar artists on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/artist/ids":{"get":{"operationId":"artistController.ids","description":"get artists by ids","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Artist"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"artistAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on artist(s)","required":false},{"in":"query","name":"artistAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"artistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"artistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"artistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"artistSeries","schema":{"default":false,"type":"boolean"},"description":"include series on artist(s)","required":false},{"in":"query","name":"artistSeriesIDs","schema":{"default":false,"type":"boolean"},"description":"include series ids on artist(s)","required":false},{"in":"query","name":"artistInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"artistSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar artists on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/artist/search":{"get":{"operationId":"artistController.search","description":"search artists","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.ArtistList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"albumID","schema":{"type":"string"},"description":"filter by album id","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"mbArtistID","schema":{"type":"string"},"description":"filter by musicbrainz album id","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"artistAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on artist(s)","required":false},{"in":"query","name":"artistAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"artistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"artistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"artistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"artistSeries","schema":{"default":false,"type":"boolean"},"description":"include series on artist(s)","required":false},{"in":"query","name":"artistSeriesIDs","schema":{"default":false,"type":"boolean"},"description":"include series ids on artist(s)","required":false},{"in":"query","name":"artistInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"artistSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar artists on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/artist/state":{"get":{"operationId":"artistController.state","description":"get the user state (fav/rating) by artist id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/artist/states":{"get":{"operationId":"artistController.states","description":"get the user states (fav/rating) by artist ids","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/artist/list":{"get":{"operationId":"artistController.list","description":"get a artist list by artist list type","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.ArtistList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"albumID","schema":{"type":"string"},"description":"filter by album id","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"mbArtistID","schema":{"type":"string"},"description":"filter by musicbrainz album id","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"artistAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on artist(s)","required":false},{"in":"query","name":"artistAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"artistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"artistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"artistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"artistSeries","schema":{"default":false,"type":"boolean"},"description":"include series on artist(s)","required":false},{"in":"query","name":"artistSeriesIDs","schema":{"default":false,"type":"boolean"},"description":"include series ids on artist(s)","required":false},{"in":"query","name":"artistInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"artistSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar artists on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/artist/similar/tracks":{"get":{"operationId":"artistController.similarTracks","description":"get similar tracks of an artist by artist id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/artist/similar":{"get":{"operationId":"artistController.similar","description":"get similar artists of an artist by artist id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.ArtistList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"artistAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on artist(s)","required":false},{"in":"query","name":"artistAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"artistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"artistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"artistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"artistSeries","schema":{"default":false,"type":"boolean"},"description":"include series on artist(s)","required":false},{"in":"query","name":"artistSeriesIDs","schema":{"default":false,"type":"boolean"},"description":"include series ids on artist(s)","required":false},{"in":"query","name":"artistInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"artistSimilar","schema":{"default":false,"type":"boolean"},"description":"include similar artists on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/artist/index":{"get":{"operationId":"artistController.index","description":"get the navigation index for artists","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.ArtistIndex"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"albumID","schema":{"type":"string"},"description":"filter by album id","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"mbArtistID","schema":{"type":"string"},"description":"filter by musicbrainz album id","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/artist/tracks":{"get":{"operationId":"artistController.tracks","description":"get tracks of an artist by artist id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/artist/albums":{"get":{"operationId":"artistController.albums","description":"get albums of an artist by artist id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AlbumList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/artist/series":{"get":{"operationId":"artistController.series","description":"get series of an artist by artist id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.SeriesList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"seriesAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on series","required":false},{"in":"query","name":"seriesAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"seriesState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"seriesTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"seriesTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"seriesInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/artist/info":{"get":{"operationId":"artistController.info","description":"get external artist description by id","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Info"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/album/id":{"get":{"operationId":"albumController.id","description":"get an album by id","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Album"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/album/ids":{"get":{"operationId":"albumController.ids","description":"get albums by ids","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Album"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/album/list":{"get":{"operationId":"albumController.list","description":"get a artist list by album list type","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AlbumList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"artistID","schema":{"type":"string"},"description":"filter by artist id","required":false},{"in":"query","name":"trackID","schema":{"type":"string"},"description":"filter by track id","required":false},{"in":"query","name":"mbReleaseID","schema":{"type":"string"},"description":"filter by musicbrainz album id","required":false},{"in":"query","name":"mbArtistID","schema":{"type":"string"},"description":"filter by musicbrainz artist id","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"sortField","schema":{"enum":["artist","created","genre","name","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/album/search":{"get":{"operationId":"albumController.search","description":"search albums","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AlbumList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"artistID","schema":{"type":"string"},"description":"filter by artist id","required":false},{"in":"query","name":"trackID","schema":{"type":"string"},"description":"filter by track id","required":false},{"in":"query","name":"mbReleaseID","schema":{"type":"string"},"description":"filter by musicbrainz album id","required":false},{"in":"query","name":"mbArtistID","schema":{"type":"string"},"description":"filter by musicbrainz artist id","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"sortField","schema":{"enum":["artist","created","genre","name","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/album/index":{"get":{"operationId":"albumController.index","description":"get the navigation index for albums","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AlbumIndex"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"artist","schema":{"type":"string"},"description":"filter by artist name","required":false},{"in":"query","name":"artistID","schema":{"type":"string"},"description":"filter by artist id","required":false},{"in":"query","name":"trackID","schema":{"type":"string"},"description":"filter by track id","required":false},{"in":"query","name":"mbReleaseID","schema":{"type":"string"},"description":"filter by musicbrainz album id","required":false},{"in":"query","name":"mbArtistID","schema":{"type":"string"},"description":"filter by musicbrainz artist id","required":false},{"in":"query","name":"genre","schema":{"type":"string"},"description":"filter by genre","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"fromYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"toYear","schema":{"minimum":0,"type":"integer"},"description":"filter by year","required":false},{"in":"query","name":"sortField","schema":{"enum":["artist","created","genre","name","year"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/album/state":{"get":{"operationId":"albumController.state","description":"get the user state (fav/rating) by album id","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/album/states":{"get":{"operationId":"albumController.states","description":"get the user states (fav/rating) by album ids","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/album/similar/tracks":{"get":{"operationId":"albumController.similarTracks","description":"get similar tracks of an artist by album id","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/album/tracks":{"get":{"operationId":"albumController.tracks","description":"get tracks of an album by album ids","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/album/info":{"get":{"operationId":"albumController.info","description":"get external album description by id","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Info"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/series/id":{"get":{"operationId":"seriesController.id","description":"get a series by id","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Series"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"seriesAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on series","required":false},{"in":"query","name":"seriesAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"seriesState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"seriesTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"seriesTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"seriesInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/series/ids":{"get":{"operationId":"seriesController.ids","description":"get series by ids","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Series"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"seriesAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on series","required":false},{"in":"query","name":"seriesAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"seriesState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"seriesTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"seriesTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"seriesInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/series/search":{"get":{"operationId":"seriesController.search","description":"search series","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.SeriesList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"albumID","schema":{"type":"string"},"description":"filter by album id","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"seriesAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on series","required":false},{"in":"query","name":"seriesAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"seriesState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"seriesTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"seriesTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"seriesInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/series/state":{"get":{"operationId":"seriesController.state","description":"get the user state (fav/rating) by series id","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/series/states":{"get":{"operationId":"seriesController.states","description":"get the user states (fav/rating) by series ids","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/series/list":{"get":{"operationId":"seriesController.list","description":"get a series list by series list type","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.SeriesList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"albumID","schema":{"type":"string"},"description":"filter by album id","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"seriesAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on series","required":false},{"in":"query","name":"seriesAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"seriesState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"seriesTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"seriesTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"seriesInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/series/index":{"get":{"operationId":"seriesController.index","description":"get the navigation index for series","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.SeriesIndex"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by name","required":false},{"in":"query","name":"rootID","schema":{"type":"string"},"description":"filter by root id","required":false},{"in":"query","name":"rootIDs","schema":{"type":"array","items":{"type":"string"}},"description":"filter by root ids","required":false},{"in":"query","name":"albumID","schema":{"type":"string"},"description":"filter by album id","required":false},{"in":"query","name":"albumType","schema":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"description":"filter by album type","required":false},{"in":"query","name":"albumTypes","schema":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"description":"filter by album types","required":false},{"in":"query","name":"newerThan","schema":{"minimum":0,"type":"integer"},"description":"filter by creation date (unix time)","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/series/tracks":{"get":{"operationId":"seriesController.tracks","description":"get tracks of a series by series id","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/series/albums":{"get":{"operationId":"seriesController.albums","description":"get albums of a series by series id","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AlbumList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"seriesAlbums","schema":{"default":false,"type":"boolean"},"description":"include albums on series","required":false},{"in":"query","name":"seriesAlbumIDs","schema":{"default":false,"type":"boolean"},"description":"include album ids on artist(s)","required":false},{"in":"query","name":"seriesState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on artist(s)","required":false},{"in":"query","name":"seriesTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on artist(s)","required":false},{"in":"query","name":"seriesTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on artist(s)","required":false},{"in":"query","name":"seriesInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on artist(s)","required":false},{"in":"query","name":"albumTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on album(s)","required":false},{"in":"query","name":"albumTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on album(s)","required":false},{"in":"query","name":"albumState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on album(s)","required":false},{"in":"query","name":"albumInfo","schema":{"default":false,"type":"boolean"},"description":"include extended meta data on album(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/series/info":{"get":{"operationId":"seriesController.info","description":"get external series description by id","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Info"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/playlist/id":{"get":{"operationId":"playlistController.id","description":"get a playlist by id","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Playlist"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"playlistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on playlist(s)","required":false},{"in":"query","name":"playlistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on playlist(s)","required":false},{"in":"query","name":"playlistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on playlist(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/playlist/ids":{"get":{"operationId":"playlistController.ids","description":"get playlists by ids","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Playlist"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"playlistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on playlist(s)","required":false},{"in":"query","name":"playlistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on playlist(s)","required":false},{"in":"query","name":"playlistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on playlist(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/playlist/search":{"get":{"operationId":"playlistController.search","description":"search playlists","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PlaylistList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by playlist name","required":false},{"in":"query","name":"isPublic","schema":{"type":"boolean"},"description":"filter by public state","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false},{"in":"query","name":"playlistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on playlist(s)","required":false},{"in":"query","name":"playlistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on playlist(s)","required":false},{"in":"query","name":"playlistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on playlist(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/playlist/state":{"get":{"operationId":"playlistController.state","description":"get the user state (fav/rating) by playlist id","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/playlist/states":{"get":{"operationId":"playlistController.states","description":"get the user states (fav/rating) by playlist ids","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.States"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/playlist/tracks":{"get":{"operationId":"playlistController.tracks","description":"get tracks of a playlist(s) by playlist ids","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.TrackList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/playlist/list":{"get":{"operationId":"playlistController.list","description":"get a playlist list by playlist list type","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PlaylistList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"list","schema":{"$ref":"#/components/schemas/JamParameters.ListType"},"description":"the type of the item list","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"playlistTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on playlist(s)","required":false},{"in":"query","name":"playlistTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on playlist(s)","required":false},{"in":"query","name":"playlistState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on playlist(s)","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by playlist name","required":false},{"in":"query","name":"isPublic","schema":{"type":"boolean"},"description":"filter by public state","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/user/id":{"get":{"operationId":"userController.id","description":"get an user by id","tags":["user"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.User"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/user/ids":{"get":{"operationId":"userController.ids","description":"get users by ids","tags":["user"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.User"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/user/search":{"get":{"operationId":"userController.search","description":"search users","tags":["user"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.UserList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"name","schema":{"type":"string"},"description":"filter by user name","required":false},{"in":"query","name":"isAdmin","schema":{"type":"boolean"},"description":"filter by user admin role","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/user/sessions/list":{"get":{"operationId":"sessionController.sessions","description":"get infos about the user sessions","tags":["user"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.UserSession"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}}}},"/playqueue/get":{"get":{"operationId":"playqueueController.get","description":"get a playqueue for calling user","tags":["playqueue"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.PlayQueue"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"playQueueTracks","schema":{"default":false,"type":"boolean"},"description":"include tracks on playqueue","required":false},{"in":"query","name":"playQueueTrackIDs","schema":{"default":false,"type":"boolean"},"description":"include track ids on playqueue","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/bookmark/id":{"get":{"operationId":"bookmarkController.id","description":"get a bookmark by id","tags":["bookmark"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Bookmark"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true},{"in":"query","name":"bookmarkTrack","schema":{"default":false,"type":"boolean"},"description":"include the track of the bookmark","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false}]}},"/bookmark/ids":{"get":{"operationId":"bookmarkController.ids","description":"get bookmarks by ids","tags":["bookmark"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.BookmarkList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true},{"in":"query","name":"bookmarkTrack","schema":{"default":false,"type":"boolean"},"description":"include the track of the bookmark","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/bookmark/list":{"get":{"operationId":"bookmarkController.list","description":"get a bookmarks list for the calling user","tags":["bookmark"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.BookmarkList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"bookmarkTrack","schema":{"default":false,"type":"boolean"},"description":"include the track of the bookmark","required":false},{"in":"query","name":"trackMedia","schema":{"default":false,"type":"boolean"},"description":"include media information on track(s)","required":false},{"in":"query","name":"trackTag","schema":{"default":false,"type":"boolean"},"description":"include tag on track(s)","required":false},{"in":"query","name":"trackRawTag","schema":{"default":false,"type":"boolean"},"description":"include raw tag on track(s)","required":false},{"in":"query","name":"trackState","schema":{"default":false,"type":"boolean"},"description":"include user states (fav,rate) on track(s)","required":false},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/bookmark/byTrack/list":{"get":{"operationId":"bookmarkController.byTrackList","description":"get a bookmarks list for a track id for the calling user","tags":["bookmark"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.BookmarkList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"trackID","schema":{"type":"string"},"description":"a track id","required":true},{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false}]}},"/root/id":{"get":{"operationId":"rootController.id","description":"get a root by id","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Root"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/root/ids":{"get":{"operationId":"rootController.ids","description":"get roots by ids","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Root"}}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"array of item ids","required":true}]}},"/root/search":{"get":{"operationId":"rootController.search","description":"search roots","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.RootList"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"offset","schema":{"default":0,"minimum":0,"type":"integer"},"description":"get back items from position","required":false},{"in":"query","name":"amount","schema":{"minimum":1,"type":"integer"},"description":"get back number of items","required":false},{"in":"query","name":"sortField","schema":{"enum":["created","name"],"type":"string"},"description":"sort the result by","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"search by id","required":false},{"in":"query","name":"ids","schema":{"type":"array","items":{"type":"string"}},"description":"search by ids","required":false},{"in":"query","name":"query","schema":{"type":"string"},"description":"search query","required":false},{"in":"query","name":"sortDescending","schema":{"default":false,"type":"boolean"},"description":"sort direction","required":false}]}},"/root/status":{"get":{"operationId":"rootController.status","description":"scanning status of a root scan by root id","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.RootStatus"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/admin/settings":{"get":{"operationId":"settingsController.admin","description":"get admin settings for the server","tags":["admin"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminSettings"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}}}},"/admin/queue/id":{"get":{"operationId":"rootController.queueId","description":"get admin change request status","tags":["admin"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/folder/download":{"get":{"operationId":"folderController.download","description":"download folder as binary archive","tags":["folder"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/folder/image":{"get":{"operationId":"folderController.image","description":"download default image as binary","tags":["folder"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/folder/artwork/image":{"get":{"operationId":"folderController.artworkImage","description":"download artwork image as binary","tags":["folder"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/track/stream":{"get":{"operationId":"trackController.stream","description":"download track media as binary","tags":["track"],"responses":{"200":{"description":"binary data","content":{"audio/mpeg":{"schema":{"type":"string","format":"binary"}},"audio/flac":{"schema":{"type":"string","format":"binary"}},"audio/mp4":{"schema":{"type":"string","format":"binary"}},"audio/ogg":{"schema":{"type":"string","format":"binary"}},"audio/x-flv":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"maxBitRate","schema":{"minimum":10,"type":"integer"},"description":"maximal bitrate if transcoding (in Kbps)","required":false},{"in":"query","name":"format","schema":{"default":"mp3","enum":["flac","flv","m4a","mp3","mp4","oga","ogg","wav","webm","webma"],"type":"string"},"description":"format of audio stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/track/download":{"get":{"operationId":"trackController.download","description":"download track media as binary archive","tags":["track"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/track/image":{"get":{"operationId":"trackController.image","description":"download default image as binary","tags":["track"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/episode/stream":{"get":{"operationId":"episodeController.stream","description":"download episode media as binary","tags":["episode"],"responses":{"200":{"description":"binary data","content":{"audio/mpeg":{"schema":{"type":"string","format":"binary"}},"audio/flac":{"schema":{"type":"string","format":"binary"}},"audio/mp4":{"schema":{"type":"string","format":"binary"}},"audio/ogg":{"schema":{"type":"string","format":"binary"}},"audio/x-flv":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"maxBitRate","schema":{"minimum":10,"type":"integer"},"description":"maximal bitrate if transcoding (in Kbps)","required":false},{"in":"query","name":"format","schema":{"default":"mp3","enum":["flac","flv","m4a","mp3","mp4","oga","ogg","wav","webm","webma"],"type":"string"},"description":"format of audio stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/episode/download":{"get":{"operationId":"episodeController.download","description":"download episode media as binary archive","tags":["episode"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/episode/image":{"get":{"operationId":"episodeController.image","description":"download default image as binary","tags":["episode"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/podcast/image":{"get":{"operationId":"podcastController.image","description":"download default image as binary","tags":["podcast"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/podcast/download":{"get":{"operationId":"podcastController.download","description":"download podcast episodes as binary archive","tags":["podcast"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/artist/image":{"get":{"operationId":"artistController.image","description":"download default image as binary","tags":["artist"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/artist/download":{"get":{"operationId":"artistController.download","description":"download artist tracks as binary archive","tags":["artist"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/album/image":{"get":{"operationId":"albumController.image","description":"download default image as binary","tags":["album"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/album/download":{"get":{"operationId":"albumController.download","description":"download album tracks as binary archive","tags":["album"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/playlist/image":{"get":{"operationId":"playlistController.image","description":"download default image as binary","tags":["playlist"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/playlist/download":{"get":{"operationId":"playlistController.download","description":"download playlist tracks as binary archive","tags":["playlist"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/user/image":{"get":{"operationId":"userController.image","description":"download default image as binary","tags":["user"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/root/image":{"get":{"operationId":"rootController.image","description":"download default image as binary","tags":["root"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":false},{"in":"query","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":false},{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/image/{id}-{size}.{format}":{"get":{"operationId":"imageController.image","description":"download image for object as binary by id","tags":["image"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":true},{"in":"path","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":true},{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/image/{id}-{size}":{"get":{"operationId":"imageController.image2","description":"download image for object as binary by id","tags":["image"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"size","schema":{"minimum":16,"maximum":1024,"type":"integer"},"description":"size of the image","required":true},{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/image/{id}.{format}":{"get":{"operationId":"imageController.image3","description":"download image for object as binary by id","tags":["image"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"format","schema":{"enum":["jpeg","jpg","png","tiff"],"type":"string"},"description":"format of the image","required":true},{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/image/{id}":{"get":{"operationId":"imageController.image4","description":"download image for object as binary by id","tags":["image"],"responses":{"200":{"description":"binary data","content":{"image/jpeg":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/stream/{id}.{format}":{"get":{"operationId":"streamController.stream","description":"stream a media file in a format","tags":["media"],"responses":{"200":{"description":"binary data","content":{"audio/mpeg":{"schema":{"type":"string","format":"binary"}},"audio/flac":{"schema":{"type":"string","format":"binary"}},"audio/mp4":{"schema":{"type":"string","format":"binary"}},"audio/ogg":{"schema":{"type":"string","format":"binary"}},"audio/x-flv":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"format","schema":{"default":"mp3","enum":["flac","flv","m4a","mp3","mp4","oga","ogg","wav","webm","webma"],"type":"string"},"description":"format of audio stream","required":true},{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/stream/{id}":{"get":{"operationId":"streamController.stream2","description":"stream a media file","tags":["media"],"responses":{"200":{"description":"binary data","content":{"audio/mpeg":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/waveform/{id}.{format}":{"get":{"operationId":"waveformController.waveform","description":"get peaks waveform data as svg | json | binary","tags":["media"],"responses":{"200":{"description":"binary data","content":{"image/svg+xml":{"schema":{"type":"string","format":"binary"}},"application/json":{"schema":{"type":"string","format":"binary"}},"application/binary":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"format","schema":{"default":"svg","enum":["dat","json","svg"],"type":"string"},"description":"format of waveform data","required":true},{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/waveform_svg/{id}-{width}.svg":{"get":{"operationId":"waveformController.svg","description":"get peaks waveform data as svg with a width","tags":["media"],"responses":{"200":{"description":"binary data","content":{"image/svg+xml":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"width","schema":{"minimum":1,"maximum":6000,"type":"integer"},"description":"width","required":true},{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/waveform_json":{"get":{"operationId":"waveformController.json","description":"get peaks waveform data as json","tags":["media"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.WaveFormData"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"query","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/download/{id}":{"get":{"operationId":"downloadController.download","description":"download object as binary archive by id","tags":["media"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/download/{id}.{format}":{"get":{"operationId":"downloadController.download2","description":"download object as binary archive by id","tags":["media"],"responses":{"200":{"description":"binary data","content":{"application/zip":{"schema":{"type":"string","format":"binary"}},"application/tar":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"parameters":[{"in":"path","name":"format","schema":{"default":"zip","enum":["tar","zip"],"type":"string"},"description":"format of download stream","required":true},{"in":"path","name":"id","schema":{"type":"string"},"description":"the item id","required":true}]}},"/login":{"post":{"operationId":"login","description":"login an user","tags":["access"],"responses":{"200":{"description":"ok","headers":{"Set-Cookie":{"schema":{"type":"string","example":"jam.sid=abcde12345; Path=/; HttpOnly"}}},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Session"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"security":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Login"}}}}}},"/logout":{"post":{"operationId":"logout","description":"logout an user","tags":["access"],"responses":{"200":{"description":"ok"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}}}},"/stream/scrobble":{"post":{"operationId":"streamController.scrobble","description":"scrobble a media file","tags":["media"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/bookmark/create":{"post":{"operationId":"bookmarkController.create","description":"create a bookmark","tags":["bookmark"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Bookmark"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.BookmarkCreate"}}}}}},"/bookmark/delete":{"post":{"operationId":"bookmarkController.delete","description":"delete a bookmark by id","tags":["bookmark"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.BookmarkDelete"}}}}}},"/bookmark/byTrack/delete":{"post":{"operationId":"bookmarkController.byTrackDelete","description":"delete all bookmark by track ID","tags":["bookmark"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.BookmarkTrackDelete"}}}}}},"/chat/create":{"post":{"operationId":"chatController.create","description":"create a chat message","tags":["chat"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ChatNew"}}}}}},"/chat/delete":{"post":{"operationId":"chatController.delete","description":"delete a chat message","tags":["chat"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ChatDelete"}}}}}},"/radio/create":{"post":{"operationId":"radioController.create","description":"create an internet radio entry","tags":["radio"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Radio"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.RadioNew"}}}}}},"/radio/update":{"post":{"operationId":"radioController.update","description":"update an internet radio entry","tags":["radio"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.RadioUpdate"}}}}}},"/radio/delete":{"post":{"operationId":"radioController.delete","description":"delete an internet radio entry","tags":["radio"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/track/fav/update":{"post":{"operationId":"trackController.favUpdate","description":"fav/unfav a track","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/track/rate/update":{"post":{"operationId":"trackController.rateUpdate","description":"rate a track","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/track/rawTag/update":{"post":{"operationId":"trackController.rawTagUpdate","description":"write a raw tag to a track","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.RawTagUpdate"}}}}}},"/track/name/update":{"post":{"operationId":"trackController.nameUpdate","description":"rename a track","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Rename a track file","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.TrackEditName"}}}}}},"/track/parent/update":{"post":{"operationId":"trackController.parentUpdate","description":"move a track to a new parent folder","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Move track file(s) to new folder parent","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.TrackMoveParent"}}}}}},"/track/delete":{"post":{"operationId":"trackController.delete","description":"delete a track","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/track/fix":{"post":{"operationId":"trackController.fix","description":"fix a track by health warning id","tags":["track"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.TrackFix"}}}}}},"/folder/artwork/create":{"post":{"operationId":"folderController.artworkCreate","description":"create an artwork by url","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Add an artwork to a folder by url","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.FolderArtworkNew"}}}}}},"/folder/artwork/delete":{"post":{"operationId":"folderController.artworkDelete","description":"delete an artwork","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/folder/artwork/name/update":{"post":{"operationId":"folderController.artworkNameUpdate","description":"rename an artwork","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Rename an artwork in a folder","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.FolderArtworkEditName"}}}}}},"/folder/artworkUpload/create":{"post":{"operationId":"folderController.artworkUploadCreate","description":"create an artwork by upload","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Add an artwork to a folder by upload","required":true,"content":{"multipart/form-data":{"schema":{"allOf":[{"$ref":"#/components/schemas/JamParameters.FolderArtworkUpload"},{"properties":{"image":{"description":"the image","type":"object","properties":{"type":{"type":"string"},"file":{"type":"string","format":"binary"}},"required":["type","file"]}},"required":["image"]}]}}}}}},"/folder/artworkUpload/update":{"post":{"operationId":"folderController.artworkUploadUpdate","description":"update an artwork by upload","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"allOf":[{"$ref":"#/components/schemas/JamParameters.ID"},{"properties":{"image":{"description":"the image","type":"object","properties":{"type":{"type":"string"},"file":{"type":"string","format":"binary"}},"required":["type","file"]}},"required":["image"]}]}}}}}},"/folder/name/update":{"post":{"operationId":"folderController.nameUpdate","description":"rename a folder","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Rename the folder","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.FolderEditName"}}}}}},"/folder/fav/update":{"post":{"operationId":"folderController.favUpdate","description":"fav/unfav a folder","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/folder/rate/update":{"post":{"operationId":"folderController.rateUpdate","description":"rate a folder","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/folder/parent/update":{"post":{"operationId":"folderController.parentUpdate","description":"move a folder to a new parent folder","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Move track folders(s) to new folder parent","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.FolderMoveParent"}}}}}},"/folder/delete":{"post":{"operationId":"folderController.delete","description":"delete a folder","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/folder/create":{"post":{"operationId":"folderController.create","description":"create a folder","tags":["folder"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Create a subfolder","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.FolderCreate"}}}}}},"/album/fav/update":{"post":{"operationId":"albumController.favUpdate","description":"fav/unfav an album","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/album/rate/update":{"post":{"operationId":"albumController.rateUpdate","description":"rate an album","tags":["album"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/artist/fav/update":{"post":{"operationId":"artistController.favUpdate","description":"fav/unfav an artist","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/artist/rate/update":{"post":{"operationId":"artistController.rateUpdate","description":"rate an artist","tags":["artist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/series/fav/update":{"post":{"operationId":"seriesController.favUpdate","description":"fav/unfav a series","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/series/rate/update":{"post":{"operationId":"seriesController.rateUpdate","description":"rate a series","tags":["series"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/episode/fav/update":{"post":{"operationId":"episodeController.favUpdate","description":"fav/unfav an episode","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/episode/rate/update":{"post":{"operationId":"episodeController.rateUpdate","description":"rate an episode","tags":["episode"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/podcast/create":{"post":{"operationId":"podcastController.create","description":"create a podcast","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Podcast"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.PodcastNew"}}}}}},"/podcast/fav/update":{"post":{"operationId":"podcastController.favUpdate","description":"fav/unfav a podcast","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/podcast/rate/update":{"post":{"operationId":"podcastController.rateUpdate","description":"rate a podcast","tags":["podcast"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/podcast/delete":{"post":{"operationId":"podcastController.delete","description":"delete a podcast","tags":["podcast"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/playlist/create":{"post":{"operationId":"playlistController.create","description":"create a playlist","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.Playlist"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.PlaylistNew"}}}}}},"/playlist/update":{"post":{"operationId":"playlistController.update","description":"update a playlist","tags":["playlist"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.PlaylistUpdate"}}}}}},"/playlist/fav/update":{"post":{"operationId":"playlistController.favUpdate","description":"fav/unfav a playlist","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the fav user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Fav"}}}}}},"/playlist/rate/update":{"post":{"operationId":"playlistController.rateUpdate","description":"rate a playlist","tags":["playlist"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.State"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"description":"Change the rating user state","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.Rate"}}}}}},"/playlist/delete":{"post":{"operationId":"playlistController.delete","description":"delete a playlist","tags":["playlist"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/playqueue/update":{"post":{"operationId":"playqueueController.update","description":"create/update the playqueue for calling user","tags":["playqueue"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.PlayQueueSet"}}}}}},"/playqueue/delete":{"post":{"operationId":"playqueueController.delete","description":"delete the playqueue for calling user","tags":["playqueue"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}}}},"/user/create":{"post":{"operationId":"userController.create","description":"create a new user","tags":["user"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.User"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.UserNew"}}}}}},"/user/update":{"post":{"operationId":"userController.update","description":"update user","tags":["user"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.UserUpdate"}}}}}},"/user/password/update":{"post":{"operationId":"userController.passwordUpdate","description":"set a password for the user","tags":["user"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.UserPasswordUpdate"}}}}}},"/user/email/update":{"post":{"operationId":"userController.emailUpdate","description":"set an email for an user","tags":["user"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.UserEmailUpdate"}}}}}},"/user/image/random":{"post":{"operationId":"userController.imageRandom","description":"set an random avatar image for a user (only admins can change images for other users than the current)","tags":["user"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.UserImageRandom"}}}}}},"/user/imageUpload/update":{"post":{"operationId":"userController.imageUploadUpdate","description":"set an avatar image for an user","tags":["user"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"allOf":[{"$ref":"#/components/schemas/JamParameters.ID"},{"properties":{"image":{"description":"the image","type":"object","properties":{"type":{"type":"string"},"file":{"type":"string","format":"binary"}},"required":["type","file"]}},"required":["image"]}]}}}}}},"/user/delete":{"post":{"operationId":"userController.delete","description":"delete an user","tags":["user"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/user/sessions/delete":{"post":{"operationId":"sessionController.delete","description":"remove an user session","tags":["user"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/root/create":{"post":{"operationId":"rootController.create","description":"create a root folder","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.RootNew"}}}}}},"/root/update":{"post":{"operationId":"rootController.update","description":"update root folder properties","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.RootUpdate"}}}}}},"/root/delete":{"post":{"operationId":"rootController.delete","description":"remove a root folder","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.ID"}}}}}},"/root/refresh":{"post":{"operationId":"rootController.refresh","description":"start a root refresh by root id","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.RootRefresh"}}}}}},"/root/refreshAll":{"post":{"operationId":"rootController.refreshAll","description":"start refresh of all roots","tags":["root"],"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AdminChangeQueueInfo"}}}}},"401":{"description":"Unauthorized"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JamParameters.RootRefreshAll"}}}}}},"/admin/settings/update":{"post":{"operationId":"settingsController.adminUpdate","description":"update admin settings for the server","tags":["admin"],"responses":{"200":{"description":"ok"},"400":{"description":"Invalid/Missing parameter"},"401":{"description":"Unauthorized"},"404":{"description":"Item not found"},"500":{"description":"Guru Meditation"}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Jam.AdminSettings"}}}}}}},"components":{"securitySchemes":{"cookieAuth":{"type":"apiKey","in":"cookie","name":"jam.sid"},"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}},"schemas":{"Jam.Ping":{"type":"object","properties":{"version":{"type":"string"}},"required":["version"]},"Jam.Session":{"type":"object","properties":{"version":{"type":"string"},"user":{"$ref":"#/components/schemas/Jam.SessionUser"},"jwt":{"type":"string"},"allowedCookieDomains":{"type":"array","items":{"type":"string"}}},"required":["allowedCookieDomains","version"]},"Jam.SessionUser":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"created":{"type":"number"},"roles":{"$ref":"#/components/schemas/Jam.Roles"}},"required":["created","id","name","roles"]},"Jam.Roles":{"type":"object","properties":{"stream":{"type":"boolean"},"upload":{"type":"boolean"},"podcast":{"type":"boolean"},"admin":{"type":"boolean"}}},"Jam.LastFMResponse":{"type":"object","properties":{"similartracks":{"$ref":"#/components/schemas/LastFM.SimilarTracks"},"toptracks":{"$ref":"#/components/schemas/LastFM.TopTracks"},"artist":{"$ref":"#/components/schemas/LastFM.Artist"},"album":{"$ref":"#/components/schemas/LastFM.Album"},"track":{"$ref":"#/components/schemas/LastFM.Track"}}},"LastFM.SimilarTracks":{"type":"object","properties":{"track":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Track"}},"artist":{"type":"string"}},"required":["artist","track"]},"LastFM.Track":{"type":"object","properties":{"name":{"type":"string"},"url":{"type":"string"},"duration":{"type":"string"},"playcount":{"type":"string"},"mbid":{"type":"string"},"match":{"type":"string"},"rank":{"type":"string"},"streamable":{"$ref":"#/components/schemas/LastFM.Streamable"},"artist":{"$ref":"#/components/schemas/LastFM.ArtistInfo"},"image":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Image"}}},"required":["artist","duration","match","mbid","name","playcount","rank","streamable","url"]},"LastFM.Streamable":{"type":"object","properties":{"sample":{"type":"string"},"fulltrack":{"type":"string"}},"required":["fulltrack","sample"]},"LastFM.ArtistInfo":{"type":"object","properties":{"name":{"type":"string"},"mbid":{"type":"string"},"url":{"type":"string"}},"required":["mbid","name","url"]},"LastFM.Image":{"type":"object","properties":{"url":{"type":"string"},"size":{"type":"string"}},"required":["size","url"]},"LastFM.TopTracks":{"type":"object","properties":{"track":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.TopTrack"}},"artist":{"type":"string"}},"required":["artist","track"]},"LastFM.TopTrack":{"type":"object","properties":{"name":{"type":"string"},"mbid":{"type":"string"},"url":{"type":"string"},"streamable":{"type":"string"},"playcount":{"type":"number"},"listeners":{"type":"number"},"image":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Image"}},"artist":{"$ref":"#/components/schemas/LastFM.ArtistInfo"},"rank":{"type":"string"}},"required":["artist","image","listeners","mbid","name","playcount","rank","streamable","url"]},"LastFM.Artist":{"type":"object","properties":{"name":{"type":"string"},"mbid":{"type":"string"},"url":{"type":"string"},"image":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Image"}},"streamable":{"type":"string"},"ontour":{"type":"string"},"stats":{"$ref":"#/components/schemas/LastFM.Stats"},"tags":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Tag"}},"bio":{"$ref":"#/components/schemas/LastFM.Biography"},"similar":{"$ref":"#/components/schemas/LastFM.SimilarArtists"}},"required":["image","mbid","name","ontour","streamable","tags","url"]},"LastFM.Stats":{"type":"object","properties":{"listeners":{"type":"string"},"playcount":{"type":"string"}},"required":["listeners","playcount"]},"LastFM.Tag":{"type":"object","properties":{"name":{"type":"string"},"url":{"type":"string"}},"required":["name","url"]},"LastFM.Biography":{"type":"object","properties":{"published":{"type":"string"},"summary":{"type":"string"},"content":{"type":"string"},"links":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Link"}}},"required":["content","published","summary"]},"LastFM.Link":{"type":"object","properties":{"url":{"type":"string"},"rel":{"type":"string"},"href":{"type":"string"}},"required":["href","rel","url"]},"LastFM.SimilarArtists":{"type":"object","properties":{"artist":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.SimilarArtist"}}}},"LastFM.SimilarArtist":{"type":"object","properties":{"name":{"type":"string"},"mbid":{"type":"string"},"url":{"type":"string"},"image":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Image"}}},"required":["image","mbid","name","url"]},"LastFM.Album":{"type":"object","properties":{"name":{"type":"string"},"artist":{"type":"string"},"mbid":{"type":"string"},"url":{"type":"string"},"image":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Image"}},"listeners":{"type":"string"},"playcount":{"type":"string"},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Track"}},"tags":{"type":"array","items":{"$ref":"#/components/schemas/LastFM.Tag"}},"wiki":{"$ref":"#/components/schemas/LastFM.Wiki"}},"required":["artist","image","listeners","mbid","name","playcount","tracks","url"]},"LastFM.Wiki":{"type":"object","properties":{"published":{"type":"string"},"summary":{"type":"string"},"content":{"type":"string"}},"required":["content","published","summary"]},"JamParameters.LastFMLookupType":{"enum":["album","album-toptracks","artist","artist-toptracks","track","track-similar"],"type":"string"},"Jam.LyricsOVHResponse":{"type":"object","properties":{"lyrics":{"type":"string"},"source":{"type":"string"}}},"Jam.AcoustidResponse":{"type":"object","properties":{"recordings":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Recording"}},"score":{"type":"number"},"id":{"type":"string"}},"required":["id","recordings","score"]},"Acoustid.Recording":{"type":"object","properties":{"id":{"type":"string"},"sources":{"type":"number"},"artists":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Artist"}},"duration":{"type":"number"},"releasegroups":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Releasegroup"}},"title":{"type":"string"}},"required":["artists","duration","id","releasegroups","sources","title"]},"Acoustid.Artist":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"}},"required":["id","name"]},"Acoustid.Releasegroup":{"type":"object","properties":{"id":{"type":"string"},"releases":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Release"}},"title":{"type":"string"},"secondarytypes":{"type":"array","items":{"type":"string"}},"type":{"type":"string"},"artists":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Artist"}}},"required":["artists","id","releases","secondarytypes","title","type"]},"Acoustid.Release":{"type":"object","properties":{"mediums":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Medium"}},"id":{"type":"string"},"track_count":{"type":"number"},"medium_count":{"type":"number"},"releaseevents":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Releaseevent"}},"country":{"type":"string"},"date":{"$ref":"#/components/schemas/Acoustid.AcousticDate"},"title":{"type":"string"}},"required":["country","date","id","medium_count","mediums","releaseevents","title","track_count"]},"Acoustid.Medium":{"type":"object","properties":{"position":{"type":"number"},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Track"}},"track_count":{"type":"number"},"format":{"type":"string"},"title":{"type":"string"}},"required":["format","position","title","track_count","tracks"]},"Acoustid.Track":{"type":"object","properties":{"position":{"type":"number"},"artists":{"type":"array","items":{"$ref":"#/components/schemas/Acoustid.Artist"}},"id":{"type":"string"},"title":{"type":"string"}},"required":["artists","id","position","title"]},"Acoustid.Releaseevent":{"type":"object","properties":{"date":{"$ref":"#/components/schemas/Acoustid.AcousticDate"},"country":{"type":"string"}},"required":["country","date"]},"Acoustid.AcousticDate":{"type":"object","properties":{"month":{"type":"number"},"year":{"type":"number"},"day":{"type":"number"}},"required":["month","year"]},"Jam.MusicBrainzResponse":{"type":"object","properties":{"artist":{"$ref":"#/components/schemas/MusicBrainz.Artist"},"artists":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Artist"}},"release":{"$ref":"#/components/schemas/MusicBrainz.Release"},"releases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Release"}},"releaseGroup":{"$ref":"#/components/schemas/MusicBrainz.ReleaseGroup"},"releaseGroups":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ReleaseGroup"}},"recording":{"$ref":"#/components/schemas/MusicBrainz.Recording"},"recordings":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Recording"}},"count":{"type":"number"},"offset":{"type":"number"},"created":{"type":"string"}}},"MusicBrainz.Artist":{"type":"object","properties":{"country":{"type":"string"},"gender":{"type":"string"},"genderId":{"type":"string"},"type":{"type":"string"},"typeId":{"type":"string"},"lifeSpan":{"type":"object","properties":{"begin":{"type":"string"},"ended":{"type":"boolean"},"end":{"type":"string"}},"required":["begin","ended"]},"releaseGroups":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ReleaseGroupBase"}},"recordings":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.RecordingBase"}},"releases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ReleaseBase"}},"relations":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Relation"}},"begin_area":{"$ref":"#/components/schemas/MusicBrainz.Area"},"area":{"$ref":"#/components/schemas/MusicBrainz.Area"},"rating":{"$ref":"#/components/schemas/MusicBrainz.Rating"},"ipis":{"type":"array","items":{"type":"string"}},"isnis":{"type":"array","items":{"type":"string"}},"works":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Work"}},"tags":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Tag"}},"id":{"type":"string"},"name":{"type":"string"},"sortName":{"type":"string"},"disambiguation":{"type":"string"},"aliases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Alias"}}},"required":["aliases","area","begin_area","disambiguation","id","ipis","isnis","lifeSpan","name","sortName","type","typeId"]},"MusicBrainz.ReleaseGroupBase":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"disambiguation":{"type":"string"},"firstReleaseDate":{"type":"string"},"primaryType":{"type":"string"},"primaryTypeId":{"type":"string"},"secondaryTypes":{"type":"array","items":{"type":"string"}},"secondaryTypeIds":{"type":"array","items":{"type":"string"}},"rating":{"$ref":"#/components/schemas/MusicBrainz.Rating"},"artistCredit":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ArtistCredit"}},"aliases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Alias"}},"tags":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Tag"}}},"required":["id","primaryType","title"]},"MusicBrainz.Rating":{"type":"object","properties":{"votesCount":{"type":"number"},"value":{"type":"number"}},"required":["value","votesCount"]},"MusicBrainz.ArtistCredit":{"type":"object","properties":{"name":{"type":"string"},"joinphrase":{"type":"string"},"artist":{"$ref":"#/components/schemas/MusicBrainz.ArtistBase"}},"required":["artist","joinphrase","name"]},"MusicBrainz.ArtistBase":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"sortName":{"type":"string"},"disambiguation":{"type":"string"},"aliases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Alias"}}},"required":["aliases","disambiguation","id","name","sortName"]},"MusicBrainz.Alias":{"type":"object","properties":{"name":{"type":"string"},"sortName":{"type":"string"},"locale":{"type":"string"},"type":{"type":"string"},"typeId":{"type":"string"},"primary":{"type":"string"},"beginDate":{"type":"string"},"endDate":{"type":"string"},"ended":{"type":"boolean"}},"required":["ended","name"]},"MusicBrainz.Tag":{"type":"object","properties":{"count":{"type":"number"},"name":{"type":"string"}},"required":["count","name"]},"MusicBrainz.RecordingBase":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"disambiguation":{"type":"string"},"length":{"type":"number"},"video":{"type":"boolean"},"rating":{"$ref":"#/components/schemas/MusicBrainz.Rating"},"aliases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Alias"}},"artistCredit":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ArtistCredit"}},"isrcs":{"type":"array","items":{"type":"string"}}},"required":["id","length","title","video"]},"MusicBrainz.ReleaseBase":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"sortName":{"type":"string"},"status":{"type":"string"},"statusId":{"type":"string"},"date":{"type":"string"},"country":{"type":"string"},"packaging":{"type":"string"},"packagingId":{"type":"string"},"disambiguation":{"type":"string"},"annotation":{"type":"string"},"quality":{"type":"string"},"barcode":{"type":"string"},"asin":{"type":"string"},"textRepresentation":{"type":"object","properties":{"language":{"type":"string"},"script":{"type":"string"}},"required":["language","script"]},"artistCredit":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ArtistCredit"}},"releaseGroup":{"$ref":"#/components/schemas/MusicBrainz.ReleaseGroupBase"},"labelInfo":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Label"}},"tags":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Tag"}},"releaseEvents":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ReleaseEvent"}},"relations":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Relation"}},"coverArtArchive":{"type":"object","properties":{"front":{"type":"boolean"},"back":{"type":"boolean"},"darkened":{"type":"boolean"},"artwork":{"type":"boolean"},"count":{"type":"number"}},"required":["artwork","back","count","darkened","front"]}},"required":["artistCredit","id","labelInfo","releaseEvents","releaseGroup","sortName","status","textRepresentation","title"]},"MusicBrainz.Label":{"type":"object","properties":{"catalogNumber":{"type":"string"},"label":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"disambiguation":{"type":"string"},"labelCode":{"type":"string"},"sortName":{"type":"string"}},"required":["id","name"]},"aliases":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string"},"sortName":{"type":"string"},"ended":{"type":"boolean"}},"required":["ended","name","sortName"]}}},"required":["aliases","catalogNumber","label"]},"MusicBrainz.ReleaseEvent":{"type":"object","properties":{"date":{"type":"string"},"area":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"sortName":{"type":"string"},"disambiguation":{"type":"string"},"iso31661Codes":{"type":"array","items":{"type":"string"}}},"required":["id","iso31661Codes","name","sortName"]}},"required":["area","date"]},"MusicBrainz.Relation":{"type":"object","properties":{"direction":{"type":"string"},"attributeValues":{"type":"object","properties":{}},"targetCredit":{"type":"string"},"targetType":{"type":"string"},"sourceCredit":{"type":"string"},"type":{"type":"string"},"typeId":{"type":"string"},"ended":{"type":"boolean"},"attributes":{"type":"array","items":{"type":"string"}},"end":{"type":"string"},"attributeIds":{"type":"object","properties":{"original":{"type":"string"}}},"url":{"$ref":"#/components/schemas/MusicBrainz.Url"},"artist":{"$ref":"#/components/schemas/MusicBrainz.ArtistBase"},"begin":{"type":"string"}},"required":["begin","direction","ended","targetType","type","typeId"]},"MusicBrainz.Url":{"type":"object","properties":{"id":{"type":"string"},"resource":{"type":"string"}},"required":["id","resource"]},"MusicBrainz.Area":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"sortName":{"type":"string"},"disambiguation":{"type":"string"},"iso31661Codes":{"type":"array","items":{"type":"string"}}},"required":["disambiguation","id","name","sortName"]},"MusicBrainz.Work":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"disambiguation":{"type":"string"},"language":{"type":"string"},"languages":{"type":"array","items":{"type":"string"}},"iswcs":{"type":"array","items":{"type":"string"}},"attributes":{"type":"array","items":{}},"aliases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Alias"}}},"required":["aliases","attributes","disambiguation","id","iswcs","language","languages","title"]},"MusicBrainz.Release":{"type":"object","properties":{"media":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ReleaseMedia"}},"score":{"type":"number"},"count":{"type":"number"},"id":{"type":"string"},"title":{"type":"string"},"sortName":{"type":"string"},"status":{"type":"string"},"statusId":{"type":"string"},"date":{"type":"string"},"country":{"type":"string"},"packaging":{"type":"string"},"packagingId":{"type":"string"},"disambiguation":{"type":"string"},"annotation":{"type":"string"},"quality":{"type":"string"},"barcode":{"type":"string"},"asin":{"type":"string"},"textRepresentation":{"type":"object","properties":{"language":{"type":"string"},"script":{"type":"string"}},"required":["language","script"]},"artistCredit":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ArtistCredit"}},"releaseGroup":{"$ref":"#/components/schemas/MusicBrainz.ReleaseGroupBase"},"labelInfo":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Label"}},"tags":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Tag"}},"releaseEvents":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ReleaseEvent"}},"relations":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Relation"}},"coverArtArchive":{"type":"object","properties":{"front":{"type":"boolean"},"back":{"type":"boolean"},"darkened":{"type":"boolean"},"artwork":{"type":"boolean"},"count":{"type":"number"}},"required":["artwork","back","count","darkened","front"]}},"required":["artistCredit","id","labelInfo","media","releaseEvents","releaseGroup","sortName","status","textRepresentation","title"]},"MusicBrainz.ReleaseMedia":{"type":"object","properties":{"format":{"type":"string"},"formatId":{"type":"string"},"title":{"type":"string"},"discCount":{"type":"number"},"trackCount":{"type":"number"},"position":{"type":"number"},"trackOffset":{"type":"number"},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ReleaseTrack"}},"discs":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Disc"}}},"required":["discCount","format","position","trackCount","trackOffset"]},"MusicBrainz.ReleaseTrack":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"position":{"type":"number"},"length":{"type":"number"},"number":{"type":"string"},"recording":{"$ref":"#/components/schemas/MusicBrainz.RecordingBase"},"artistCredit":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ArtistCredit"}}},"required":["id","length","number","position","title"]},"MusicBrainz.Disc":{"type":"object","properties":{"id":{"type":"string"},"sectors":{"type":"number"},"offsetCount":{"type":"number"},"offsets":{"type":"array","items":{"type":"number"}}},"required":["id","offsetCount","offsets","sectors"]},"MusicBrainz.ReleaseGroup":{"type":"object","properties":{"releases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Release"}},"score":{"type":"number"},"count":{"type":"number"},"id":{"type":"string"},"title":{"type":"string"},"disambiguation":{"type":"string"},"firstReleaseDate":{"type":"string"},"primaryType":{"type":"string"},"primaryTypeId":{"type":"string"},"secondaryTypes":{"type":"array","items":{"type":"string"}},"secondaryTypeIds":{"type":"array","items":{"type":"string"}},"rating":{"$ref":"#/components/schemas/MusicBrainz.Rating"},"artistCredit":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ArtistCredit"}},"aliases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Alias"}},"tags":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Tag"}}},"required":["id","primaryType","title"]},"MusicBrainz.Recording":{"type":"object","properties":{"releases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Release"}},"score":{"type":"number"},"count":{"type":"number"},"id":{"type":"string"},"title":{"type":"string"},"disambiguation":{"type":"string"},"length":{"type":"number"},"video":{"type":"boolean"},"rating":{"$ref":"#/components/schemas/MusicBrainz.Rating"},"aliases":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.Alias"}},"artistCredit":{"type":"array","items":{"$ref":"#/components/schemas/MusicBrainz.ArtistCredit"}},"isrcs":{"type":"array","items":{"type":"string"}}},"required":["id","length","title","video"]},"JamParameters.MusicBrainzLookupType":{"enum":["area","artist","collection","event","instrument","label","place","recording","release","release-group","series","url","work"],"type":"string"},"JamParameters.MusicBrainzSearchType":{"enum":["area","artist","label","recording","release","release-group","work"],"type":"string"},"Jam.AcousticBrainzResponse":{"type":"object","properties":{"highlevel":{"$ref":"#/components/schemas/AcousticBrainz.HighLevel"},"metadata":{"$ref":"#/components/schemas/AcousticBrainz.MetaData"}}},"AcousticBrainz.HighLevel":{"type":"object","properties":{"danceability":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"gender":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"genre_dortmund":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"genre_electronic":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"genre_rosamerica":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"genre_tzanetakis":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"ismir04_rhythm":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"mood_acoustic":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"mood_aggressive":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"mood_electronic":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"mood_happy":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"mood_party":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"mood_relaxed":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"mood_sad":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"moods_mirex":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"timbre":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"tonal_atonal":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"},"voice_instrumental":{"$ref":"#/components/schemas/AcousticBrainz.HighLevelSection"}}},"AcousticBrainz.HighLevelSection":{"type":"object","properties":{"all":{"type":"object","additionalProperties":{"type":"number"}},"probability":{"type":"number"},"value":{"type":"string"},"version":{"$ref":"#/components/schemas/AcousticBrainz.Version"}},"required":["all","probability","value","version"]},"AcousticBrainz.Version":{"type":"object","properties":{"essentia":{"type":"string"},"essentia_build_sha":{"type":"string"},"essentia_git_sha":{"type":"string"},"extractor":{"type":"string"},"gaia":{"type":"string"},"gaia_git_sha":{"type":"string"},"models_essentia_git_sha":{"type":"string"}},"required":["essentia","essentia_build_sha","essentia_git_sha","extractor","gaia","gaia_git_sha","models_essentia_git_sha"]},"AcousticBrainz.MetaData":{"type":"object","properties":{"audio_properties":{"type":"object","properties":{"analysis_sample_rate":{"type":"number"},"bit_rate":{"type":"number"},"codec":{"type":"string"},"downmix":{"type":"string"},"equal_loudness":{"type":"number"},"length":{"type":"number"},"lossless":{"type":"number"},"md5_encoded":{"type":"string"},"replay_gain":{"type":"number"}},"required":["analysis_sample_rate","bit_rate","codec","downmix","equal_loudness","length","lossless","md5_encoded","replay_gain"]},"tags":{"type":"object","properties":{"acoustid_id":{"type":"array","items":{"type":"string"}},"album":{"type":"array","items":{"type":"string"}},"albumartist":{"type":"array","items":{"type":"string"}},"albumartistsort":{"type":"array","items":{"type":"string"}},"artist":{"type":"array","items":{"type":"string"}},"artists":{"type":"array","items":{"type":"string"}},"artistsort":{"type":"array","items":{"type":"string"}},"asin":{"type":"array","items":{"type":"string"}},"barcode":{"type":"array","items":{"type":"string"}},"catalognumber":{"type":"array","items":{"type":"string"}},"composer":{"type":"array","items":{"type":"string"}},"composersort":{"type":"array","items":{"type":"string"}},"date":{"type":"array","items":{"type":"string"}},"discnumber":{"type":"array","items":{"type":"string"}},"discsubtitle":{"type":"array","items":{"type":"string"}},"disctotal":{"type":"array","items":{"type":"string"}},"engineer":{"type":"array","items":{"type":"string"}},"file_name":{"type":"string"},"isrc":{"type":"array","items":{"type":"string"}},"label":{"type":"array","items":{"type":"string"}},"language":{"type":"array","items":{"type":"string"}},"lyricist":{"type":"array","items":{"type":"string"}},"media":{"type":"array","items":{"type":"string"}},"mixer":{"type":"array","items":{"type":"string"}},"musicbrainz_albumartistid":{"type":"array","items":{"type":"string"}},"musicbrainz_albumid":{"type":"array","items":{"type":"string"}},"musicbrainz_artistid":{"type":"array","items":{"type":"string"}},"musicbrainz_recordingid":{"type":"array","items":{"type":"string"}},"musicbrainz_releasegroupid":{"type":"array","items":{"type":"string"}},"musicbrainz_releasetrackid":{"type":"array","items":{"type":"string"}},"musicbrainz_workid":{"type":"array","items":{"type":"string"}},"originaldate":{"type":"array","items":{"type":"string"}},"performer":{"type":"array","items":{"type":"string"}},"producer":{"type":"array","items":{"type":"string"}},"releasecountry":{"type":"array","items":{"type":"string"}},"releasestatus":{"type":"array","items":{"type":"string"}},"releasetype":{"type":"array","items":{"type":"string"}},"script":{"type":"array","items":{"type":"string"}},"title":{"type":"array","items":{"type":"string"}},"totaldiscs":{"type":"array","items":{"type":"string"}},"totaltracks":{"type":"array","items":{"type":"string"}},"tracknumber":{"type":"array","items":{"type":"string"}},"tracktotal":{"type":"array","items":{"type":"string"}},"work":{"type":"array","items":{"type":"string"}}},"required":["acoustid_id","album","albumartist","albumartistsort","artist","artists","artistsort","asin","barcode","catalognumber","composer","composersort","date","discnumber","discsubtitle","disctotal","engineer","file_name","isrc","label","language","lyricist","media","mixer","musicbrainz_albumartistid","musicbrainz_albumid","musicbrainz_artistid","musicbrainz_recordingid","musicbrainz_releasegroupid","musicbrainz_releasetrackid","musicbrainz_workid","originaldate","performer","producer","releasecountry","releasestatus","releasetype","script","title","totaldiscs","totaltracks","tracknumber","tracktotal","work"]},"version":{"type":"object","properties":{"highlevel":{"$ref":"#/components/schemas/AcousticBrainz.Version"},"lowlevel":{"$ref":"#/components/schemas/AcousticBrainz.Version"}},"required":["highlevel","lowlevel"]}},"required":["audio_properties","tags","version"]},"Jam.CoverArtArchiveResponse":{"type":"object","properties":{"images":{"type":"array","items":{"$ref":"#/components/schemas/CoverArtArchive.Image"}},"release":{"type":"string"}},"required":["images"]},"CoverArtArchive.Image":{"type":"object","properties":{"types":{"type":"array","items":{"enum":["Back","Booklet","Front","Liner","Medium","Obi","Other","Poster","Raw","Spine","Sticker","Track","Tray","Unedited","Watermark"],"type":"string"}},"front":{"type":"boolean"},"back":{"type":"boolean"},"edit":{"type":"number"},"image":{"type":"string"},"comment":{"type":"string"},"approved":{"type":"boolean"},"id":{"type":"string"},"thumbnails":{"type":"object","properties":{"250":{"type":"string"},"500":{"type":"string"},"1200":{"type":"string"},"small":{"type":"string"},"large":{"type":"string"}},"required":["1200","250","500","large","small"]}},"required":["approved","back","comment","edit","front","id","image","thumbnails","types"]},"JamParameters.CoverArtArchiveLookupType":{"enum":["release","release-group"],"type":"string"},"Jam.WikipediaSummaryResponse":{"type":"object","properties":{"summary":{"$ref":"#/components/schemas/Jam.WikipediaSummary"}}},"Jam.WikipediaSummary":{"type":"object","properties":{"title":{"type":"string"},"summary":{"type":"string"},"url":{"type":"string"}},"required":["summary","title","url"]},"Jam.WikidataLookupResponse":{"type":"object","properties":{"entity":{"$ref":"#/components/schemas/WikiData.Entity"},"data":{"$ref":"#/components/schemas/WikiData.Entity"}}},"WikiData.Entity":{"type":"object","properties":{"type":{"type":"string"},"id":{"type":"string"},"labels":{"type":"object","additionalProperties":{"type":"object","properties":{"language":{"type":"string"},"value":{"type":"string"}},"required":["language","value"]}},"aliases":{"type":"object","additionalProperties":{"type":"object","properties":{"language":{"type":"string"},"value":{"type":"string"}},"required":["language","value"]}},"descriptions":{"type":"object","additionalProperties":{"type":"object","properties":{"language":{"type":"string"},"value":{"type":"string"}},"required":["language","value"]}},"sitelinks":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/WikiData.SiteLink"}},"claims":{"type":"object","additionalProperties":{"type":"array","items":{"$ref":"#/components/schemas/WikiData.Claim"}}}},"required":["aliases","claims","descriptions","id","labels","sitelinks","type"]},"WikiData.SiteLink":{"type":"object","properties":{"site":{"type":"string"},"title":{"type":"string"},"badges":{"type":"array","items":{"type":"string"}}},"required":["badges","site","title"]},"WikiData.Claim":{"type":"object","properties":{"mainsnak":{"$ref":"#/components/schemas/WikiData.Snak"},"id":{"type":"string"},"type":{"type":"string"},"rank":{"type":"string"},"references":{"type":"array","items":{"type":"object","properties":{"hash":{"type":"string"},"snaks":{"type":"object","additionalProperties":{"type":"array","items":{"$ref":"#/components/schemas/WikiData.Snak"}}},"snakorder":{"type":"array","items":{"type":"string"}}},"required":["hash","snakorder","snaks"]}}},"required":["id","mainsnak","rank","references","type"]},"WikiData.Snak":{"type":"object","properties":{"snaktype":{"type":"string"},"property":{"type":"string"},"hash":{"type":"string"},"datatype":{"type":"string"},"datavalue":{"type":"object","properties":{"type":{"type":"string"},"value":{"anyOf":[{"type":"object","properties":{"id":{"type":"string"},"entity-type":{"type":"string"},"numeric-id":{"type":"number"}},"required":["entity-type","id","numeric-id"]},{"type":"string"}]}},"required":["type","value"]}},"required":["datatype","datavalue","hash","property","snaktype"]},"Jam.AutoComplete":{"type":"object","properties":{"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}},"artists":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}},"albums":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}},"folders":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}},"playlists":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}},"podcasts":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}},"episodes":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}},"series":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AutoCompleteEntry"}}}},"Jam.AutoCompleteEntry":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"}},"required":["id","name"]},"Jam.GenreList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Genre"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.Genre":{"type":"object","properties":{"name":{"type":"string"},"trackCount":{"type":"number"},"albumCount":{"type":"number"},"artistCount":{"type":"number"}},"required":["albumCount","artistCount","name","trackCount"]},"Jam.Stats":{"type":"object","properties":{"rootID":{"type":"string"},"track":{"type":"number"},"folder":{"type":"number"},"series":{"type":"number"},"artist":{"type":"number"},"artistTypes":{"$ref":"#/components/schemas/Jam.StatsAlbumTypes"},"album":{"type":"number"},"albumTypes":{"$ref":"#/components/schemas/Jam.StatsAlbumTypes"},"podcasts":{"type":"number"}},"required":["album","albumTypes","artist","artistTypes","folder","podcasts","series","track"]},"Jam.StatsAlbumTypes":{"type":"object","properties":{"album":{"type":"number"},"compilation":{"type":"number"},"artist_compilation":{"type":"number"},"unknown":{"type":"number"},"live":{"type":"number"},"audiobook":{"type":"number"},"soundtrack":{"type":"number"},"bootleg":{"type":"number"},"ep":{"type":"number"},"single":{"type":"number"}},"required":["album","artist_compilation","audiobook","bootleg","compilation","ep","live","single","soundtrack","unknown"]},"Jam.NowPlayingList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.NowPlaying"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.NowPlaying":{"type":"object","properties":{"username":{"type":"string"},"minutesAgo":{"type":"number"},"track":{"$ref":"#/components/schemas/Jam.Track"}},"required":["minutesAgo","username"]},"Jam.Track":{"type":"object","properties":{"duration":{"type":"number"},"tag":{"$ref":"#/components/schemas/Jam.TrackTag"},"tagRaw":{"$ref":"#/components/schemas/Jam.RawTag"},"media":{"$ref":"#/components/schemas/Jam.TrackMedia"},"parentID":{"type":"string"},"artistID":{"type":"string"},"albumArtistID":{"type":"string"},"albumID":{"type":"string"},"seriesID":{"type":"string"},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["created","duration","id","name","parentID"]},"Jam.TrackTag":{"type":"object","properties":{"title":{"type":"string"},"album":{"type":"string"},"artist":{"type":"string"},"genre":{"type":"string"},"year":{"type":"number"},"trackNr":{"type":"number"},"disc":{"type":"number"},"mbTrackID":{"type":"string"},"mbRecordingID":{"type":"string"},"mbReleaseTrackID":{"type":"string"},"mbReleaseGroupID":{"type":"string"},"mbReleaseID":{"type":"string"},"mbArtistID":{"type":"string"}}},"Jam.RawTag":{"type":"object","properties":{"version":{"type":"number"},"frames":{"$ref":"#/components/schemas/ID3v2Frames.Frames"}},"required":["frames","version"]},"ID3v2Frames.Frames":{"type":"object","additionalProperties":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}},"properties":{"AENC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.AudioEncryption"}},"APIC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Pic"}},"ASPI":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"BUF":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"CDM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"CHAP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Chapter"}},"CM1":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"CNT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Num"}},"COM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.LangDescText"}},"COMM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.LangDescText"}},"COMR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"CRA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.AudioEncryption"}},"CRM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"CTOC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.ChapterToc"}},"ENCR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"EQU":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"EQUA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"ETC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.EventTimingCodes"}},"ETCO":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.EventTimingCodes"}},"GEO":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.GEOB"}},"GEOB":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.GEOB"}},"GRID":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"GRP1":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"IPL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.TextList"}},"IPLS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.TextList"}},"LINK":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Link"}},"LNK":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Link"}},"MCDI":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"MLL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"MLLT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"MVNM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"MVIN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"NCO":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"NCON":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"OWNE":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"PCNT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Num"}},"PCS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Num"}},"PCST":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Num"}},"PIC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Pic"}},"POP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Popularimeter"}},"POPM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Popularimeter"}},"POSS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"PRI":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdBin"}},"PRIV":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdBin"}},"RBUF":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"REV":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"RGAD":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.ReplayGainAdjustment"}},"RVA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.RVA"}},"RVA2":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.RVA2"}},"RVAD":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.RVA"}},"RVRB":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"SEEK":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"SIGN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"SLT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.SynchronisedLyricsEvent"}},"STC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"SYLT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.SynchronisedLyrics"}},"SYTC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"TAL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TALB":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TBP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TBPM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TCM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TCMP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bool"}},"TCO":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TCOM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TCON":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TCOP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TCP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bool"}},"TCR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDAT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDES":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDLY":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDOR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDEN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDRC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDRL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDTG":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TDY":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TEN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TENC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TEXT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TFLT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TGID":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TID":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TIM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TIME":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TIPL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.TextList"}},"TIT1":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TIT2":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TIT3":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TKE":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TKEY":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TKWD":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"TLA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TLAN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TLE":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TLEN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TMCL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.TextList"}},"TMED":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TMOO":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TMT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOAL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOF":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOFN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOL":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOLY":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOPE":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TORY":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TOWN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TP1":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TP2":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TP3":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TP4":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPB":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPE1":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPE2":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPE3":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPE4":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPOS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPRO":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TPUB":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TRC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TRCK":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TRD":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TRDA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TRK":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TRSN":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TRSO":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TS2":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSI":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSIZ":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSO2":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSOA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSOC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSOP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSOT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSST":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSRC":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TSSE":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TST":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TT1":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TT2":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TT3":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TXT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TXX":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdText"}},"TXXX":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdText"}},"TYE":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"TYER":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"UFI":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdAscii"}},"UFID":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdAscii"}},"ULT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.LangDescText"}},"USER":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"USLT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.LangDescText"}},"WAF":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WAR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WAS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WCM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WCOM":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WCOP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WCP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WFD":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"WFED":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"WOAF":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WOAR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WOAS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WORS":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WPAY":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WPB":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WPUB":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Ascii"}},"WXX":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdText"}},"WXXX":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.IdText"}},"XDOR":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"XHD3":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Bin"}},"XSOA":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"XSOP":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}},"XSOT":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Text"}}}},"ID3v2Frames.AudioEncryption":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"previewStart":{"type":"number"},"previewLength":{"type":"number"},"bin":{"type":"string"}},"required":["bin","id","previewLength","previewStart"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Frame":{"type":"object","properties":{"id":{"type":"string"},"value":{"type":"object","properties":{}},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Pic":{"type":"object","properties":{"value":{"type":"object","properties":{"description":{"type":"string"},"pictureType":{"type":"number"},"url":{"type":"string"},"bin":{"type":"string"},"mimeType":{"type":"string"}},"required":["description","pictureType"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Bin":{"type":"object","properties":{"value":{"type":"object","properties":{"bin":{"type":"string"}},"required":["bin"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Chapter":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"start":{"type":"number"},"end":{"type":"number"},"offset":{"type":"number"},"offsetEnd":{"type":"number"}},"required":["end","id","offset","offsetEnd","start"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Text":{"type":"object","properties":{"value":{"type":"object","properties":{"text":{"type":"string"}},"required":["text"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Num":{"type":"object","properties":{"value":{"type":"object","properties":{"num":{"type":"number"}},"required":["num"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.LangDescText":{"type":"object","properties":{"value":{"type":"object","properties":{"language":{"type":"string"},"id":{"type":"string"},"text":{"type":"string"}},"required":["id","language","text"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.ChapterToc":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"ordered":{"type":"boolean"},"topLevel":{"type":"boolean"},"children":{"type":"array","items":{"type":"string"}}},"required":["children","id","ordered","topLevel"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.EventTimingCodes":{"type":"object","properties":{"value":{"type":"object","properties":{"format":{"type":"number"},"events":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.EventTimingCodesEvent"}}},"required":["events","format"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.EventTimingCodesEvent":{"type":"object","properties":{"value":{"type":"object","properties":{"type":{"type":"number"},"timestamp":{"type":"number"}},"required":["timestamp","type"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.GEOB":{"type":"object","properties":{"value":{"type":"object","properties":{"filename":{"type":"string"},"mimeType":{"type":"string"},"contentDescription":{"type":"string"},"bin":{"type":"string"}},"required":["bin","contentDescription","filename","mimeType"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.TextList":{"type":"object","properties":{"value":{"type":"object","properties":{"list":{"type":"array","items":{"type":"string"}}},"required":["list"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Link":{"type":"object","properties":{"value":{"type":"object","properties":{"url":{"type":"string"},"id":{"type":"string"},"additional":{"type":"array","items":{"type":"string"}}},"required":["additional","id","url"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Popularimeter":{"type":"object","properties":{"value":{"type":"object","properties":{"rating":{"type":"number"},"count":{"type":"number"},"email":{"type":"string"}},"required":["count","email","rating"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.IdBin":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"bin":{"type":"string"}},"required":["bin","id"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.ReplayGainAdjustment":{"type":"object","properties":{"value":{"type":"object","properties":{"peak":{"type":"number"},"radioAdjustment":{"type":"number"},"audiophileAdjustment":{"type":"number"}},"required":["audiophileAdjustment","peak","radioAdjustment"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.RVA":{"type":"object","properties":{"value":{"type":"object","properties":{"right":{"type":"number"},"left":{"type":"number"},"peakRight":{"type":"number"},"peakLeft":{"type":"number"},"rightBack":{"type":"number"},"leftBack":{"type":"number"},"peakRightBack":{"type":"number"},"peakLeftBack":{"type":"number"},"center":{"type":"number"},"peakCenter":{"type":"number"},"bass":{"type":"number"},"peakBass":{"type":"number"}},"required":["left","right"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.RVA2":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"channels":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.RVA2Channel"}}},"required":["channels","id"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.RVA2Channel":{"type":"object","properties":{"value":{"type":"object","properties":{"type":{"type":"number"},"adjustment":{"type":"number"},"peak":{"type":"number"}},"required":["adjustment","type"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.SynchronisedLyricsEvent":{"type":"object","properties":{"value":{"type":"object","properties":{"timestamp":{"type":"number"},"text":{"type":"string"}},"required":["text","timestamp"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.SynchronisedLyrics":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"language":{"type":"string"},"timestampFormat":{"type":"number"},"contentType":{"type":"number"},"events":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.SynchronisedLyricsEvent"}}},"required":["contentType","events","id","language","timestampFormat"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Bool":{"type":"object","properties":{"value":{"type":"object","properties":{"bool":{"type":"boolean"}},"required":["bool"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.IdText":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"text":{"type":"string"}},"required":["id","text"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.IdAscii":{"type":"object","properties":{"value":{"type":"object","properties":{"id":{"type":"string"},"text":{"type":"string"}},"required":["id","text"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"ID3v2Frames.Ascii":{"type":"object","properties":{"value":{"type":"object","properties":{"text":{"type":"string"}},"required":["text"]},"id":{"type":"string"},"subframes":{"type":"array","items":{"$ref":"#/components/schemas/ID3v2Frames.Frame"}}},"required":["id","value"]},"Jam.TrackMedia":{"type":"object","properties":{"bitRate":{"type":"number"},"format":{"type":"string"},"channels":{"type":"number"},"sampleRate":{"type":"number"},"size":{"type":"number"}},"required":["format","size"]},"Jam.State":{"type":"object","properties":{"played":{"type":"number"},"lastplayed":{"type":"number"},"faved":{"type":"number"},"rated":{"type":"number"}}},"Jam.ChatMessage":{"type":"object","properties":{"username":{"type":"string"},"userID":{"type":"string"},"time":{"type":"number"},"message":{"type":"string"}},"required":["message","time","userID","username"]},"Jam.FolderIndex":{"type":"object","properties":{"lastModified":{"type":"number"},"groups":{"type":"array","items":{"$ref":"#/components/schemas/Jam.FolderIndexGroup"}}},"required":["groups","lastModified"]},"Jam.FolderIndexGroup":{"type":"object","properties":{"name":{"type":"string"},"entries":{"type":"array","items":{"$ref":"#/components/schemas/Jam.FolderIndexEntry"}}},"required":["entries","name"]},"Jam.FolderIndexEntry":{"type":"object","properties":{"name":{"type":"string"},"folderID":{"type":"string"},"trackCount":{"type":"number"}},"required":["folderID","name","trackCount"]},"Jam.Folder":{"type":"object","properties":{"parentID":{"type":"string"},"level":{"type":"number"},"type":{"$ref":"#/components/schemas/Jam.FolderType"},"trackCount":{"type":"number"},"folderCount":{"type":"number"},"tag":{"$ref":"#/components/schemas/Jam.FolderTag"},"info":{"$ref":"#/components/schemas/Jam.ExtendedInfo"},"folders":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Folder"}},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}},"parents":{"type":"array","items":{"$ref":"#/components/schemas/Jam.FolderParent"}},"artworks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.ArtworkImage"}},"similar":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Folder"}},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["created","id","level","name","type"]},"Jam.FolderType":{"enum":["album","artist","collection","extras","multialbum","unknown"],"type":"string"},"Jam.FolderTag":{"type":"object","properties":{"album":{"type":"string"},"albumType":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"artist":{"type":"string"},"artistSort":{"type":"string"},"genres":{"type":"array","items":{"type":"string"}},"year":{"type":"number"},"mbArtistID":{"type":"string"},"mbReleaseID":{"type":"string"},"mbReleaseGroupID":{"type":"string"}}},"Jam.ExtendedInfo":{"type":"object","properties":{"description":{"type":"string"},"source":{"type":"string"},"license":{"type":"string"},"url":{"type":"string"},"licenseUrl":{"type":"string"}},"required":["description","license","licenseUrl","source","url"]},"Jam.FolderParent":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"}},"required":["id","name"]},"Jam.ArtworkImage":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"types":{"type":"array","items":{"enum":["artist","back","booklet","front","liner","medium","obi","other","poster","raw","spine","sticker","track","tray","unedited","watermark"],"type":"string"}},"height":{"type":"number"},"width":{"type":"number"},"format":{"type":"string"},"size":{"type":"number"}},"required":["id","name","size","types"]},"Jam.TrackList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.FolderList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Folder"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.Info":{"type":"object","properties":{"info":{"$ref":"#/components/schemas/Jam.ExtendedInfo"}}},"JamParameters.ListType":{"enum":["avghighest","faved","frequent","highest","random","recent"],"type":"string"},"Jam.FolderHealth":{"type":"object","properties":{"folder":{"$ref":"#/components/schemas/Jam.Folder"},"health":{"type":"array","items":{"$ref":"#/components/schemas/Jam.HealthHint"}}},"required":["folder","health"]},"Jam.HealthHint":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"details":{"type":"array","items":{"type":"object","properties":{"reason":{"type":"string"},"expected":{"type":"string"},"actual":{"type":"string"}},"required":["reason"]}}},"required":["id","name"]},"Jam.States":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Jam.State"}},"Jam.RawTags":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Jam.RawTag"}},"Jam.TrackHealth":{"type":"object","properties":{"track":{"$ref":"#/components/schemas/Jam.Track"},"health":{"type":"array","items":{"$ref":"#/components/schemas/Jam.HealthHint"}}},"required":["health","track"]},"Jam.TrackLyrics":{"type":"object","properties":{"lyrics":{"type":"string"},"source":{"type":"string"}}},"Jam.PodcastEpisode":{"type":"object","properties":{"podcastID":{"type":"string"},"podcast":{"type":"string"},"status":{"$ref":"#/components/schemas/Jam.PodcastEpisodeStatusType"},"date":{"type":"number"},"summary":{"type":"string"},"guid":{"type":"string"},"author":{"type":"string"},"link":{"type":"string"},"errorMessage":{"type":"string"},"chapters":{"type":"array","items":{"$ref":"#/components/schemas/Jam.PodcastEpisodeChapter"}},"duration":{"type":"number"},"tag":{"$ref":"#/components/schemas/Jam.TrackTag"},"tagRaw":{"$ref":"#/components/schemas/Jam.RawTag"},"media":{"$ref":"#/components/schemas/Jam.TrackMedia"},"parentID":{"type":"string"},"artistID":{"type":"string"},"albumArtistID":{"type":"string"},"albumID":{"type":"string"},"seriesID":{"type":"string"},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["created","date","duration","id","name","parentID","podcast","podcastID","status"]},"Jam.PodcastEpisodeStatusType":{"enum":["completed","deleted","downloading","error","new"],"type":"string"},"Jam.PodcastEpisodeChapter":{"type":"object","properties":{"start":{"type":"number"},"title":{"type":"string"}},"required":["start","title"]},"Jam.PodcastEpisodeList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.PodcastEpisode"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.PodcastEpisodeStatus":{"type":"object","properties":{"status":{"$ref":"#/components/schemas/Jam.PodcastEpisodeStatusType"}},"required":["status"]},"Jam.Podcast":{"type":"object","properties":{"url":{"type":"string"},"status":{"$ref":"#/components/schemas/Jam.PodcastStatusType"},"lastCheck":{"type":"number"},"errorMessage":{"type":"string"},"description":{"type":"string"},"episodeCount":{"type":"number"},"episodes":{"type":"array","items":{"$ref":"#/components/schemas/Jam.PodcastEpisode"}},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["created","id","name","status","url"]},"Jam.PodcastStatusType":{"enum":["completed","downloading","error","new"],"type":"string"},"Jam.PodcastStatus":{"type":"object","properties":{"status":{"$ref":"#/components/schemas/Jam.PodcastStatusType"},"lastCheck":{"type":"number"}},"required":["status"]},"Jam.PodcastList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Podcast"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.Radio":{"type":"object","properties":{"url":{"type":"string"},"homepage":{"type":"string"},"created":{"type":"number"},"changed":{"type":"number"},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"}},"required":["changed","created","id","name","url"]},"Jam.RadioList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Radio"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.Artist":{"type":"object","properties":{"albumCount":{"type":"number"},"trackCount":{"type":"number"},"seriesCount":{"type":"number"},"mbArtistID":{"type":"string"},"genres":{"type":"array","items":{"type":"string"}},"albumTypes":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}},"trackIDs":{"type":"array","items":{"type":"string"}},"albumIDs":{"type":"array","items":{"type":"string"}},"seriesIDs":{"type":"array","items":{"type":"string"}},"series":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Series"}},"albums":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Album"}},"similar":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Artist"}},"info":{"$ref":"#/components/schemas/Jam.ExtendedInfo"},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["albumCount","albumTypes","created","id","name","seriesCount","trackCount"]},"Jam.Series":{"type":"object","properties":{"artist":{"type":"string"},"artistID":{"type":"string"},"albumCount":{"type":"number"},"trackCount":{"type":"number"},"albumTypes":{"type":"array","items":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"}},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}},"trackIDs":{"type":"array","items":{"type":"string"}},"albumIDs":{"type":"array","items":{"type":"string"}},"albums":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Album"}},"info":{"$ref":"#/components/schemas/Jam.ExtendedInfo"},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["albumCount","albumTypes","artist","artistID","created","id","name","trackCount"]},"Jam.Album":{"type":"object","properties":{"albumType":{"$ref":"#/components/schemas/Jam.AlbumType"},"trackCount":{"type":"number"},"duration":{"type":"number"},"artistID":{"type":"string"},"artist":{"type":"string"},"genres":{"type":"array","items":{"type":"string"}},"year":{"type":"number"},"mbArtistID":{"type":"string"},"mbReleaseID":{"type":"string"},"series":{"type":"string"},"seriesID":{"type":"string"},"seriesNr":{"type":"string"},"trackIDs":{"type":"array","items":{"type":"string"}},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}},"info":{"$ref":"#/components/schemas/Jam.ExtendedInfo"},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["albumType","artistID","created","duration","id","name","trackCount"]},"Jam.AlbumType":{"enum":["album","audiobook","bootleg","compilation","ep","live","series","single","soundtrack","unknown"],"type":"string"},"Jam.ArtistList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Artist"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.ArtistIndex":{"type":"object","properties":{"lastModified":{"type":"number"},"groups":{"type":"array","items":{"$ref":"#/components/schemas/Jam.ArtistIndexGroup"}}},"required":["groups","lastModified"]},"Jam.ArtistIndexGroup":{"type":"object","properties":{"name":{"type":"string"},"entries":{"type":"array","items":{"$ref":"#/components/schemas/Jam.ArtistIndexEntry"}}},"required":["entries","name"]},"Jam.ArtistIndexEntry":{"type":"object","properties":{"name":{"type":"string"},"artistID":{"type":"string"},"albumCount":{"type":"number"},"trackCount":{"type":"number"}},"required":["albumCount","artistID","name","trackCount"]},"Jam.AlbumList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Album"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.SeriesList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Series"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.AlbumIndex":{"type":"object","properties":{"lastModified":{"type":"number"},"groups":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AlbumIndexGroup"}}},"required":["groups","lastModified"]},"Jam.AlbumIndexGroup":{"type":"object","properties":{"name":{"type":"string"},"entries":{"type":"array","items":{"$ref":"#/components/schemas/Jam.AlbumIndexEntry"}}},"required":["entries","name"]},"Jam.AlbumIndexEntry":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"artist":{"type":"string"},"artistID":{"type":"string"},"trackCount":{"type":"number"}},"required":["artist","artistID","id","name","trackCount"]},"Jam.SeriesIndex":{"type":"object","properties":{"lastModified":{"type":"number"},"groups":{"type":"array","items":{"$ref":"#/components/schemas/Jam.SeriesIndexGroup"}}},"required":["groups","lastModified"]},"Jam.SeriesIndexGroup":{"type":"object","properties":{"name":{"type":"string"},"entries":{"type":"array","items":{"$ref":"#/components/schemas/Jam.SeriesIndexEntry"}}},"required":["entries","name"]},"Jam.SeriesIndexEntry":{"type":"object","properties":{"name":{"type":"string"},"seriesID":{"type":"string"},"albumCount":{"type":"number"},"trackCount":{"type":"number"}},"required":["albumCount","name","seriesID","trackCount"]},"Jam.Playlist":{"type":"object","properties":{"userID":{"type":"string"},"isPublic":{"type":"boolean"},"comment":{"type":"string"},"duration":{"type":"number"},"trackCount":{"type":"number"},"changed":{"type":"number"},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}},"trackIDs":{"type":"array","items":{"type":"string"}},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["changed","created","duration","id","isPublic","name","trackCount","userID"]},"Jam.PlaylistList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Playlist"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.User":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"created":{"type":"number"},"email":{"type":"string"},"roles":{"$ref":"#/components/schemas/Jam.Roles"}},"required":["created","email","id","name","roles"]},"Jam.UserList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.User"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.UserSession":{"type":"object","properties":{"id":{"type":"string"},"client":{"type":"string"},"expires":{"type":"number"},"mode":{"$ref":"#/components/schemas/Jam.SessionMode"},"platform":{"type":"string"},"agent":{"type":"string"},"os":{"type":"string"}},"required":["client","expires","id","mode"]},"Jam.SessionMode":{"enum":["browser","jwt"],"type":"string"},"Jam.PlayQueue":{"type":"object","properties":{"trackIDs":{"type":"array","items":{"type":"string"}},"tracks":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Track"}},"currentID":{"type":"string"},"position":{"type":"number"},"changed":{"type":"number"},"changedBy":{"type":"string"}},"required":["changed","changedBy"]},"Jam.Bookmark":{"type":"object","properties":{"id":{"type":"string"},"track":{"$ref":"#/components/schemas/Jam.Track"},"trackID":{"type":"string"},"position":{"type":"number"},"comment":{"type":"string"},"created":{"type":"number"},"changed":{"type":"number"}},"required":["changed","created","id","position","trackID"]},"Jam.BookmarkList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Bookmark"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.Root":{"type":"object","properties":{"path":{"type":"string"},"status":{"$ref":"#/components/schemas/Jam.RootStatus"},"strategy":{"$ref":"#/components/schemas/Jam.RootScanStrategy"},"id":{"type":"string"},"state":{"$ref":"#/components/schemas/Jam.State"},"name":{"type":"string"},"created":{"type":"number"}},"required":["created","id","name","path","status","strategy"]},"Jam.RootStatus":{"type":"object","properties":{"lastScan":{"type":"number"},"error":{"type":"string"},"scanning":{"type":"boolean"}},"required":["lastScan"]},"Jam.RootScanStrategy":{"enum":["artistalbum","audiobook","auto","compilation"],"type":"string"},"Jam.RootList":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/Jam.Root"}},"offset":{"type":"number"},"amount":{"type":"number"},"total":{"type":"number"}},"required":["items"]},"Jam.AdminSettings":{"type":"object","properties":{"chat":{"$ref":"#/components/schemas/Jam.AdminSettingsChat"},"index":{"$ref":"#/components/schemas/Jam.AdminSettingsIndex"},"library":{"$ref":"#/components/schemas/Jam.AdminSettingsLibrary"},"externalServices":{"$ref":"#/components/schemas/Jam.AdminSettingsExternal"}},"required":["chat","externalServices","index","library"]},"Jam.AdminSettingsChat":{"type":"object","properties":{"maxMessages":{"type":"number"},"maxAge":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string"}},"required":["unit","value"]}},"required":["maxAge","maxMessages"]},"Jam.AdminSettingsIndex":{"type":"object","properties":{"ignoreArticles":{"type":"array","items":{"type":"string"}}},"required":["ignoreArticles"]},"Jam.AdminSettingsLibrary":{"type":"object","properties":{"scanAtStart":{"type":"boolean"}},"required":["scanAtStart"]},"Jam.AdminSettingsExternal":{"type":"object","properties":{"enabled":{"type":"boolean"}},"required":["enabled"]},"Jam.AdminChangeQueueInfo":{"type":"object","properties":{"id":{"type":"string"},"pos":{"type":"number"},"error":{"type":"string"},"done":{"type":"number"}},"required":["id"]},"Jam.WaveFormData":{"type":"object","properties":{"version":{"description":"The version number of the waveform data format.","type":"number"},"channels":{"description":"The number of waveform channels present (version 2 only).","type":"number"},"sample_rate":{"description":"Sample rate of original audio file (Hz).","type":"number"},"samples_per_pixel":{"description":"Number of audio samples per waveform minimum/maximum pair.","type":"number"},"bits":{"description":"Resolution of waveform data. May be either 8 or 16.","type":"number"},"length":{"description":"Length of waveform data (number of minimum and maximum value pairs per channel).","type":"number"},"data":{"description":"Array of minimum and maximum waveform data points, interleaved. Depending on bits, each value may be in the range -128 to +127 or -32768 to +32727.","type":"array","items":{"type":"number"}}},"required":["bits","data","length","sample_rate","samples_per_pixel","version"]},"JamParameters.Login":{"type":"object","properties":{"username":{"description":"user name","type":"string"},"password":{"description":"password","type":"string"},"client":{"description":"client name","type":"string"},"jwt":{"description":"request a jwt token, if the client is an app or browser from another domain","type":"boolean"}},"required":["client","password","username"]},"JamParameters.ID":{"type":"object","properties":{"id":{"description":"the item id","type":"string"}},"required":["id"]},"JamParameters.BookmarkCreate":{"type":"object","properties":{"trackID":{"description":"a track id","type":"string"},"comment":{"description":"a comment","type":"string"},"position":{"description":"the position of the bookmark (in ms)","minimum":0,"type":"integer"}},"required":["position"]},"JamParameters.BookmarkDelete":{"type":"object","properties":{"id":{"description":"a bookmark id","type":"string"}},"required":["id"]},"JamParameters.BookmarkTrackDelete":{"type":"object","properties":{"trackID":{"description":"a track id","type":"string"}},"required":["trackID"]},"JamParameters.ChatNew":{"type":"object","properties":{"message":{"description":"the chat message","type":"string"}},"required":["message"]},"JamParameters.ChatDelete":{"type":"object","properties":{"time":{"description":"time of the post (unix time)","minimum":0,"type":"integer"}},"required":["time"]},"JamParameters.RadioNew":{"type":"object","properties":{"name":{"description":"radio name","type":"string"},"url":{"description":"radio stream url","type":"string"},"homepage":{"description":"radio homepage url","type":"string"}},"required":["name","url"]},"JamParameters.RadioUpdate":{"type":"object","properties":{"name":{"description":"radio name","type":"string"},"url":{"description":"radio stream url","type":"string"},"homepage":{"description":"radio homepage url","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["id"]},"JamParameters.Fav":{"description":"Change the fav user state","type":"object","properties":{"remove":{"description":"add or remove the item fav","default":false,"type":"boolean"},"id":{"description":"the item id","type":"string"}},"required":["id"]},"JamParameters.Rate":{"description":"Change the rating user state","type":"object","properties":{"rating":{"description":"the rating for the item","minimum":0,"maximum":5,"type":"integer"},"id":{"description":"the item id","type":"string"}},"required":["id","rating"]},"JamParameters.RawTagUpdate":{"type":"object","properties":{"id":{"description":"the id of the track","type":"string"},"tag":{"$ref":"#/components/schemas/Jam.RawTag"}},"required":["id","tag"]},"JamParameters.TrackEditName":{"description":"Rename a track file","type":"object","properties":{"name":{"description":"the new track file name","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["id","name"]},"JamParameters.TrackMoveParent":{"description":"Move track file(s) to new folder parent","type":"object","properties":{"folderID":{"description":"the id of another folder","type":"string"},"ids":{"description":"array of item ids","type":"array","items":{"type":"string"}}},"required":["folderID","ids"]},"JamParameters.TrackFix":{"type":"object","properties":{"fixID":{"description":"which issue to fix with the track","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["fixID","id"]},"JamParameters.FolderArtworkNew":{"description":"Add an artwork to a folder by url","type":"object","properties":{"url":{"description":"url of an image","type":"string"},"types":{"description":"types of the image","type":"array","items":{"enum":["artist","back","booklet","front","liner","medium","obi","other","poster","raw","spine","sticker","track","tray","unedited","watermark"],"type":"string"}},"id":{"description":"the item id","type":"string"}},"required":["id","types","url"]},"JamParameters.FolderArtworkEditName":{"description":"Rename an artwork in a folder","type":"object","properties":{"name":{"description":"name of an image","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["id","name"]},"JamParameters.FolderArtworkUpload":{"description":"Add an artwork to a folder by upload","type":"object","properties":{"id":{"description":"id of folder","type":"string"},"types":{"description":"types of the image","type":"array","items":{"enum":["artist","back","booklet","front","liner","medium","obi","other","poster","raw","spine","sticker","track","tray","unedited","watermark"],"type":"string"}}},"required":["id","types"]},"JamParameters.FolderEditName":{"description":"Rename the folder","type":"object","properties":{"name":{"description":"the new folder name","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["id","name"]},"JamParameters.FolderMoveParent":{"description":"Move track folders(s) to new folder parent","type":"object","properties":{"folderID":{"description":"the id of another folder","type":"string"},"ids":{"description":"array of item ids","type":"array","items":{"type":"string"}}},"required":["folderID","ids"]},"JamParameters.FolderCreate":{"description":"Create a subfolder","type":"object","properties":{"name":{"description":"the new subfolder name","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["id","name"]},"JamParameters.PodcastNew":{"type":"object","properties":{"url":{"description":"podcast feed url","type":"string"}},"required":["url"]},"JamParameters.PlaylistNew":{"type":"object","properties":{"name":{"description":"name of playlist","type":"string"},"comment":{"description":"a comment","type":"string"},"isPublic":{"description":"set the playlist visible for other users or not","type":"boolean"},"trackIDs":{"description":"track ids of the playlist, may include duplicates","type":"array","items":{"type":"string"}}},"required":["name"]},"JamParameters.PlaylistUpdate":{"type":"object","properties":{"name":{"description":"name of playlist","type":"string"},"comment":{"description":"a comment","type":"string"},"isPublic":{"description":"set the playlist visible for other users or not","type":"boolean"},"trackIDs":{"description":"track ids of the playlist, may include duplicates","type":"array","items":{"type":"string"}},"id":{"description":"the item id","type":"string"}},"required":["id"]},"JamParameters.PlayQueueSet":{"type":"object","properties":{"trackIDs":{"description":"the track ids of the playqueue","type":"array","items":{"type":"string"}},"currentID":{"description":"the track id of the current playing track","type":"string"},"position":{"description":"the position in the current playing track","minimum":0,"type":"integer"}},"required":["trackIDs"]},"JamParameters.UserNew":{"type":"object","properties":{"password":{"description":"current password of calling user (or admin) is required to create the user. this is NOT the user password","type":"string"},"name":{"description":"name of the user","type":"string"},"email":{"description":"email of the user","type":"string"},"roleAdmin":{"description":"user has admin rights","default":false,"type":"boolean"},"rolePodcast":{"description":"user has podcast admin rights","default":false,"type":"boolean"},"roleStream":{"description":"user has streaming/download rights","default":true,"type":"boolean"},"roleUpload":{"description":"user has upload rights","default":false,"type":"boolean"}},"required":["name","password"]},"JamParameters.UserUpdate":{"type":"object","properties":{"password":{"description":"password of calling user (or admin) is required to change user settings","type":"string"},"name":{"description":"name of the user","type":"string"},"email":{"description":"email of the user","type":"string"},"roleAdmin":{"description":"user has admin rights","type":"boolean"},"rolePodcast":{"description":"user has podcast admin rights","type":"boolean"},"roleStream":{"description":"user has streaming/download rights","type":"boolean"},"roleUpload":{"description":"user has upload rights","type":"boolean"},"id":{"description":"the item id","type":"string"}},"required":["id","password"]},"JamParameters.UserPasswordUpdate":{"type":"object","properties":{"password":{"description":"current password of calling user (or admin) is required to change the password","type":"string"},"newPassword":{"description":"new password of user","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["id","newPassword","password"]},"JamParameters.UserEmailUpdate":{"type":"object","properties":{"password":{"description":"password of calling user (or admin) is required to change the email address","type":"string"},"email":{"description":"new email address of user","type":"string"},"id":{"description":"the item id","type":"string"}},"required":["email","id","password"]},"JamParameters.UserImageRandom":{"type":"object","properties":{"id":{"description":"id of user (only admins can change images of other users)","type":"string"},"seed":{"description":"seed for the randomizer","type":"string"}}},"JamParameters.RootNew":{"type":"object","properties":{"name":{"description":"name of the root","type":"string"},"path":{"description":"absolute path of the root","type":"string"},"strategy":{"$ref":"#/components/schemas/Jam.RootScanStrategy"}},"required":["name","path","strategy"]},"JamParameters.RootUpdate":{"type":"object","properties":{"name":{"description":"name of the root","type":"string"},"path":{"description":"absolute path of the root","type":"string"},"strategy":{"$ref":"#/components/schemas/Jam.RootScanStrategy"},"id":{"description":"the item id","type":"string"}},"required":["id","name","path","strategy"]},"JamParameters.RootRefresh":{"type":"object","properties":{"id":{"description":"the item id","type":"string"},"refreshMeta":{"description":"the scan strategy for the root","type":"boolean"}},"required":["id"]},"JamParameters.RootRefreshAll":{"type":"object","properties":{"refreshMeta":{"description":"the scan strategy for the root","type":"boolean"}}}}},"security":[]}')},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),a=r(84),n=s.logger("CheckApiParameters");class o{static validateBooleanParameter(e,t,r){if(["true","yes","1"].includes(r.toString()))e[t.name]=!0,r=!0;else{if(!["false","no","0"].includes(r.toString()))return"Invalid boolean parameter "+t.name;e[t.name]=!1,r=!1}e[t.name]=r}static validateNumberParameter(e,t,r,i){const s=r.toString().trim();if(0===s.length)return"Empty number parameter "+t.name;const a=Number(s);return isNaN(a)?"Invalid number parameter "+t.name:(e[t.name]=a,"integer"!==i.type||Number.isInteger(a)?void 0!==i.minimum&&i.minimum>a?`Invalid number parameter ${t.name}; minimum is ${i.minimum}`:void 0!==i.maximum&&i.maximum<a?`Invalid number parameter ${t.name}; maximum is ${i.maximum}`:void 0:"Invalid integer parameter "+t.name)}static validateStringParameter(e,t,r,i){if("string"!=typeof r)return"Invalid string parameter "+t.name;const s=r.trim();return e[t.name]=s,0===s.length?"Empty string parameter "+t.name:i.enum&&!i.enum.includes(s)?`Invalid enum string parameter ${t.name}: ${s}`:void 0}static validateArrayParameter(e,t,r,i){const s=i.items||{type:"unknown"},a=(Array.isArray(r)?r:[r])||[];if(t.required&&0===a.length)return"Missing required parameter "+t.name;e[t.name]=a;for(const e of a){const r=o.validOAParameterValueBySchema({},{name:t.name,required:!0},e,s);if(r)return r}}static validateAnyOfParameter(e,t,r,i){const s=[];for(const a of i.anyOf||[]){const i=o.validOAParameterValueBySchema(e,t,r,a);if(!i)return;s.push(i)}return s.join("/")}static validOAParameterValueBySchema(e,t,r,i){if(null==r&&i&&void 0!==i.default&&(e[t.name]=i.default,r=i.default),null==r)return t.required?"Missing required parameter "+t.name:void 0;if(i.anyOf)return o.validateAnyOfParameter(e,t,r,i);switch(i.type){case"boolean":return o.validateBooleanParameter(e,t,r);case"string":return o.validateStringParameter(e,t,r,i);case"array":return o.validateArrayParameter(e,t,r,i);case"float":case"long":case"double":case"number":case"integer":return o.validateNumberParameter(e,t,r,i);default:n.debug("Unknown schema type "+JSON.stringify(i))}}static validOAParameter(e,t,r){if(!e)return"Missing parameter collection "+t.name;let i=t.schema;if(i&&i.$ref){const e=i.$ref.split("/").pop();if(!r.schemas)throw new Error("Invalid Internal Server Data");i=r.schemas[e]}return o.validOAParameterValueBySchema(e,t,e[t.name],i)}static createJSONValidator(e,t){const r=Object.assign({},e);return r.components=t,a.jsonValidator(r)}static checkAORequestBody(e,t,r){return i(this,void 0,void 0,(function*(){if(!e.requestBody||!e.requestBody.content||!e.requestBody.content["application/json"])return;if(!t)return Promise.reject(Error("Missing Request Body"));const i=e.requestBody.content["application/json"];if(!i)return Promise.reject(Error("Unimplemented POST json schema"));const s=i.schema;if(!s)return Promise.reject(Error("Unimplemented POST schema"));i.validator||(i.validator=o.createJSONValidator(s,r));const n=yield a.validateJSON(t,i.validator);return n.errors.length>0?Promise.reject(Error(JSON.stringify(n.errors))):void 0}))}static checkAOParameters(e,t,r){return i(this,void 0,void 0,(function*(){if(!e.parameters)return;let i;return e.parameters.find(e=>("query"===(e=e).in?i=o.validOAParameter(t.query,e,r):"path"===e.in?i=o.validOAParameter(t.params,e,r):"header"===e.in?i=o.validOAParameter(t.headers,e,r):"cookie"===e.in?i=o.validOAParameter(t.cookies,e,r):n.info("Invalid/Unknown parameter spec",e),!!i)),i?Promise.reject(Error(i)):void 0}))}}t.checkOpenApiParameters=function(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=r.paths[e];if(!i)return void n.info("cmd not found to validate",e);const a=s||t.method.toLowerCase(),c=i[a];c?"get"===a?yield o.checkAOParameters(c,t,r.components):yield o.checkAORequestBody(c,t.body,r.components):n.info(`cmd method ${t.method} not found to validate`,t.path)}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=new(s(r(85)).default);t.jsonValidator=function(e){return a.compile(e)},t.validateJSON=function(e,t){return i(this,void 0,void 0,(function*(){const r=t(e);return("boolean"==typeof r?r:yield r)?{errors:[]}:t.errors?{errors:t.errors}:{errors:[{keyword:"unknown",dataPath:"unknown",schemaPath:"unknown",params:[]}]}}))}},function(e,t){e.exports=require("ajv")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(1),n=r(2),o=r(12),c=r(10),d=r(43),u=n.logger("EpisodeController");class l extends o.BaseListController{constructor(e,t,r,i,s){super(e,r,i,s),this.episodeService=e,this.streamController=t,this.stateService=r,this.imageService=i,this.downloadService=s}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=d.formatEpisode(e,t,this.episodeService.isDownloading(e.id)?a.PodcastStatus.downloading:e.status);if(t.trackState){const t=yield this.stateService.findOrCreate(e.id,r.id,s.DBObjectType.episode);i.state=c.formatState(t)}return i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,name:e.name,id:e.id,ids:e.ids,podcastID:e.podcastID,status:e.status,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:[{field:"date",descending:!0}]}}))}retrieve(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);t.path||this.episodeService.downloadEpisode(t).catch(e=>u.error(e))}))}stream(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.streamController.streamEpisode(t,e.query.format,e.query.maxBitRate,e.user)}))}status(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return{status:this.episodeService.isDownloading(t.id)?a.PodcastStatus.downloading:t.status}}))}}t.EpisodeController=l},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(5),o=r(0),c=r(1),d=r(9),u=r(12),l=r(88),m=r(22),p=r(10),f=r(29);class y extends u.BaseListController{constructor(e,t,r,i,s,a,n,o,c){super(e,a,n,o),this.folderService=e,this.trackController=t,this.metadataService=r,this.indexService=i,this.rootService=s,this.stateService=a,this.imageService=n,this.downloadService=o,this.ioService=c,this.checker=new l.FolderRulesChecker}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=f.formatFolder(e,t);if((t.folderChildren||t.folderTracks)&&(i.tracks=(yield this.trackController.prepareByQuery({parentID:e.id},t,r)).items),t.folderChildren||t.folderSubfolders){const s=yield this.folderService.folderStore.search({parentID:e.id,sorts:[{field:"title",descending:!1}]});i.folders=yield this.prepareList(s.items,{folderState:t.folderState,folderCounts:t.folderCounts,folderTag:t.folderTag},r)}if(t.folderState){const t=yield this.stateService.findOrCreate(e.id,r.id,o.DBObjectType.folder);i.state=p.formatState(t)}if(t.folderInfo&&(e.tag.type===c.FolderType.artist?i.info=yield this.metadataService.extInfo.byFolderArtist(e):c.FolderTypesAlbum.includes(e.tag.type)&&(i.info=yield this.metadataService.extInfo.byFolderAlbum(e))),t.folderSimilar&&e.tag.type===c.FolderType.artist&&(i.similar=yield this.prepareList(yield this.metadataService.similarArtists.byFolder(e),{folderState:t.folderState,folderCounts:t.folderCounts,folderTag:t.folderTag},r)),t.folderParents){const t=yield this.folderService.collectFolderPath(e.parentID);i.parents=t.map(e=>({id:e.id,name:a.default.basename(e.path)}))}return i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){let t;if(e.childOfID){const r=yield this.folderService.folderStore.byId(e.childOfID);r&&(t=r.path)}return{query:e.query,id:e.id,ids:e.ids,rootID:e.rootID,rootIDs:e.rootIDs,parentID:e.parentID,inPath:t,artist:e.artist,title:e.title,album:e.album,genre:e.genre,level:e.level,newerThan:e.newerThan,fromYear:e.fromYear,toYear:e.toYear,offset:e.offset,amount:e.amount,type:e.type?e.type:void 0,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}subfolders(e){return i(this,void 0,void 0,(function*(){const t=yield this.folderService.folderStore.search({parentID:e.query.id,amount:e.query.amount,offset:e.query.offset});return{total:t.total,amount:t.amount,offset:t.offset,items:yield this.prepareList(t.items,e.query,e.user)}}))}tracks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids),r=e.query.recursive?{inPaths:t.map(e=>e.path)}:{parentIDs:t.map(e=>e.id)};return this.trackController.prepareByQuery(r,e.query,e.user)}))}children(e){return i(this,void 0,void 0,(function*(){const t=yield this.folderService.folderStore.search({parentID:e.query.id}),r=yield this.trackController.prepareByQuery({parentID:e.query.id},e.query,e.user);return{folders:yield this.prepareList(t.items,e.query,e.user),tracks:r.items}}))}nameUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.renameFolder(t.id,e.query.name,t.rootID)}))}artistInfo(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return{info:yield this.metadataService.extInfo.byFolderArtist(t)}}))}artistSimilar(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id),r=yield this.metadataService.similarArtists.byFolder(t),i=d.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.prepareList(i.items,e.query,e.user)}}))}albumInfo(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return{info:yield this.metadataService.extInfo.byFolderAlbum(t)}}))}artistSimilarTracks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id),r=yield this.metadataService.similarTracks.byFolder(t),i=d.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.trackController.prepareList(i.items,e.query,e.user)}}))}index(e){return i(this,void 0,void 0,(function*(){return m.formatFolderIndex(yield this.indexService.getFolderIndex(yield this.translateQuery(e.query,e.user)))}))}artworks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return f.formatFolderArtworks(t)}))}artworkByID(e){return i(this,void 0,void 0,(function*(){const t=e.split("-")[0],r=yield this.byID(t),i=(r.tag.artworks||[]).find(t=>t.id===e);return i?{folder:r,artwork:i}:Promise.reject(n.NotFoundError())}))}artworkImage(e){return i(this,void 0,void 0,(function*(){const{folder:t,artwork:r}=yield this.artworkByID(e.query.id);return this.folderService.getArtworkImage(t,r,e.query.size,e.query.format)}))}artworkCreate(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.downloadArtwork(t.id,e.query.url,e.query.types,t.rootID)}))}artworkUploadCreate(e){return i(this,void 0,void 0,(function*(){if(!e.file)return Promise.reject(n.InvalidParamError("Image upload failed"));const t=yield this.byID(e.query.id);return this.ioService.createArtwork(t.id,e.file,e.fileType||"",e.query.types,t.rootID)}))}artworkUploadUpdate(e){return i(this,void 0,void 0,(function*(){if(!e.file)return Promise.reject(n.InvalidParamError("Image upload failed"));const{folder:t,artwork:r}=yield this.artworkByID(e.query.id);return this.ioService.updateArtwork(t.id,r.id,e.file,e.fileType||"",t.rootID)}))}artworkNameUpdate(e){return i(this,void 0,void 0,(function*(){const{folder:t,artwork:r}=yield this.artworkByID(e.query.id);return this.ioService.renameArtwork(t.id,r.id,e.query.name,t.rootID)}))}artworkDelete(e){return i(this,void 0,void 0,(function*(){const{folder:t,artwork:r}=yield this.artworkByID(e.query.id);return this.ioService.deleteArtwork(t.id,r.id,t.rootID)}))}health(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.store.search(yield this.translateQuery(e.query,e.user));t.items=t.items.sort((e,t)=>e.path.localeCompare(t.path));const r=[],i=[],s=t.items.slice(0);for(const a of t.items){let t=i.find(e=>e.id===a.rootID);if(t||(t=yield this.rootService.rootStore.byId(a.rootID),t&&i.push(t)),t){const i=yield this.folderService.collectFolderPath(a.parentID,s),n=yield this.checker.run(a,i,t);n&&n.length>0&&r.push({folder:yield this.prepare(a,e.query,e.user),health:n})}}return r}))}parentUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.folderService.store.byId(e.query.folderID);return t?this.ioService.moveFolders(e.query.ids,t.id,t.rootID):Promise.reject(n.NotFoundError())}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return 0===t.tag.level?Promise.reject(Error("Root folder cannot be deleted")):this.ioService.deleteFolder(t.id,t.rootID)}))}create(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.newFolder(t.id,e.query.name,t.rootID)}))}}t.FolderController=y},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(1),o=r(4),c=r(44),d=[{id:n.FolderHealthID.albumTagsExists,name:"Album folder values are missing",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(n.FolderTypesAlbum.includes(e.tag.type)){const t=[];if(e.tag.album||t.push("album"),e.tag.artist||t.push("artist"),e.tag.genres&&0!==e.tag.genres.length||t.push("genre"),e.tag.albumTrackCount||t.push("album total track count"),void 0!==e.tag.albumType&&n.AlbumTypesArtistMusic.includes(e.tag.albumType)&&(e.tag.year||t.push("year")),t.length>0)return{details:t.map(e=>({reason:"value empty",expected:e}))}}}))},{id:n.FolderHealthID.albumMBIDExists,name:"Album folder musicbrainz id are missing",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(n.FolderTypesAlbum.includes(e.tag.type)){const t=[];if(e.tag.mbReleaseID?e.tag.mbAlbumType||t.push("musicbrainz album type"):t.push("musicbrainz album id"),t.length>0)return{details:t.map(e=>({reason:"value empty",expected:e}))}}}))},{id:n.FolderHealthID.albumTracksComplete,name:"Album folder seems to be incomplete",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(e.tag.type===n.FolderType.album&&e.tag.albumTrackCount&&e.tag.albumTrackCount!==e.tag.trackCount)return{details:[{reason:"not equal",expected:e.tag.albumTrackCount.toString(),actual:e.tag.trackCount.toString()}]}}))},{id:n.FolderHealthID.albumNameConform,name:"Album folder name is not conform",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){function r(t){const r=(i=e.path,a.default.basename(i).trim().replace(/[_:!?/ ]/g,"").toLowerCase());var i;const s=function(e){return e.replace(/[_:!?/ ]/g,"").toLowerCase()}(t);if(0!==r.localeCompare(s))return{details:[{reason:"not equal",actual:a.default.basename(e.path),expected:t}]}}if(e.tag.type===n.FolderType.album||e.tag.type===n.FolderType.multialbum&&0===e.tag.trackCount){if(t.find(e=>e.tag.type===n.FolderType.artist)&&e.tag.album&&e.tag.year&&e.tag.year>0)return r(function(e){const t=e.year?e.year.toString():"";let r=(e.album||"").replace(/[!?]/g,"").replace(/< >/g," - ").replace(/<>/g," - ").replace(/[/]/g,"-").replace(/\.\.\./g,"…").replace(/ {2}/g," ").trim();return r=o.replaceFolderSystemChars(r,"_"),((t.length>0?`[${o.replaceFolderSystemChars(t,"_")}] `:"")+r).trim()}(e.tag));if(e.tag.album)return r(function(e){let t=(e.album||"").replace(/[!?]/g,"").replace(/< >/g," - ").replace(/<>/g," - ").replace(/[/]/g,"-").replace(/\.\.\./g,"…").replace(/ {2}/g," ").trim();return t=o.replaceFolderSystemChars(t,"_"),t.trim()}(e.tag))}}))},{id:n.FolderHealthID.albumImageExists,name:"Album folder image is missing",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(e.tag.type===n.FolderType.album||e.tag.type===n.FolderType.multialbum&&e.tag.folderCount>0){if(!(yield c.getFolderDisplayImage(e)))return{}}}))},{id:n.FolderHealthID.albumImageValid,name:"Album folder image is invalid",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(e.tag.type===n.FolderType.album||e.tag.type===n.FolderType.multialbum&&e.tag.folderCount>0){const t=yield c.getFolderDisplayImage(e);if(t&&(!t.image||"invalid"===t.image.format))return{details:[{reason:"Broken or unsupported File Format"}]};if(t&&t.image){let e=o.fileSuffix(t.name);"jpg"===e&&(e="jpeg");const r=t.image.format;if(e!==r)return{details:[{reason:"Wrong File Extension",actual:e,expected:r}]}}}}))},{id:n.FolderHealthID.albumImageQuality,name:"Album folder image is of low quality",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(e.tag.type===n.FolderType.album||e.tag.type===n.FolderType.multialbum&&e.tag.folderCount>0){const t=yield c.getFolderDisplayImage(e);if(t&&t.image&&t.image.height&&t.image.width&&(t.image.height<300||t.image.width<300))return{details:[{reason:"Image is too small",actual:`${t.image.width} x ${t.image.height}`,expected:">=300 x >=300"}]}}}))},{id:n.FolderHealthID.artistImageExists,name:"Artist folder image is missing",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(e.tag.type===n.FolderType.artist){if(!(yield c.getFolderDisplayImage(e)))return{}}}))},{id:n.FolderHealthID.artistImageValid,name:"Artist folder image is invalid",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(e.tag.type===n.FolderType.artist){const t=yield c.getFolderDisplayImage(e);if(t&&(!t.image||"invalid"===t.image.format))return{details:[{reason:"Broken or unsupported File Format"}]};if(t&&t.image){let e=o.fileSuffix(t.name);"jpg"===e&&(e="jpeg");const r=t.image.format;if(e!==r)return{details:[{reason:"Wrong File Extension",actual:e,expected:r}]}}}}))},{id:n.FolderHealthID.artistNameConform,name:"Artist folder name is not conform",run:(e,t,r)=>i(void 0,void 0,void 0,(function*(){if(e.tag.type===n.FolderType.artist&&e.tag.artist){const t=a.default.basename(e.path).trim().replace(/[_:!?/ ]/g,"").toLowerCase(),r=o.replaceFolderSystemChars(e.tag.artist,"_"),i=r.replace(/[_:!?/ ]/g,"").toLowerCase();if(0!==t.localeCompare(i))return{details:[{reason:"not equal",actual:a.default.basename(e.path),expected:r}]}}}))}];t.FolderRulesChecker=class{run(e,t,r){return i(this,void 0,void 0,(function*(){const i=[];for(const s of d){const a=yield s.run(e,t,r);a&&i.push({id:s.id,name:s.name,details:a.details})}return i}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(9),a=r(90);t.GenreController=class{constructor(e){this.genreService=e}list(e){return i(this,void 0,void 0,(function*(){const t=yield this.genreService.getGenres(e.query.rootID),r=s.paginate(t,e.query.amount,e.query.offset);return{total:r.total,amount:r.amount,offset:r.offset,items:r.items.map(a.formatGenre)}}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatGenre=function(e){return{name:e.name,trackCount:e.trackCount,albumCount:e.albumCount,artistCount:e.artistCount}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(16),a=r(5),n=r(17);t.ImageController=class{constructor(e,t){this.store=e,this.imageService=t}image(e){return i(this,void 0,void 0,(function*(){if(void 0!==e.query.format&&!n.SupportedWriteImageFormat.includes(e.query.format))return Promise.reject(a.InvalidParamError());const t=yield this.byID(e.query.id),r=yield this.imageService.getObjImage(t,e.query.size,e.query.format);return r||Promise.reject(a.NotFoundError())}))}imageByPathParameter(e){return i(this,void 0,void 0,(function*(){const{id:t,size:r,format:i}=yield s.validatePathParameterIDSizeFormat(e.query.pathParameter,n.SupportedWriteImageFormat,void 0,16,1024);return this.image({query:{id:t,size:r,format:i},user:e.user})}))}byID(e){return i(this,void 0,void 0,(function*(){if(!e||0===e.length)return Promise.reject(a.InvalidParamError());const t=yield this.store.findInAll(e);return t||Promise.reject(a.NotFoundError())}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.MetadataController=class{constructor(e,t){this.metadataService=e,this.trackController=t}musicbrainzSearch(e){return i(this,void 0,void 0,(function*(){const t=Object.assign({},e.query);return delete t.type,this.metadataService.musicbrainzSearch(e.query.type,t)}))}acoustidLookup(e){return i(this,void 0,void 0,(function*(){const t=yield this.trackController.byID(e.query.id);return this.metadataService.acoustidLookupTrack(t,e.query.inc)}))}lastfmLookup(e){return i(this,void 0,void 0,(function*(){return this.metadataService.lastFMLookup(e.query.type,e.query.id)}))}acousticbrainzLookup(e){return i(this,void 0,void 0,(function*(){return this.metadataService.acousticbrainzLookup(e.query.id,e.query.nr)}))}coverartarchiveLookup(e){return i(this,void 0,void 0,(function*(){return this.metadataService.coverartarchiveLookup(e.query.type,e.query.id)}))}musicbrainzLookup(e){return i(this,void 0,void 0,(function*(){return this.metadataService.musicbrainzLookup(e.query.type,e.query.id,e.query.inc)}))}wikipediaSummary(e){return i(this,void 0,void 0,(function*(){return this.metadataService.wikipediaSummary(e.query.title,e.query.lang)}))}wikidataSummary(e){return i(this,void 0,void 0,(function*(){return this.metadataService.wikidataSummary(e.query.id,e.query.lang)}))}wikidataLookup(e){return i(this,void 0,void 0,(function*(){return this.metadataService.wikidataLookup(e.query.id)}))}lyricsovhSearch(e){return i(this,void 0,void 0,(function*(){return this.metadataService.lyrics(e.query.artist,e.query.title)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(9),a=r(94);t.NowPlayingController=class{constructor(e){this.nowplayingService=e}list(e){return i(this,void 0,void 0,(function*(){const t=yield this.nowplayingService.getNowPlaying(),r=s.paginate(t,e.query.amount,e.query.offset);return{total:r.total,amount:r.amount,offset:r.offset,items:r.items.map(a.packNowPlaying)}}))}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(14)),a=r(0),n=r(43),o=r(28);t.packNowPlaying=function(e){const t={username:e.user.name,minutesAgo:Math.round(s.default.duration(s.default().diff(s.default(e.time))).asMinutes())};switch(e.obj.type){case a.DBObjectType.track:t.track=o.formatTrack(e.obj,{});break;case a.DBObjectType.episode:{const r=e.obj;t.track=n.formatEpisode(r,{},r.status);break}}return t}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),a=r(0),n=r(9),o=r(12),c=r(10),d=r(96);class u extends o.BaseListController{constructor(e,t,r,i,s){super(e,r,i,s),this.playlistService=e,this.trackController=t,this.stateService=r,this.imageService=i,this.downloadService=s}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=d.formatPlaylist(e,t);if(t.playlistState){const t=yield this.stateService.findOrCreate(e.id,r.id,a.DBObjectType.artist);i.state=c.formatState(t)}return t.playlistTracks&&(i.tracks=yield this.trackController.prepareListByIDs(e.trackIDs,t,r)),i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,name:e.name,userID:t.id,isPublic:e.isPublic,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}create(e){return i(this,void 0,void 0,(function*(){const t=yield this.playlistService.create(e.query.name,e.query.comment,void 0!==e.query.isPublic&&e.query.isPublic,e.user.id,e.query.trackIDs||[]);return this.prepare(t,{playlistTrackIDs:!0,playlistState:!0},e.user)}))}update(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);if(t.userID!==e.user.id)return Promise.reject(s.UnauthError());t.name=e.query.name||t.name,t.comment=e.query.comment||t.comment,t.isPublic=void 0===e.query.isPublic?t.isPublic:e.query.isPublic,t.changed=Date.now(),t.trackIDs=e.query.trackIDs||[],yield this.playlistService.update(t)}))}tracks(e){return i(this,void 0,void 0,(function*(){let t=yield this.byIDs(e.query.ids);t=t.filter(t=>t.userID===e.user.id);let r=[];t.forEach(e=>{r=r.concat(e.trackIDs)});const i=n.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.trackController.prepareListByIDs(i.items,e.query,e.user)}}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);if(t.userID!==e.user.id)return Promise.reject(s.UnauthError());yield this.playlistService.remove(t)}))}}t.PlaylistController=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatPlaylist=function(e,t){return{id:e.id,name:e.name,userID:e.userID,comment:e.comment,isPublic:e.isPublic,duration:e.duration,created:e.created,changed:e.changed,trackCount:e.trackIDs.length,trackIDs:t.playlistTrackIDs?e.trackIDs:void 0}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(98);t.PlayQueueController=class{constructor(e,t){this.playqueueService=e,this.trackController=t}get(e){return i(this,void 0,void 0,(function*(){const t=yield this.playqueueService.getQueueOrCreate(e.user.id,e.client),r=s.formatPlayQueue(t,e.query);return e.query.playQueueTracks&&(r.tracks=yield this.trackController.prepareListByIDs(t.trackIDs,e.query,e.user)),r}))}update(e){return i(this,void 0,void 0,(function*(){return this.playqueueService.save(e.user.id,e.query.trackIDs,e.query.currentID,e.query.position,e.client)}))}delete(e){return i(this,void 0,void 0,(function*(){yield this.playqueueService.remove(e.user.id)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatPlayQueue=function(e,t){return{changed:e.changed,changedBy:e.changedBy,currentID:e.currentID,position:e.position,trackIDs:t.playQueueTrackIDs?e.trackIDs:void 0}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(1),n=r(2),o=r(12),c=r(10),d=r(100),u=n.logger("PodcastController");class l extends o.BaseListController{constructor(e,t,r,i,s){super(e,r,i,s),this.podcastService=e,this.episodeController=t,this.stateService=r,this.imageService=i,this.downloadService=s}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=d.formatPodcast(e,this.podcastService.isDownloading(e.id)?a.PodcastStatus.downloading:e.status);if(t.podcastState){const t=yield this.stateService.findOrCreate(e.id,r.id,s.DBObjectType.podcast);i.state=c.formatState(t)}return t.podcastEpisodes&&(i.episodes=(yield this.episodeController.prepareByQuery({podcastID:e.id},t,r)).items),t.podcastEpisodeCount&&(i.episodeCount=i.episodes?i.episodes.length:yield this.episodeController.episodeService.countEpisodes(e.id)),i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,url:e.url,title:e.title,status:e.status,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}episodes(e){return i(this,void 0,void 0,(function*(){return this.episodeController.prepareByQuery({podcastID:e.query.id,amount:e.query.amount,offset:e.query.offset},e.query,e.user)}))}refreshAll(e){return i(this,void 0,void 0,(function*(){this.podcastService.refreshPodcasts().catch(e=>u.error(e))}))}refresh(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);this.podcastService.refresh(t).catch(e=>u.error(e))}))}create(e){return i(this,void 0,void 0,(function*(){const t=yield this.podcastService.create(e.query.url);return this.podcastService.refresh(t).catch(e=>u.error(e)),this.prepare(t,{},e.user)}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);yield this.podcastService.remove(t)}))}status(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return{lastCheck:t.lastCheck,status:this.podcastService.isDownloading(t.id)?a.PodcastStatus[a.PodcastStatus.downloading]:a.PodcastStatus[t.status]}}))}}t.PodcastController=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatPodcast=function(e,t){return{id:e.id,url:e.url,created:e.created,lastCheck:e.lastCheck>0?e.lastCheck:void 0,status:t,errorMessage:e.errorMessage,name:e.tag?e.tag.title:e.url,description:e.tag?e.tag.description:void 0}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(21),n=r(10),o=r(102);class c extends a.BaseController{constructor(e,t,r,i){super(e,t,r,i),this.radioService=e,this.stateService=t,this.imageService=r,this.downloadService=i}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=o.formatRadio(e);if(t.radioState){const t=yield this.stateService.findOrCreate(e.id,r.id,s.DBObjectType.radio);i.state=n.formatState(t)}return i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,url:e.url,name:e.name,homepage:e.homepage,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}create(e){return i(this,void 0,void 0,(function*(){const t=yield this.radioService.create(e.query.name,e.query.url,e.query.homepage);return this.prepare(t,{radioState:!0},e.user)}))}update(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);yield this.radioService.update(t,e.query.name,e.query.url,e.query.homepage)}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);yield this.radioService.remove(t)}))}}t.RadioController=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatRadio=function(e){return{id:e.id,url:e.url,created:e.created,changed:e.changed,name:e.name,homepage:e.homepage}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(21),a=r(104);class n extends s.BaseController{constructor(e,t,r,i,s){super(e,r,i,s),this.rootService=e,this.ioService=t,this.stateService=r,this.imageService=i,this.downloadService=s}prepare(e,t,r){return i(this,void 0,void 0,(function*(){return a.formatRoot(e,this.ioService.getRootStatus(e.id))}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}create(e){return i(this,void 0,void 0,(function*(){return this.ioService.createRoot(e.query.name,e.query.path,e.query.strategy)}))}update(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.updateRoot(t.id,e.query.name,e.query.path,e.query.strategy)}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.removeRoot(t.id)}))}refreshAll(e){return i(this,void 0,void 0,(function*(){return this.ioService.refresh(e.query.refreshMeta)}))}refresh(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.refreshRoot(t.id,e.query.refreshMeta)}))}status(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.getRootStatus(t.id)}))}queueId(e){return i(this,void 0,void 0,(function*(){return this.ioService.getAdminChangeQueueInfoStatus(e.query.id)}))}}t.RootController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatRoot=function(e,t){return{id:e.id,name:e.name,created:e.created,path:e.path,status:t,strategy:e.strategy}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(9),n=r(12),o=r(22),c=r(10),d=r(106);class u extends n.BaseListController{constructor(e,t,r,i,s,a,n,o){super(e,a,n,o),this.seriesService=e,this.trackController=t,this.albumController=r,this.metaDataService=i,this.indexService=s,this.stateService=a,this.imageService=n,this.downloadService=o}static sortGrouping(e,t){const r=Number(e),i=Number(t);return isNaN(r)||isNaN(i)?(e||"").localeCompare(t||""):r-i}static sortSeriesAlbums(e,t){let r=e.albumType.localeCompare(t.albumType);return 0===r&&(e.seriesNr&&t.seriesNr?r=u.sortGrouping(e.seriesNr,t.seriesNr):(e.seriesNr||t.seriesNr)&&(r=e.seriesNr?1:-1)),0===r&&(r=(t.year||0)-(e.year||0)),0===r&&(r=e.name.localeCompare(t.name)),r}static sortSeriesTracks(e,t){let r=e.parentID.localeCompare(t.parentID);return 0===r&&(r=(t.tag.disc||0)-(e.tag.disc||0)),0===r&&(r=(t.tag.track||0)-(e.tag.track||0)),r}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=d.formatSeries(e,t);if(t.seriesState){const t=yield this.stateService.findOrCreate(e.id,r.id,s.DBObjectType.series);i.state=c.formatState(t)}return t.seriesInfo&&(i.info=yield this.metaDataService.extInfo.bySeries(e)),t.seriesTracks&&(i.tracks=yield this.trackController.prepareListByIDs(e.trackIDs,t,r,u.sortSeriesTracks)),t.seriesAlbums&&(i.albums=yield this.albumController.prepareListByIDs(e.albumIDs,t,r,u.sortSeriesAlbums)),i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,name:e.name,rootID:e.rootID,rootIDs:e.rootIDs,albumID:e.albumID,albumType:e.albumType,albumTypes:e.albumTypes,newerThan:e.newerThan,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}index(e){return i(this,void 0,void 0,(function*(){return o.formatSeriesIndex(yield this.indexService.getSeriesIndex(yield this.translateQuery(e.query,e.user)))}))}albums(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids);let r=[];t.forEach(e=>{r=r.concat(e.albumIDs)});const i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.albumController.prepareListByIDs(i.items,e.query,e.user,u.sortSeriesAlbums)}}))}tracks(e){return i(this,void 0,void 0,(function*(){const t=yield this.byIDs(e.query.ids);let r=[];t.forEach(e=>{r=r.concat(e.trackIDs)});const i=a.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.trackController.prepareListByIDs(i.items,e.query,e.user,u.sortSeriesTracks)}}))}info(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return{info:yield this.metaDataService.extInfo.bySeries(t)}}))}}t.SeriesController=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatSeries=function(e,t){return{id:e.id,name:e.name,artist:e.artist,artistID:e.artistID,albumCount:e.albumIDs.length,trackCount:e.trackIDs.length,albumTypes:e.albumTypes,albumIDs:t.seriesAlbumIDs?e.albumIDs:void 0,trackIDs:t.seriesTrackIDs?e.trackIDs:void 0,created:e.created}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),a=r(30),n=r(31),o=r(108);t.SessionController=class{constructor(e,t){this.sessionService=e,this.config=t}ping(e){return i(this,void 0,void 0,(function*(){return{version:a.JAMAPI_VERSION}}))}session(e){return i(this,void 0,void 0,(function*(){return{version:a.JAMAPI_VERSION,allowedCookieDomains:this.config.server.session.allowedCookieDomains,user:e.user?n.formatSessionUser(e.user):void 0}}))}sessions(e){return i(this,void 0,void 0,(function*(){return(yield this.sessionService.byUserID(e.user.id)).map(o.formatSession)}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.sessionService.byID(e.query.id);return t&&t.userID!==e.user.id&&!e.user.roles.admin?Promise.reject(s.NotFoundError()):t?(yield this.sessionService.remove(t.sessionID),void(yield this.sessionService.clearCache())):Promise.reject(s.NotFoundError())}))}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(109));function a(e){try{return s.default.parse(e.agent)}catch(e){}}t.parseAgent=a,t.formatSession=function(e){const t=a(e);return{id:e.id,client:e.client,expires:e.expires,mode:e.mode,agent:t?t.browser:void 0,os:t?t.os:void 0,platform:t?t.platform:void 0}}},function(e,t){e.exports=require("express-useragent")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.SettingsController=class{constructor(e){this.settingsService=e}admin(e){return i(this,void 0,void 0,(function*(){return this.settingsService.get()}))}adminUpdate(e){return i(this,void 0,void 0,(function*(){yield this.settingsService.updateSettings(e.query)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(112);t.StatsController=class{constructor(e){this.statsService=e}get(e){return i(this,void 0,void 0,(function*(){const t=yield this.statsService.getStats(e.query.rootID);return s.formatStats(t)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatStats=function(e){return{rootID:e.rootID,album:e.album,albumTypes:e.albumTypes,artistTypes:e.artistTypes,artist:e.artist,folder:e.folder,series:e.series,track:e.track,podcasts:e.podcasts}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(16),a=r(5),n=r(0),o=r(1),c=r(2).logger("StreamController");t.StreamController=class{constructor(e,t,r){this.streamService=e,this.nowPlayingService=t,this.store=r}streamTrack(e,t,r,s){return i(this,void 0,void 0,(function*(){return yield this.streamService.streamTrack(e,t,r,s)}))}streamEpisode(e,t,r,s){return i(this,void 0,void 0,(function*(){return yield this.streamService.streamEpisode(e,t,r,s)}))}streamDBObject(e,t,r,s){return i(this,void 0,void 0,(function*(){switch(e.type){case n.DBObjectType.track:return this.streamTrack(e,t,r,s);case n.DBObjectType.episode:return this.streamEpisode(e,t,r,s)}return Promise.reject(Error("Invalid Object Type for Streaming"))}))}scrobble(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);switch(t.type){case n.DBObjectType.track:this.nowPlayingService.reportTrack(t,e.user).catch(e=>c.error(e));break;case n.DBObjectType.episode:this.nowPlayingService.reportEpisode(t,e.user).catch(e=>c.error(e));break;default:return Promise.reject(Error("Invalid Object Type for Scrobbling"))}}))}stream(e){return i(this,void 0,void 0,(function*(){if(void 0!==e.query.format&&!o.AudioFormats.includes(e.query.format))return Promise.reject(a.InvalidParamError());const t=yield this.byID(e.query.id),r=yield this.streamDBObject(t,e.query.format,void 0,e.user);return r||Promise.reject(a.NotFoundError())}))}byID(e){return i(this,void 0,void 0,(function*(){if(!e||0===e.length)return Promise.reject(a.InvalidParamError());const t=yield this.store.findInStores(e,this.store.streamStores());return t||Promise.reject(a.NotFoundError())}))}streamByPathParameter(e){return i(this,void 0,void 0,(function*(){const{id:t,format:r}=yield s.validatePathParameterIDFormat(e.query.pathParameter,o.AudioFormats,void 0);return this.stream({query:{id:t,format:r},user:e.user})}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(5),o=r(0),c=r(32),d=r(2),u=r(9),l=r(12),m=r(115),p=r(10),f=r(28),y=r(19),h=d.logger("TrackController");class g extends l.BaseListController{constructor(e,t,r,i,s,a,n,o,c,d,u){super(e,c,d,u),this.trackService=e,this.folderService=t,this.audioModule=r,this.bookmarkService=i,this.metaService=s,this.streamController=a,this.ioService=n,this.rootService=o,this.stateService=c,this.imageService=d,this.downloadService=u,this.checker=new m.TrackRulesChecker(r)}prepare(e,t,r){return i(this,void 0,void 0,(function*(){const i=f.formatTrack(e,t);if(t.trackRawTag&&(i.tagRaw=yield this.getRawTag(e)),t.trackState){const t=yield this.stateService.findOrCreate(e.id,r.id,o.DBObjectType.track);i.state=p.formatState(t)}return i}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){let t;if(e.childOfID){const r=yield this.folderService.folderStore.byId(e.childOfID);r&&(t=r.path)}return{query:e.query,id:e.id,ids:e.ids,rootID:e.rootID,rootIDs:e.rootIDs,parentID:e.parentID,parentIDs:e.parentIDs,inPath:t,artist:e.artist,title:e.title,album:e.album,artistID:e.artistID,albumArtistID:e.albumArtistID,genre:e.genre,newerThan:e.newerThan,fromYear:e.fromYear,toYear:e.toYear,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}getRawTag(e){return i(this,void 0,void 0,(function*(){try{const t=yield this.audioModule.readRawTag(a.default.join(e.path,e.name));return t||c.trackTagToRawTag(e.tag)}catch(t){return c.trackTagToRawTag(e.tag)}}))}rawTag(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id),r=yield this.getRawTag(t);return r||Promise.reject(Error("Unsupported audio file"))}))}rawTags(e){return i(this,void 0,void 0,(function*(){let t=yield this.byIDs(e.query.ids);t=this.service.defaultSort(t);const r={};for(const e of t){const t=yield this.getRawTag(e);t&&(r[e.id]=t)}return r}))}rawTagUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.writeRawTag(t.id,e.query.tag,t.rootID)}))}stream(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.streamController.streamTrack(t,e.query.format,e.query.maxBitRate,e.user)}))}similar(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id),r=yield this.metaService.similarTracks.byTrack(t),i=u.paginate(r,e.query.amount,e.query.offset);return{total:i.total,amount:i.amount,offset:i.offset,items:yield this.prepareList(i.items,e.query,e.user)}}))}nameUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.renameTrack(t.id,e.query.name,t.rootID)}))}parentUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.folderService.store.byId(e.query.folderID);return t?this.ioService.moveTracks(e.query.ids,t.id,t.rootID):Promise.reject(n.NotFoundError())}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.removeTrack(t.id,t.rootID)}))}fix(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);return this.ioService.fixTrack(t.id,e.query.fixID,t.rootID)}))}health(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.store.search(yield this.translateQuery(e.query,e.user));t.items=this.service.defaultSort(t.items);const r=[],s=[],a=[],n=[];for(const e of t.items){let t=s.find(t=>t.id===e.rootID);if(t||(t=yield this.rootService.rootStore.byId(e.rootID),t&&s.push(t)),t){let r=a.find(t=>t.id===e.parentID);r||(r=yield this.folderService.folderStore.byId(e.parentID),r&&a.push(r)),r&&n.push({track:e,folder:r,root:t})}}return yield y.processQueue(3,n,t=>i(this,void 0,void 0,(function*(){const i=yield this.checker.run(t.track,t.folder,t.root,!!e.query.media);i&&i.length>0&&r.push({track:yield this.prepare(t.track,e.query,e.user),health:i})}))),r}))}lyrics(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);if(t.tag.lyrics)return{lyrics:t.tag.lyrics};const r=t.tag.title;if(!r)return{};try{let e;return t.tag.artist&&(e=yield this.metaService.lyrics(t.tag.artist,r)),e&&e.lyrics||!t.tag.albumArtist||t.tag.artist===t.tag.albumArtist||(e=yield this.metaService.lyrics(t.tag.albumArtist,r)),e||{}}catch(e){return h.error(e),{}}}))}}t.TrackController=g},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(24),n=s(r(3)),o=r(1),c=r(34),d=r(148),u=r(2).logger("TrackHealth"),l={xing:["XING: Wrong number of data bytes declared in VBRI Header","XING: Wrong number of frames declared in VBRI Header","XING: Wrong number of data bytes declared in Info Header","XING: Wrong number of frames declared in Info Header","XING: Wrong number of data bytes declared in Xing Header","XING: Wrong number of frames declared in Xing Header"],xingMissing:["XING: VBR detected, but no VBR head frame found"],mpeg:["MPEG: Unknown data found between ID3v2 and audio","MPEG: Unknown data found before audio"]},m=l.xingMissing.concat(l.xing).concat(l.mpeg),p=["PRIV","COMM","POPM"];function f(e){return c.ID3TrackTagRawFormatTypes.includes(e.tag.format)}function y(e){return e.media&&e.media.format===o.AudioFormatType.mp3}const h=[{id:o.TrackHealthID.tagValuesExists,name:"Tag Values missing",all:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){const r=[];if(e.tag.album||r.push("album"),e.tag.artist||r.push("artist"),e.tag.albumArtist||r.push("album artist"),e.tag.genre||r.push("genre"),e.tag.track||r.push("track nr"),void 0===t.tag.albumType||e.seriesID||e.tag.trackTotal||r.push("total track count"),void 0!==t.tag.albumType&&o.AlbumTypesArtistMusic.includes(t.tag.albumType)&&(e.tag.year||r.push("year")),r.length>0)return{details:r.map(e=>({reason:e}))}}))},{id:o.TrackHealthID.id3v2NoId3v1,name:"ID3v2 is available, ID3v1 is redundant",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(f(e)&&s.id3v1)return{}}))},{id:o.TrackHealthID.id3v2Exists,name:"ID3v2 Tag is missing",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(!f(e))return{}}))},{id:o.TrackHealthID.id3v2Valid,name:"ID3v2 is invalid",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(s.mp3Warnings&&s.mp3Warnings.id3v2&&s.mp3Warnings.id3v2.length>0)return{details:s.mp3Warnings.id3v2.map(e=>({reason:e.msg,expected:e.expected.toString(),actual:e.actual.toString()}))}}))},{id:o.TrackHealthID.id3v2Garbage,name:"ID3v2 has garbage frames",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(s.id3v2){const e=s.id3v2.frames.filter(e=>p.includes(e.id));if(e.length>0){const t=[];return e.forEach(e=>{t.includes(e.id)||t.push(e.id)}),{details:t.map(e=>({reason:e}))}}}}))},{id:o.TrackHealthID.mp3Garbage,name:"MP3 has unaccounted data",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(s.mp3Warnings&&s.mp3Warnings.mpeg){const e=s.mp3Warnings.mpeg.filter(e=>l.mpeg.includes(e.msg));if(e.length>0)return{details:e.map(e=>({reason:e.msg,expected:e.expected.toString(),actual:e.actual.toString()}))}}}))},{id:o.TrackHealthID.mp3HeaderExists,name:"VBR Header is missing",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(s.mp3Warnings&&s.mp3Warnings.xing){if(s.mp3Warnings.xing.find(e=>l.xingMissing.includes(e.msg)))return{}}}))},{id:o.TrackHealthID.mp3HeaderValid,name:"VBR Header is invalid",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(s.mp3Warnings&&s.mp3Warnings.xing){const e=s.mp3Warnings.xing.filter(e=>l.xing.includes(e.msg));if(e.length>0)return{details:e.map(e=>({reason:e.msg,expected:e.expected.toString(),actual:e.actual.toString()}))}}}))},{id:o.TrackHealthID.mp3MediaValid,name:"MP3 Media is invalid",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(s.mp3Warnings&&s.mp3Warnings.mpeg){const e=s.mp3Warnings.mpeg.filter(e=>!m.includes(e.msg));if(e.length>0)return{details:e.map(e=>({reason:e.msg,expected:e.expected.toString(),actual:e.actual.toString()}))}}}))},{id:o.TrackHealthID.flacMediaValid,name:"Flac Media is invalid",mp3:!0,run:(e,t,r,s)=>i(void 0,void 0,void 0,(function*(){if(s.flacWarnings)return{details:[{reason:s.flacWarnings}]}}))}];t.TrackRulesChecker=class{constructor(e){this.audiomodule=e}run(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=[],c={},l=n.default.join(e.path,e.name);if(u.debug("Analyzing track",l),s)if(y(e)){u.debug("Check MPEG",l);const e=yield this.audiomodule.mp3.analyze(l);c.id3v1=e.tags.id3v1,c.id3v2=e.tags.id3v2,c.mp3Warnings={xing:e.warnings.filter(e=>e.msg.startsWith("XING:")),mpeg:e.warnings.filter(e=>e.msg.startsWith("MPEG:")),id3v1:e.warnings.filter(e=>e.msg.startsWith("ID3V1:")),id3v2:e.warnings.filter(e=>e.msg.startsWith("ID3V2:"))}}else u.debug("Check Media with flac",l),c.flacWarnings=yield d.flac_test(l);else if(y(e)){const e=new a.ID3v2;c.id3v2=yield e.read(l),c.id3v2&&(c.mp3Warnings={xing:[],mpeg:[],id3v1:[],id3v2:a.ID3v2.check(c.id3v2)})}const m=y(e),p=function(e){return e.media&&e.media.format===o.AudioFormatType.flac}(e);for(const s of h)if(s.all||s.mp3&&m||s.flac&&p){const a=yield s.run(e,t,r,c);a&&i.push({id:s.id,name:s.name,details:a.details})}return i}))}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(117));let a;function n(e){return e.replace(/[& \-.]/g,"").toLowerCase()}function o(){a||(a={},t.Genres.forEach(e=>{a[n(e)]=e}))}t.Genres=s.default.list,t.getKnownGenre=function(e){const t=n(e);return o(),a[t]},t.cleanGenre=function e(t){const r=[];return t.split("/").forEach(t=>{t=t.trim();const i=/\((\d+)\)/.exec(t);let c;if(i&&(c=parseInt(i[1],10),t=t.slice(0,i.index)+t.slice(i.index+i[0].length)),0===t.length&&void 0!==c){const e=s.default.id3v1[c];e&&(t=e)}if(t.length>0){const i=n(t);let s;if(o(),a&&a[i]&&(s=a[i]),!s&&t.includes(" & ")){t.split("&").forEach(t=>{t=e(t),r.includes(t)||r.push(t)})}else s?r.includes(s)||r.push(s):r.includes(t)||r.push(t)}}),r.join(" / ")}},function(e){e.exports=JSON.parse('{"id3v1":["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alternative Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop-Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast Fusion","Bebop","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","World Music","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],"list":["2 Tone","2-Step Garage","4-Beat","A Cappella","Abstract","Acid","Acid Breaks","Acid House","Acid Jazz","Acid Punk","Acid Rock","Acid Techno","Acid Trance","Acousmatic Music","Acoustic","Adult Contemporary","African","African Blues","African Heavy Metal","African Hip Hop","Afro / Cosmic Disco","Afro-Cuban Jazz","Afrobeat","Aggrotech","Alternative","Alternative Country","Alternative Dance","Alternative Hip Hop","Alternative Metal","Alternative Rock","Ambient","Ambient Dub","Ambient House","American Folk Revival","Americana","Anarcho Punk","Anime","Anti-folk","Apala","Arab Pop","Art Punk","Art Rock","Asian","Asian American Jazz","Asian Underground","Atlanta Hip Hop","Audio Theatre","Audio Drama","Audio Series","Audiobook","Australian Country Music","Australian Hip Hop","AustroPop","Avant-garde","Avant-garde Jazz","Avant-garde Metal","Avantgarde","Axé","Bachata","Background Music","Baila","Baithak Gana","Bakersfield sound","Balearic Beat","Balearic Trance","Ballad","Baltimore Club","Banda","Baroque","Baroque Pop","Bass","Bassline","Baul","Beat","Beat Music","Beautiful Music","Bebop","Benga","Berlin School","Bhangra","Big Band","Big Beat","Big Room","Bikutsi","BitPop","Black Metal","Blue-Eyed Soul","Bluegrass","Blues","Blues Country","Blues Rock","Blues Shouter","Bolero","Bongo Flava","Boogie","Boogie-Woogie","Booty Bass","Bossa Nova","Bounce Music","Bouncy House","Bouncy Techno","Bouyon","Brazilian","Brazilian Rock","Breakbeat","Breakbeat Hardcore","Breakcore","Breakstep","Brega","Brick City club","Brill Building","British Blues","British Dance Band","British Folk revival","British Hip Hop","BritPop","Broken Beat","Brostep","Bubblegum Dance","Bubblegum Pop","Bullerengue","C-Pop","Cabaret","Cadence-lypso","Cajun","Cajun fiddle tunes","Calypso","Canadian Blues","Canción","Canterbury scene","Canzone","Cape Jazz","Caribbean","Celtic","Celtic Metal","Celtic Music","Celtic Punk","Cha Cha Cha","Chalga","Chamber Jazz","Chamber Music","Chanson","Chap Hop","Chicago Blues","Chicago Hip Hop","Chicago House","Chicano Rap","Chicha","Chill-out","Chillout","Chillstep","Chillwave","Chimurenga","Chinese Rock","Chiptune","Chopped & Screwed","Choro","Chorus","Christian Country Music","Christian Gangsta Rap","Christian Hip Hop","Christian Metal","Christian Pop","Christian Punk","Christian Rap","Christian Rock","Chutney","Chutney soca","Classic Country","Classic female Blues","Classic Rock","Classical","Classical crossover","Close harmony","Club","Club-House","Coldwave","Comedy","Compas","Complextro","Congolese rumba","Conscious Hip Hop","Contemporary Christian","Contemporary Folk","Contemporary R&B","Continental Jazz","Cool Jazz","Country","Country Blues","Country Pop","Country Rap","Country Rock","Country-Rap","Coupé-Décalé","Western Music","CowPunk","Criolla","Crossover","Crossover Jazz","Crossover Thrash","Crunk","Crunkcore","Crust Punk","Crustgrind","Cult","Cumbia","Cumbia Rap","Cybergrind","D-beat","Dance","Dance Hall","Dance-Pop","Dance-Punk","Dance-Rock","Dancehall","Dancehall Music","Dangdut","Dansband Music","Dark Ambient","Dark Cabaret","Dark Electro","Dark Wave","Darkcore","Darkcore jungle","Darkstep","Darkwave","Death \\"n\\" roll","Death industrial","Death Metal","Death-Doom","Deathcore","DeathRock","Deep Funk","Deep House","Delta Blues","Desert Rock","Detroit Blues","Detroit Hip Hop","Detroit Techno","Digital hardcore","Disco","Disco polo","Diva House","Dixieland","Djent","Doom Metal","Doomcore","Downtempo","Dream","Dream Pop","Dream Trance","Drill","Drill & Bass","Drone Metal","Drone Music","Drum & Bass","Drum Solo","Drumstep","Dub","Dub Techno","Dubstep","Dubstyle","Dubtronica","Duet","Dunedin Sound","Dutch House","East Coast Hip Hop","Easy Listening","EBM","Eclectic","Electric Blues","Electro","Electro House","Electro Music","Electro Swing","Electro-Industrial","Electroacoustic","Electroacoustic Music","Electroclash","Electronic","Electronic Body Music","Electronic Rock","Electronica","Electronicore","ElectroPop","ElectroPunk","Elevator Music","Emo","Ethereal Wave","Ethnic","Ethnic electronica","Ethno Jazz","Euro Disco","Euro-House","Euro-Techno","Eurobeat","Eurodance","European free Jazz","EuroPop","Experimental","Experimental Hip Hop","Experimental Music","Experimental Rock","Fado","Fann at-Tanbura","Fast Fusion","Fidget House","Fijiri","Filk Music","Filmi","Flamenco","Florida Breaks","Folk","Folk Metal","Folk Pop","Folk Punk","Folk Rock","Folk-Rock","Folklore","Folktronica","Forró","Franco-Country","Freak Folk","Freakbeat","Free Funk","Free Improvisation","Free Jazz","Free Tekno","Freestyle","Freestyle Music","Freestyle Rap","French House","French Pop","Frevo","Fuji Music","Full On","Funk","Funk Carioca","Funk Metal","Funkstep","Funktronica","Funky House","Furniture Music","Fusion","Future Garage","Future House","FuturePop","G-Funk","Gabba","Game","Game Boy Music","Gamelan","Gangsta Rap","Garage","Garage House","Garage Punk","Garage Rock","Genge","Ghetto House","Ghettotech","Glam Metal","Glam Rock","Glitch","Glitch Hop","Global","Go-go","Goa","Goa Trance","Golden Age Hip Hop","Goregrind","Gospel","Gospel Blues","Gothic","Gothic Metal","Gothic Rock","Grime","Grindcore","Grindie","Groove Metal","Grunge","Grupera","Guajira","Gypsy Jazz","Gypsy Punk","Happy Hardcore","Hard Bop","Hard House","Hard NRG","Hard Rock","Hard Trance","Hardbag","Hardcore","Hardcore Rap","Hardcore Hip Hop","Hardcore Punk","Hardstep","Hardstyle","Heavy Metal","Hellbilly Music","Hi-NRG","Highlife","Hill Country Blues","Hip Hop","Hip Hop Soul","Hip House","Hip Pop","Hip Hop","Hiplife","Hokum","Hokum Blues","Honky Tonk","Horror Punk","Horrorcore","House","House Music","Houston Hip Hop","Huayno","Humour","Hyphy","IDM","Igbo highlife","Igbo Rap","Illbient","Indian Pop","Indie","Indie Folk","Indie Pop","Indie Rock","Indietronica","Industrial","Industrial Folk","Industrial Hip Hop","Industrial Metal","Industrial Music","Industrial Rock","Industro-Goth","Instrumental","Instrumental Country","Instrumental Hip Hop","Instrumental Pop","Instrumental Rock","Iranian Pop","Isicathamiya","Isolationism","Italo Dance","Italo Disco","Italo House","J-Pop","Jam Band","Jangle Pop","Japanoise","Jazz","Jazz Blues","Jazz Fusion","Jazz House","Jazz Rap","Jazz Rock","Jazz-Funk","Jazz+Funk","Jerkin\\"","Jersey Club","Jit","JPop","Jùjú","Jump Blues","Jump-up","Jumpstyle","Jungle","K-Pop","Kadongo Kamu","Kansas City Blues","Kansas City Jazz","Kapuka","Keroncong","Khaliji","Kizomba","Krautrock","Kuduro","Kwaito","Kwassa Kwassa","Kwela","Laïkó","Lambada","Laptronica","Latin","Latin alternative","Latin ballad","Latin Christian","Latin House","Latin Jazz","Latin Metal","Latin Pop","Latin Rock","Latin Swing","Lavani","Leftfield","Lento Violento","Liquid Dubstep","Liquid Funk","Livetronica","Liwa","Lo-fi","Lo-Fi","Louisiana Blues","Louisiana Swamp Pop","Lounge","Lounge Music","Lovers Rock","Low Bap","Lowercase","Luk Krung","Luk Thung","Lyrical Hip Hop","M-Base","Mafioso Rap","Mainstream Jazz","Mákina","Makossa","Maloya","Mambo","MandoPop","Manila Sound","Maracatu","Mariachi","Marrabenta","Math Rock","Mathcore","Mbalax","Mbaqanga","Mbube","Medieval Metal","Meditative","Melbourne Bounce","Melodic Death Metal","Melodic Metalcore","Memphis Blues","Merengue","MerenRap","Méringue","Metal","Metalcore","Mexican Pop","Mexican Son","Miami Bass","Microhouse","Middle of the road","Midwest Hip Hop","Minimal Techno","Minimal Wave","Modal Jazz","Moombahcore","Moombahton","Morlam","Morna","Mosambique","Motswako","Música Criolla","Música Popular Brasileira","Música Sertaneja","Musical","Musique Concrète","Nagoya Kei","Nashville Sound","National Folk","Native American","NDW","Ndombolo","NederPop","Neo Soul","Neo-Bop Jazz","Neo-Psychedelia","Neo-Swing","Neoclassical","Neoclassical Metal","Neofolk","Neotraditional Country","Nerdcore","Neue Deutsche Welle","NeuroFunk","Neurohop","New Age","New Beat","New jack swing","New Jersey Hip Hop","New Prog","New Rave","New Romantic","New Romanticism","New School Hip Hop","New Wave","New-age Music","Nintendocore","Nitzhonot","No wave","Noise","Noise Rock","Noisegrind","Nortec","Norteño","Northern Soul","Novelty Ragtime","Nu Jazz","Nu Metal","Nu Skool Breaks","Nu-Breakz","Nu-Disco","Nu-Funk","Nu-Gaze","Nu-NRG","Nueva canción","Old School Hip Hop","Oldies","Opera","Operatic Pop","Orchestral Jazz","Original Pilipino Music","Other","Outlaw Country","Outsider House","P-Funk","Pagan Metal","Pagode","Paisley Underground","Palm-wine","Piedmont Blues","Pinoy Pop","Podcast","Political Hip Hop","Polka","Polsk Punk","Pop","Pop Punk","Pop Rap","Pop Rock","Pop Soul","Pop Sunda","Pop-Folk","Pop-Funk","Porn Groove","Porro","Post-Bop","Post-Disco","Post-Grunge","Post-Hardcore","Post-Metal","Post-Punk","Post-Punk Revival","Post-Rock","Power Ballad","Power Electronics","Power Metal","Power Noise","Power Pop","Powerviolence","Pranks","Primus","Progressive Bluegrass","Progressive Country","Progressive Folk","Progressive House","Progressive Metal","Progressive Pop","Progressive Rock","Progressive Trance","Protest Song","Psybient","Psychedelic","Psychedelic Folk","Psychedelic Pop","Psychedelic Rock","Psychedelic Trance","Psychobilly","Punkabilly","Psytrance","Punk","Punk Blues","Punk Jazz","Punk Rock","Punta","Punta Rock","R&B","Raga Rock","Ragga","Ragga Jungle","Raggacore","Ragini","Ragtime","Raï","Ranchera","Rap","Rap Metal","Rap Music","Rap Opera","Rap Rock","Rapcore","Rara tech","Rasin","Rave","Reactionary Bluegrass","Rebetiko","Red Dirt","Reggae","Reggae Español","Spanish Reggae","Reggae Fusion","Reggaestep","Reggaeton","Regional Mexican","Retro","Revival","Rhythm & Blues","Rhythmic Soul","Riot grrrl","Rock","Rock & Roll","Rock en Español","Rock in Opposition","Rockabilly","Rocksteady","Rumba","Russian Pop","Sadcore","Sakara","Salsa","Salsa romántica","Samba","Samba Rock","Sambass","Satire","Sawt","Schlager","Screamo","Sega","Seggae","Semba","Sertanejo","Shangaan electro","Shibuya-kei","Shoegaze","Showtunes","Singer-songwriter","Ska","Ska Jazz","Ska Punk","Skate Punk","Skiffle","Skweee","Slow Jam","Slow Rock","Slowcore","Sludge Metal","Smooth Jazz","Snap Music","Soca","Soft Rock","Son","Son Cubano","Sonata","Songo","Songo-Salsa","Sophisti-Pop","Soukous","Soul","Soul Blues","Soul Jazz","Sound Clip","Soundtrack","Southern Hip Hop","Southern Rock","Southern Soul","Space","Space Age Pop","Space Disco","Space Music","Space Rock","Speech","Speed garage","Speed Metal","Speedcore","St.Louis Blues","St.Louis Hip Hop","Stoner Rock","Straight-ahead Jazz","Street Punk","Stride Jazz","Sufi Rock","SungPoetry","Sunshine Pop","Suomisaundi","Surf Pop","Surf Rock","Swamp Blues","Swing","Symphonic black Metal","Symphonic Metal","Symphonic Rock","Symphony","Synthpop","SynthPop","Synthwave","Taarab","Tango","Tech House","Tech Trance","Techdombe","Technical death Metal","Techno","Techno-Industrial","Techstep","Tecno Brega","Tecnobrega","Teen Pop","Tejano","Terror","Texas Blues","Texas Country","Thai Pop","Third stream","Thrash Metal","Thrashcore","Timba","Top 40","Trad Jazz","Traditional Country Music","Traditional Pop Music","Trailer","Trance","Trance Music","TRap","TRapstep","Tribal","Tribal House","Trip hop","Trip-Hop","Trival","Trop Rock","Tropical","Tropical House","Tropicalia","TropiPop","Truck-driving Country","Turkish Pop","Turntablism","Twin Cities Hip Hop","Twoubadou","UK Funky","UK Garage","UK Hardcore","Unblack Metal","Underground Hip Hop","Uplifting Trance","Urban Pasifika","V-Pop","Vallenato","Vaporwave","Video game Music","Viking Metal","VisPop","Visual Kei","Vocal","Vocal Jazz","Vocal Trance","War Metal","Weltmusik","West Coast Blues","West Coast Hip Hop","West Coast Jazz","Western swing","Witch House","Wonky","Wonky Pop","World Fusion","World Music","Worldbeat","Zouglou","Zouk","Zouk-Lambada","Zydeco"]}')},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(36);class a extends s.WebserviceJSONClient{constructor(e){super(1,1e3,e.userAgent,Object.assign(Object.assign({},{host:"https://acousticbrainz.org",basePath:"/api/v1/"}),e))}highLevel(e,t){return i(this,void 0,void 0,(function*(){return this.get({path:`${this.options.basePath}${e}/high-level`,query:{n:void 0!==t?t.toString():void 0},retry:0})}))}}t.AcousticbrainzClient=a},function(e,t){e.exports=require("limiter")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),a=r(18),n=r(121),o=s.logger("Acoustid");class c extends a.WebserviceClient{constructor(e){super(1,3e3,"JamServe/0.1.0"),this.options=e}get(e,t){return i(this,void 0,void 0,(function*(){t=t||this.options.meta||"recordings releases releasegroups tracks compress usermeta sources",o.info("requesting by fingerprint",t);const r=yield this.getJson("https://api.acoustid.org/v2/lookup",{format:"json",meta:t,client:this.options.key,duration:e.duration.toFixed(0),fingerprint:e.fingerprint});return"ok"!==r.status?Promise.reject(Error(r.status)):r.results}))}acoustid(e,t){return i(this,void 0,void 0,(function*(){try{const r=yield n.fpcalc(e,this.options.fpcalc||{});return this.get(r,t)}catch(e){return o.error(e),[]}}))}}t.AcoustidClient=c},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(38);t.fpcalc=function(e,t){return i(this,void 0,void 0,(function*(){const r=["-json"];return t.length&&r.push("-length",t.length.toFixed(0)),t.raw&&r.push("-raw"),s.spawnToolJson("fpcalc","FPCALC_PATH",[...r,e])}))}},function(e,t){e.exports=require("child_process")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=s(r(124));t.isWindows=["win32","cygwin","msys"].includes(process.platform);const c={};t.getBinPath=function(e,r){return i(this,void 0,void 0,(function*(){if(e in c)return c[e];try{const t=yield function(e){return i(this,void 0,void 0,(function*(){const t=process.env[e];if(t&&t.length>0){if(yield a.default.pathExists(t))return t}}))}(r);if(t&&t.length>0)return c[e]=t,t}catch(e){}try{const t=yield function(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{o.default(e,(e,i)=>{e?r(e):t(i)})})}))}(e);if(t&&t.length>0)return c[e]=t,t}catch(e){}try{const r=yield function(e){return i(this,void 0,void 0,(function*(){const r=n.default.join(".","bin","tools",e,process.platform,process.arch,e)+(t.isWindows?".exe":"");if(yield a.default.pathExists(r))return r}))}(e);if(r&&r.length>0)return c[e]=r,r}catch(e){}}))}},function(e,t){e.exports=require("which")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(36);class a extends s.WebserviceJSONClient{constructor(e){super(10,1e3,e.userAgent,Object.assign(Object.assign({},{host:"https://coverartarchive.org",basePath:"/"}),e))}parseResult(e,t){const r=Object.create(null,{parseResult:{get:()=>super.parseResult}});return i(this,void 0,void 0,(function*(){return 404===e.statusCode?Promise.resolve({images:[]}):r.parseResult.call(this,e,t)}))}processError(e,t){const r=Object.create(null,{processError:{get:()=>super.processError}});return i(this,void 0,void 0,(function*(){return e instanceof SyntaxError?{images:[]}:r.processError.call(this,e,t)}))}releaseImages(e){return i(this,void 0,void 0,(function*(){return yield this.get({path:`${this.options.basePath}release/${e}/`,query:{},retry:0})}))}releaseGroupImages(e){return i(this,void 0,void 0,(function*(){return yield this.get({path:`${this.options.basePath}release-group/${e}/`,query:{},retry:0})}))}}t.CoverArtArchiveClient=a},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),a=r(18),n=s.logger("LastFM");class o{static ensureList(e,t){return t[e]?Array.isArray(t[e])?t[e]:[t[e]]:t}static buildSubValue(e,t,r){switch(e){case"#text":r.url=t;break;case"@attr":Object.keys(t).forEach(e=>{r[e]=t[e]});break;case"tags":r[e]=o.ensureList("tag",t);break;case"streamable":r[e]={sample:t["#text"],fulltrack:t.fulltrack};break;case"image":{const i=Array.isArray(t)?t:[t];r[e]=i.filter(e=>e.url&&e.url.length>0);break}case"tracks":r[e]=o.ensureList("track",t);break;case"links":r[e]=o.ensureList("link",t);break;default:r[e]=t}}static walkBeautifyObject(e){const t={};return Object.keys(e).forEach(r=>{const i=o.walk(e[r],e);void 0!==i&&o.buildSubValue(r,i,t)}),t}static walk(e,t){if(null!=e)return Array.isArray(e)?e.map(e=>o.walk(e,t)).filter(e=>void 0!==e):"object"==typeof e?o.walkBeautifyObject(e):e}static beautify(e){return o.walk(e,{})}}class c extends a.WebserviceClient{constructor(e){super(5,1e3,e.userAgent),this.options=e}get(e,t){return i(this,void 0,void 0,(function*(){n.info("requesting",e,JSON.stringify(t)),t.method=e;const r={method:e};Object.keys(t).forEach(e=>{r[e]=t[e]}),r.api_key=this.options.key,r.format="json";try{const e=yield this.getJson("https://ws.audioscrobbler.com/2.0/",r);return o.beautify(e)}catch(e){return n.error(e),Promise.reject(e)}}))}artist(e){return i(this,void 0,void 0,(function*(){return(yield this.get("artist.getInfo",{artist:e})).artist}))}trackID(e){return i(this,void 0,void 0,(function*(){return(yield this.get("artist.getInfo",{mbid:e})).track}))}artistID(e){return i(this,void 0,void 0,(function*(){return(yield this.get("artist.getInfo",{mbid:e})).artist}))}album(e,t){return i(this,void 0,void 0,(function*(){return(yield this.get("album.getInfo",{artist:t,album:e})).album}))}albumID(e){return i(this,void 0,void 0,(function*(){return(yield this.get("album.getInfo",{mbid:e})).album}))}albumIDTopTags(e){return i(this,void 0,void 0,(function*(){return(yield this.get("album.getTopTags",{mbid:e})).toptracks}))}similarTrack(e,t){return i(this,void 0,void 0,(function*(){return(yield this.get("track.getSimilar",{track:e,artist:t})).similartracks}))}similarTrackID(e){return i(this,void 0,void 0,(function*(){return(yield this.get("track.getSimilar",{mbid:e})).similartracks}))}topArtistSongs(e){return i(this,void 0,void 0,(function*(){return(yield this.get("artist.getTopTracks",{artist:e})).toptracks}))}topArtistSongsID(e){return i(this,void 0,void 0,(function*(){return(yield this.get("artist.getTopTracks",{mbid:e})).toptracks}))}lookup(e,t){return i(this,void 0,void 0,(function*(){switch(e){case"album":return{album:yield this.albumID(t)};case"artist":return{artist:yield this.artistID(t)};case"track":return{track:yield this.trackID(t)};case"artist-toptracks":return{toptracks:yield this.topArtistSongsID(t)};case"track-similar":return{similartracks:yield this.similarTrackID(t)};case"album-toptracks":return{toptracks:yield this.albumIDTopTags(t)};default:return Promise.reject(Error("Invalid LastFM lookup type parameter"))}}))}}t.LastFMClient=c},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),a=r(18),n=s.logger("LyricsOVHClient");class o extends a.WebserviceClient{constructor(e){super(1,1e3,e)}parseResult(e,t){const r=Object.create(null,{parseResult:{get:()=>super.parseResult}});return i(this,void 0,void 0,(function*(){return 404===e.statusCode?Promise.resolve(void 0):r.parseResult.call(this,e,t)}))}search(e,t){return i(this,void 0,void 0,(function*(){const r=`https://api.lyrics.ovh/v1/${this.cleanString(e)}/${this.cleanString(t)}`;n.info("requesting",r);const i=yield this.getJson(r);if(i&&i.lyrics)return{lyrics:i.lyrics,source:r}}))}cleanString(e){return encodeURIComponent(e.replace(/[’´`]/g,"'").replace(/[():]/g," ").replace(/[‐]/g,"-").normalize().trim())}}t.LyricsOVHClient=o},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(36),a=r(129);class n extends s.WebserviceJSONClient{constructor(e){super(1,1e3,e.userAgent,Object.assign(Object.assign({},{host:"https://musicbrainz.org",basePath:"/ws/2/"}),e))}beautify(e){const t=e=>{if(null!=e){if(Array.isArray(e))return e.map(t).filter(e=>void 0!==e);if("object"==typeof e){const r={};return Object.keys(e).forEach(i=>{const s=t(e[i]);void 0!==s&&(r[(e=>e.split("-").map((e,t)=>0===t?e:e[0].toUpperCase()+e.slice(1)).join(""))(i)]=s)}),r}return e}};return t(e)}concatSearchQuery(e){return Object.keys(e).filter(t=>void 0!==e[t]&&null!==e[t]).map(t=>`${t}:"${encodeURIComponent(e[t])}"`).join("%20AND%20")}reqToUrl(e){const t=Object.keys(e.query).filter(t=>void 0!==e.query[t]&&null!==e.query[t]).map(t=>`${t}=${e.query[t]}`);return t.push("limit="+(e.limit||this.options.limit||25)),t.push("offset="+(e.offset||0)),t.push("fmt=json"),`${this.reqToHost(e)}${e.path}?${t.join("&")}`}isRateLimitError(e){return e&&e.error&&e.error.includes("allowable rate limit")}search(e){return i(this,void 0,void 0,(function*(){const t=yield this.get({path:`${this.options.basePath}${e.type}/`,query:{query:this.concatSearchQuery(e.query||{})},retry:0,limit:e.limit,offset:e.offset});return this.beautify(t)}))}lookup(e){return i(this,void 0,void 0,(function*(){if(!e.id||0===e.id.length)return Promise.reject(Error("Invalid lookup id for type "+e.type));const t=a.LookupIncludes[e.type],r=e.inc||a.LookupIncludes[e.type].join("+");if(!t)return Promise.reject(Error("Invalid Lookup"));const i=yield this.get({path:`${this.options.basePath}${e.type}/${e.id}`,query:{mbid:e.id,inc:r},retry:0,limit:e.limit,offset:e.offset}),s={};return s[e.type]=i||{},this.beautify(s)}))}browse(e){return i(this,void 0,void 0,(function*(){const t=Object.keys(e.lookupIds).find(t=>!a.LookupBrowseTypes[e.type]||!a.LookupBrowseTypes[e.type].includes(t));if(t)return Promise.reject(Error(`Invalid browse lookup key for type ${e.type}: ${t}`));const r=Object.assign({inc:e.inc},e.lookupIds),i=yield this.get({path:`${this.options.basePath}${e.type}/`,query:r,retry:0,limit:e.limit,offset:e.offset}),s={};return s[e.type]=i||{},this.beautify(s)}))}luceneSearch(e){return i(this,void 0,void 0,(function*(){if(!e.query||0===e.query.length)return Promise.reject(Error("Invalid query for type "+e.type));const t=yield this.get({path:`${this.options.basePath}${e.type}/`,query:{query:encodeURIComponent(e.query||"")},retry:0,limit:e.limit,offset:e.offset}),r={};return r[e.type]=t||{},this.beautify(r)}))}}t.MusicbrainzClient=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LookupBrowseTypes={area:["collection"],artist:["area","collection","recording","release","release-group","work"],collection:["area","artist","editor","event","label","place","recording","release","release-group","work"],event:["area","artist","collection","place"],instrument:["collection"],label:["area","collection","release"],place:["area","collection"],recording:["artist","collection","release"],release:["area","artist","collection","label","track","track_artist","recording","release-group"],"release-group":["artist","collection","release"],series:["collection"],work:["artist","collection"],url:["resource"]},t.LookupIncludes={area:[],artist:["recordings","releases","release-groups","works","aliases","artist-rels","url-rels","tags","ratings"],collection:["user-collections"],event:[],instrument:[],label:["releases"],place:[],recording:["artists","releases","artist-credits","aliases","tags","ratings","annotation"],release:["artists","labels","recordings","release-groups","discids","media","isrcs","artist-credits","aliases","tags","url-rels","annotation"],"release-group":["artists","releases","media","artist-credits","aliases","tags","ratings","url-rels","annotation"],series:[],work:[],url:[]}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),a=r(18),n=s.logger("Wikipedia");class o extends a.WebserviceClient{constructor(e){super(200,1e3,e)}summary(e,t){return i(this,void 0,void 0,(function*(){n.info("requesting summary",e);const r=`https://${t||"en"}.wikipedia.org/w/api.php`,i=yield this.getJson(r,{action:"query",prop:"extracts",format:"json",exintro:1,redirects:1,titles:e});if(!i||!i.query||!i.query.pages)return;const s=i.query.pages,a=s[Object.keys(s)[0]];return a?{title:a.title,summary:a.extract,url:`https://${t||"en"}.wikipedia.org/wiki/${encodeURIComponent(a.title)}`}:void 0}))}summary_rest(e,t){return i(this,void 0,void 0,(function*(){n.info("requesting summary",e);const r=`https://${t||"en"}.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(e)}`,i=yield this.getJson(r,{redirect:"true"});if(i)return i.extract_html}))}wikidata(e){return i(this,void 0,void 0,(function*(){n.info("requesting wikidata entity",e);const t="https://www.wikidata.org/w/api.php?action=wbgetentities&format=json&ids="+e,r=yield this.getJson(t,{});if(r&&r.entities)return r.entities[e]}))}}t.WikipediaClient=o},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=r(1),o=r(35),c=r(32),d=r(132);t.AudioModuleFLAC=class{constructor(e){this.imageModule=e}read(e){return i(this,void 0,void 0,(function*(){const t=new d.Flac;try{const r=yield t.read(e);return{tag:o.FORMAT.packFlacVorbisCommentJamServeTag(r.comment,r.pictures),media:o.FORMAT.packFlacMediaInfoJamServeMedia(r.media)}}catch(e){return console.error(e),{tag:{format:n.TrackTagFormatType.none},media:{}}}}))}readRaw(e){return i(this,void 0,void 0,(function*(){const t=new d.Flac,r=yield t.read(e);return r&&r.comment?c.flacToRawTag(r):Promise.reject(Error("No Flac Vorbis Comment found"))}))}write(e,t){return i(this,void 0,void 0,(function*(){const r=c.rawTagToID3v2(t),i=yield c.id3v2ToFlacMetaData(r,this.imageModule),s=new d.Flac;(yield a.default.pathExists(e+".bak"))||(yield a.default.copy(e,e+".bak")),yield s.write(e,i)}))}extractTagImage(e){return i(this,void 0,void 0,(function*(){const t=new d.Flac,r=yield t.read(e);if(r&&r.pictures){let e=r.pictures.find(e=>3===e.pictureType);if(e||(e=r.pictures[0]),e)return e.pictureData}}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(25)),n=s(r(6)),o=r(133);t.Flac=class{read(e){return i(this,void 0,void 0,(function*(){const t={};return new Promise((r,i)=>{const s=a.default.createReadStream(e),n=new o.FlacProcessorStream(!0,!0);n.on("postprocess",e=>{0===e.type?t.media=this.formatMediaBlock(e):4===e.type?t.comment=this.formatMediaComment(e):6===e.type&&e.pictureData&&(t.pictures=t.pictures||[],t.pictures.push(this.formatMediaPicture(e)))}),n.on("id3",e=>{t.id3=e}),n.on("done",()=>{r(t)}),n.on("error",e=>{i(e)}),s.on("error",e=>{i(e)});try{s.pipe(n)}catch(e){i(e)}})}))}writeTo(e,t,r){return i(this,void 0,void 0,(function*(){if(0===r.length)return Promise.reject(Error("Must write minimum 1 MetaDataBlock"));r.forEach(e=>{e.isLast=!1});const i=a.default.createReadStream(e),s=a.default.createWriteStream(t),n=new o.FlacProcessorStream(!1,!1);return new Promise((e,t)=>{n.on("preprocess",e=>{if(4!==e.type&&6!==e.type&&1!==e.type||e.remove(),e.isLast){e.remove&&(r[r.length-1].isLast=!0);for(const e of r)n.push(e.publish());r=[]}}),i.on("error",e=>{t(e)}),n.on("error",e=>{t(e)}),s.on("error",e=>{t(e)}),s.on("finish",()=>{e()}),i.pipe(n).pipe(s)})}))}write(e,t){return i(this,void 0,void 0,(function*(){const r=e+".tmp";try{yield this.writeTo(e,r,t),(yield n.default.pathExists(e))&&(yield n.default.remove(e)),yield n.default.move(r,e)}catch(e){return(yield n.default.pathExists(r))&&(yield n.default.remove(r)),Promise.reject(e)}}))}formatMediaComment(e){const t={};return e.comments.forEach(e=>{const r=e.indexOf("="),i=e.slice(0,r).toUpperCase().replace(/ /g,"_");let s=1,a="";for(;t[i+a];)s++,a="|"+s;const n=e.slice(r+1);t[i+a]=n}),{vendor:e.vendor,tag:t}}formatMediaBlock(e){return{duration:e.duration,channels:e.channels+1,bitsPerSample:e.bitsPerSample+1,sampleRate:e.sampleRate,sampleCount:e.samples,minBlockSize:e.minBlockSize,maxBlockSize:e.maxBlockSize,minFrameSize:e.minFrameSize,maxFrameSize:e.maxFrameSize}}formatMediaPicture(e){return{pictureType:e.pictureType,mimeType:e.mimeType,description:e.description,width:e.width,height:e.height,bitsPerPixel:e.bitsPerPixel,colors:e.colors,pictureData:e.pictureData}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(48),s=r(33),a=r(45),n=r(134),o=r(47);class c extends i.Transform{constructor(e=!1,t=!1,r){super(r),this.reportID3=e,this.parseMetaDataBlocks=t,this.hasError=!1,this.hasID3=!1,this.isFlac=!1,this.state=0,this.bufPos=0,this.mdbLen=0,this.mdbLast=!1,this.mdbPush=!1,this.mdbLastWritten=!1}_transform(e,t,r){const i={buffer:e,pos:0,length:e.length,done:!1};for(;!i.done;)this.process(i);this.hasError||this.emit("done"),r()}_flush(e){this.state=0,this.mdbLastWritten=!1,this.hasID3=!1,this.isFlac=!1,this.bufPos=0,this.buf=void 0,this.mdb=null,e()}scanSetFlac(e,t){if(this.reportID3){let r=e.buffer.slice(0,t);this.buf&&(r=Buffer.concat([this.buf,r])),this.emit("id3",r)}this.isFlac=!0,e.pos=t,this.bufPos=0,this.buf=void 0}scan(e){for(let t=e.pos;t<e.length;t++){if("fLaC"===e.buffer.slice(t,t+4).toString("utf8",0))return void this.scanSetFlac(e,t)}this.reportID3&&(this.buf=this.buf?Buffer.concat([this.buf,e.buffer]):e.buffer)}safePushFull(e,t,r,i){let s;r?this.bufPos>0&&this.buf?(e.buffer.copy(this.buf,this.bufPos,e.pos,e.pos+t-this.bufPos),s=this.buf.slice(0,t)):s=e.buffer.slice(e.pos,e.pos+t):s=e.buffer.slice(e.pos,e.pos+t-this.bufPos),i(s,!0)&&this.push(s),e.pos+=t-this.bufPos,this.bufPos=0,this.buf=void 0}safePushIncomplete(e,t,r,i){if(r)this.buf=this.buf||Buffer.alloc(t),e.buffer.copy(this.buf,this.bufPos,e.pos,e.length);else{const t=e.buffer.slice(e.pos,e.length);i(t,!1)&&this.push(t)}this.bufPos+=e.length-e.pos}safePush(e,t,r,i){const s=e.length-e.pos+this.bufPos>=t;return s?this.safePushFull(e,t,r,i):this.safePushIncomplete(e,t,r,i),s}processIDLE(){this.state=1}processSCANMARKER(e){this.scan(e),this.isFlac?this.state=1:e.done=!0}processMARKER(e){this.safePush(e,4,!0,e=>this.validateMarker(e))?this.state=!this.isFlac&&this.hasID3?5:this.isFlac?2:4:e.done=!0}processMDBHEADER(e){this.safePush(e,4,!0,e=>this.validateMDBHeader(e))?this.state=3:e.done=!0}processMDB(e){this.safePush(e,this.mdbLen,this.parseMetaDataBlocks,(e,t)=>this.validateMDB(e,t))?(this.mdb.isLast&&(this.mdbLastWritten=!0),this.emit("postprocess",this.mdb),this.state=this.mdbLast?4:2):e.done=!0}processPASSTHROUGH(e){this.safePush(e,e.length-e.pos,!1,()=>!0),e.done=!0}process(e){switch(this.state){case 0:this.processIDLE();break;case 5:this.processSCANMARKER(e);break;case 1:this.processMARKER(e);break;case 2:this.processMDBHEADER(e);break;case 3:this.processMDB(e);break;default:case 4:this.processPASSTHROUGH(e)}}validateMarker(e){return this.isFlac="fLaC"===e.toString("utf8",0),!!this.isFlac||(this.hasID3="ID3"===e.slice(0,3).toString("utf8",0),this.hasID3||(this.hasError=!0,this.destroy(new Error("Not supported file format"))),!1)}initMDB(e){switch(e){case 0:return new n.MetaDataBlockStreamInfo(this.mdbLast);case 4:return new o.BlockVorbiscomment(this.mdbLast);case 6:return new a.MetaDataBlockPicture(this.mdbLast);default:return new s.MetaDataBlock(this.mdbLast,e)}}preProcess(e,t){return this.mdbLastWritten?this.mdb.remove():this.mdbLast!==this.mdb.isLast&&(this.mdb.isLast?t|=2147483648:t&=2147483647,e.writeUInt32BE(t,0)),this.mdbPush=!this.mdb.removed,this.mdbPush}validateMDBHeader(e){const t=e.readUInt32BE(0),r=t>>>24&127;return this.mdbLast=0!=(t>>>24&128),this.mdbLen=16777215&t,this.mdb=this.initMDB(r),this.emit("preprocess",this.mdb),this.preProcess(e,t)}validateMDB(e,t){return this.parseMetaDataBlocks&&t&&this.mdb.parse(e),this.mdbPush}}t.FlacProcessorStream=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(33);class s extends i.MetaDataBlock{constructor(e){super(e,0),this.minBlockSize=0,this.maxBlockSize=0,this.minFrameSize=0,this.maxFrameSize=0,this.sampleRate=0,this.channels=0,this.bitsPerSample=0,this.samples=0,this.duration=0}remove(){throw Error("Can't remove StreamInfo block!")}parse(e){try{const t=0;this.minBlockSize=e.readUInt16BE(t),this.maxBlockSize=e.readUInt16BE(t+2),this.minFrameSize=e.readUInt8(t+4)<<16|e.readUInt16BE(t+5),this.maxFrameSize=e.readUInt8(t+7)<<16|e.readUInt16BE(t+8);const r=e.readUInt32BE(t+10);this.sampleRate=r>>>12,this.channels=r>>>9&7,this.bitsPerSample=r>>>4&31,this.samples=+((15&r)<<4)+e.readUInt32BE(t+14),this.checksum=Buffer.alloc(16),e.copy(this.checksum,0,18,34),this.duration=this.samples/this.sampleRate,this.hasData=!0}catch(e){this.error=e,this.hasData=!1}}}t.MetaDataBlockStreamInfo=s},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(24),n=r(136),o=r(1),c=r(2),d=r(35),u=r(32),l=s(r(3)),m=l.default.join(__dirname,"tasks");t.taskRewriteMp3=l.default.join(m,"task-rewrite-mp3.js"),t.taskFixMp3=l.default.join(m,"task-fix-mp3.js"),t.taskRemoveID3v1=l.default.join(m,"task-remove-id3v1.js"),t.taskAnalyzeMp3=l.default.join(m,"task-analyze-mp3.js");const p=c.logger("Audio:MP3");t.AudioModuleMP3=class{read(e){return i(this,void 0,void 0,(function*(){const t=new a.MP3;try{const r=yield t.read(e,{mpegQuick:!0,mpeg:!0,id3v2:!0});if(!r)return{tag:{format:o.TrackTagFormatType.none},media:{}};if(r.id3v2)return{tag:d.FORMAT.packID3v2JamServeTag(r.id3v2),media:d.FORMAT.packJamServeMedia(r.mpeg)};const i=new a.ID3v1,s=yield i.read(e);return s?{tag:d.FORMAT.packID3v1JamServeTag(s),media:d.FORMAT.packJamServeMedia(r.mpeg)}:{tag:{format:o.TrackTagFormatType.none},media:d.FORMAT.packJamServeMedia(r.mpeg)}}catch(e){return{tag:{format:o.TrackTagFormatType.none},media:{}}}}))}readRaw(e){return i(this,void 0,void 0,(function*(){const t=new a.ID3v2,r=yield t.read(e);return r&&r.head?u.id3v2ToRawTag(r):Promise.reject(Error("No ID3v2 Tag found"))}))}write(e,t){return i(this,void 0,void 0,(function*(){const r=u.rawTagToID3v2(t),i=new a.ID3v2;yield i.write(e,r,r.head?r.head.ver:4,r.head?r.head.rev:0,{keepBackup:!1,paddingSize:10})}))}removeID3v1(e){return i(this,void 0,void 0,(function*(){this.removeID3v1Pool||(this.removeID3v1Pool=new n.StaticPool({size:3,task:t.taskRemoveID3v1})),p.debug("remove ID3v1 Tag",e),yield this.removeID3v1Pool.exec(e)}))}fixAudio(e){return i(this,void 0,void 0,(function*(){this.fixMP3Pool||(this.fixMP3Pool=new n.StaticPool({size:3,task:t.taskFixMp3})),p.debug("fix Audio",e),yield this.fixMP3Pool.exec(e)}))}rewrite(e){return i(this,void 0,void 0,(function*(){this.rewriteAudioPool||(this.rewriteAudioPool=new n.StaticPool({size:3,task:t.taskRewriteMp3})),p.debug("rewrite",e),yield this.rewriteAudioPool.exec(e)}))}analyze(e){return i(this,void 0,void 0,(function*(){return this.analyzeMp3Pool||(this.analyzeMp3Pool=new n.StaticPool({size:3,task:t.taskAnalyzeMp3})),p.debug("analyze",e),this.analyzeMp3Pool.exec(e)}))}extractTagImage(e){return i(this,void 0,void 0,(function*(){p.debug("extractTagImage",e);const t=new a.ID3v2,r=yield t.read(e);if(r){const e=r.frames.filter(e=>["APIC","PIC"].includes(e.id));let t=e.find(e=>3===e.value.pictureType);if(t||(t=e[0]),t)return t.value.bin}}))}}},function(e,t){e.exports=require("node-worker-threads-pool")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(38);t.probe=function(e,t){return i(this,void 0,void 0,(function*(){return s.spawnToolJson("ffprobe","FFPROBE_PATH",["-print_format","json","-show_error","-show_streams","-show_format",...t,e])}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(49),a=r(39),n=r(2).logger("Audio:Transcoder");t.TranscoderModule=class{constructor(e){this.transcodeCache=new a.IDFolderCache(e,"transcode",e=>`${e.maxBitRate?"-"+e.maxBitRate:""}.${e.format}`)}get(e,t,r,a){return i(this,void 0,void 0,(function*(){return s.TranscoderStream.validTranscoding(r)?this.transcodeCache.get(t,{format:r,maxBitRate:a},t=>i(this,void 0,void 0,(function*(){n.debug("Writing transcode cache file",t),yield s.TranscoderStream.transcodeToFile(e,t,r,a)}))):Promise.reject(Error("Unsupported transcoding format"))}))}clearCacheByIDs(e){return i(this,void 0,void 0,(function*(){yield this.transcodeCache.removeByIDs(e)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(39),n=r(140),o=r(1),c=s(r(6)),d=r(2).logger("Audio:Waveform");t.WaveformModule=class{constructor(e){this.waveformCache=new a.IDFolderCache(e,"waveform",e=>`${void 0!==e.width?"-"+e.width:""}.${e.format}`)}generateWaveform(e,t,r){return i(this,void 0,void 0,(function*(){const i=new n.WaveformGenerator;switch(t){case o.WaveformFormatType.svg:return{buffer:{buffer:Buffer.from(yield i.svg(e,r),"ascii"),contentType:"image/svg+xml"}};case o.WaveformFormatType.json:return{json:yield i.json(e)};case o.WaveformFormatType.dat:return{buffer:{buffer:yield i.binary(e),contentType:"application/binary"}}}return Promise.reject(Error("Invalid Format for Waveform generation"))}))}get(e,t,r,s){return i(this,void 0,void 0,(function*(){return t&&(yield c.default.pathExists(t))?this.waveformCache.get(e,{format:r,width:s},e=>i(this,void 0,void 0,(function*(){const i=yield this.generateWaveform(t,r,s);if(d.debug("Writing cache file",e),i.buffer)yield c.default.writeFile(e,i.buffer.buffer);else{if(!i.json)throw new Error("Invalid waveform generation result");yield c.default.writeFile(e,JSON.stringify(i.json))}}))):Promise.reject(Error("Invalid filename for waveform generation"))}))}clearCacheByIDs(e){return i(this,void 0,void 0,(function*(){yield this.waveformCache.removeByIDs(e)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(141),n=s(r(142)),o=r(143),c=r(144),d=s(r(25)),u=s(r(145)),l=r(146);t.WaveformGenerator=class{binary(e){return i(this,void 0,void 0,(function*(){return(yield this.generateWaveform(e)).asBinary()}))}json(e){return i(this,void 0,void 0,(function*(){return(yield this.generateWaveform(e)).asJSON()}))}svg(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.json(e);return this.buildSvg(r,t)}))}generateWaveform(e){return i(this,void 0,void 0,(function*(){const t=d.default.createReadStream(e);return new Promise((e,r)=>{const i=new l.Waveform(t,{samplesPerPixel:256,sampleRate:44100});i.run(t=>{t?r(t):e(i)})})}))}buildSvg(e,t){const r=o.scaleLinear(),i=o.scaleLinear();let s=u.default.create(e);if(void 0!==t){const e=Math.floor(s.duration*s.sample_rate/t);s=s.resample({width:2*t,scale:e<s.scale?s.scale:void 0})}else t=4e3;const d=s.channel(0),l=d.min_array(),m=d.max_array();r.domain([0,s.length]).rangeRound([0,t]),i.domain([a.min(l),a.max(m)]).rangeRound([0,256]);const p=c.area().x((e,t)=>r(t)).y0((e,t)=>i(l[t])).y1((e,t)=>i(e)),f=new n.default;return f.createSVG(null,null,{preserveAspectRatio:"none",width:"100%",height:"100%",viewBox:`0 0 ${t} 256`}).append("path").datum(m).attr("stroke","green").attr("fill","darkgreen").attr("d",p),f.svgString()}}},function(e,t){e.exports=require("d3-array")},function(e,t){e.exports=require("d3-node")},function(e,t){e.exports=require("d3-scale")},function(e,t){e.exports=require("d3-shape")},function(e,t){e.exports=require("waveform-data")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(147);t.Waveform=class{constructor(e,t){this.stream=e,this.samples=[],this.opts=Object.assign({samplesPerPixel:256,sampleRate:44100},t||{})}run(e){const t=new i.WaveformStream(this.opts.samplesPerPixel,this.opts.sampleRate);t.on("readable",()=>{let e=t.read();for(;e&&e.length>0;)this.samples.push(e[0]),this.samples.push(e[1]),e=t.read()}),t.on("done",t=>{e(t)}),this.stream.pipe(t)}asBinaryV1(){const e=Buffer.alloc(2*this.samples.length+20);e.writeInt32LE(1,0),e.writeUInt32LE(0,4),e.writeInt32LE(this.opts.sampleRate,8),e.writeInt32LE(this.opts.samplesPerPixel,12),e.writeInt32LE(this.samples.length/2,16);let t=20;return this.samples.forEach(r=>{e.writeInt16LE(r,t),t+=2}),e}asBinary(){const e=Buffer.alloc(2*this.samples.length+24);e.writeInt32LE(2,0),e.writeUInt32LE(0,4),e.writeInt32LE(this.opts.sampleRate,8),e.writeInt32LE(this.opts.samplesPerPixel,12),e.writeInt32LE(this.samples.length/2,16),e.writeInt32LE(2,20);let t=24;return this.samples.forEach(r=>{e.writeInt16LE(r,t),t+=2}),e}asJSON(){return{version:2,channels:1,sample_rate:this.opts.sampleRate,samples_per_pixel:this.opts.samplesPerPixel,bits:16,length:this.samples.length/2,data:this.samples}}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(50)),a=r(48),n=r(2).logger("waveform.stream");class o extends a.Transform{constructor(e,t){super({writableObjectMode:!1,readableObjectMode:!0,highWaterMark:1024}),this._buf=new a.PassThrough,this._out=new a.PassThrough,this._started=!1,this._min=null,this._max=null,this._samples=0,this._total=0,this._samplesPerPixel=null!=e?e:256,this._sampleRate=null!=t?t:44100;const r={source:this._buf};this._ffmpeg=s.default(r).addOptions(["-f s16le","-ac 1","-acodec pcm_s16le","-ar "+this._sampleRate]),this._ffmpeg.on("start",e=>(n.debug("ffmpeg started with "+e),this._started=!0,this.emit("_started")));let i=!1;this._ffmpeg.on("error",e=>"ENOENT"===e.code?(i=!0,n.debug("ffmpeg failed to start."),this.emit("done","ffmpeg failed to start")):(i=!0,n.debug("ffmpeg decoding error: "+e),this.emit("done","ffmpeg decoding error: "+e))),this._ffmpeg.on("end",()=>{if(!i)return this.emit("done")}),this._ffmpeg.writeToStream(this._out),this._out.on("readable",()=>this.start())}start(){let e=this._out.read();for(;e&&e.length>0;)this.readResults(e.readInt16LE(0),2,e),e=this._out.read()}readResults(e,t,r){const i=r.length;for(;t<=i&&(this._min=null===this._min?e:Math.min(this._min,e),this._max=null===this._max?e:Math.max(this._max,e),this._samples+=1,this._samples===this._samplesPerPixel&&(this.push([Math.round(this._min),Math.round(this._max)]),this._min=null,this._max=null,this._samples=0),!(t>=i));)e=r.readInt16LE(t),t+=2}_transform(e,t,r){this._total+=e.length,this._started?this._buf.write(e,t,r):this.once("_started",()=>{this._buf.write(e,t,r)})}_flush(e){this._buf.end(),this._out.once("end",()=>{this._samples>0&&this.push([this._min,this._max]),e()})}}t.WaveformStream=o},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(38);t.flac_test=function(e){return i(this,void 0,void 0,(function*(){const t=yield s.spawnTool("flac","FLAC_PATH",["-wst",e]);if(t.errMsg&&t.errMsg.length>0)return t.errMsg}))}},function(e,t){e.exports=require("p-queue")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),a=r(0),n=r(20),o=r(15),c=r(21),d=r(31);class u extends c.BaseController{constructor(e,t,r,i,s){super(e,t,r,i),this.userService=e,this.stateService=t,this.imageService=r,this.downloadService=i,this.sessionService=s}prepare(e,t,r){return i(this,void 0,void 0,(function*(){return d.formatUser(e)}))}translateQuery(e,t){return i(this,void 0,void 0,(function*(){return{query:e.query,id:e.id,ids:e.ids,name:e.name,isAdmin:e.isAdmin,offset:e.offset,amount:e.amount,sorts:e.sortField?[{field:e.sortField,descending:!!e.sortDescending}]:void 0}}))}create(e){return i(this,void 0,void 0,(function*(){if(!(yield this.userService.auth(e.user.name,e.query.password)))return Promise.reject(s.UnauthError());const t=o.randomString(16),r=n.hashAndSaltSHA512(t),i={id:"",name:e.query.name||"",salt:r.salt,hash:r.hash,email:"",type:a.DBObjectType.user,created:Date.now(),scrobblingEnabled:!1,roles:{admin:void 0!==e.query.roleAdmin&&e.query.roleAdmin,stream:void 0===e.query.roleStream||e.query.roleStream,upload:void 0!==e.query.roleUpload&&e.query.roleUpload,podcast:void 0!==e.query.rolePodcast&&e.query.rolePodcast}};return i.id=yield this.userService.create(i),this.prepare(i,{},e.user)}))}update(e){return i(this,void 0,void 0,(function*(){const t=yield this.checkUserAccess(e.query.id,e.query.password,e.user);if(e.query.name){if(e.query.name!==t.name){if(yield this.userService.getByName(e.query.name))return Promise.reject(s.GenericError("Username already exists"))}t.name=e.query.name.trim()}return e.query.email&&(t.email=e.query.email.trim()),void 0!==e.query.roleAdmin&&(t.roles.admin=e.query.roleAdmin),void 0!==e.query.rolePodcast&&(t.roles.podcast=e.query.rolePodcast),void 0!==e.query.roleStream&&(t.roles.stream=e.query.roleStream),void 0!==e.query.roleUpload&&(t.roles.upload=e.query.roleUpload),yield this.userService.update(t),this.prepare(t,{},e.user)}))}delete(e){return i(this,void 0,void 0,(function*(){const t=yield this.byID(e.query.id);yield this.userService.remove(t),yield this.sessionService.clearCache()}))}imageRandom(e){return i(this,void 0,void 0,(function*(){let t=e.user;if(e.query.id){if(!t.roles.admin)return Promise.reject(s.UnauthError());t=yield this.byID(e.query.id)}yield this.userService.generateAvatar(t,e.query.seed||o.randomString(42))}))}imageUploadUpdate(e){return i(this,void 0,void 0,(function*(){if(!e.file)return Promise.reject(s.InvalidParamError("Image upload failed"));const t=yield this.byID(e.query.id);return t.id===e.user.id||e.user.roles.admin?this.userService.setUserImage(t,e.file,e.fileType):Promise.reject(s.UnauthError())}))}checkUserAccess(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.byID(e);if(i.id===r.id||r.roles.admin){if(yield this.userService.auth(r.name,t))return i}return Promise.reject(s.UnauthError())}))}passwordUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.checkUserAccess(e.query.id,e.query.password,e.user);return this.userService.setUserPassword(t,e.query.newPassword)}))}emailUpdate(e){return i(this,void 0,void 0,(function*(){const t=yield this.checkUserAccess(e.query.id,e.query.password,e.user);return this.userService.setUserEmail(t,e.query.email)}))}}t.UserController=u},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(16),n=r(5),o=r(0),c=r(1),d=s(r(6));t.WaveformController=class{constructor(e,t){this.store=e,this.waveformService=t}svgByPathParameter(e){return i(this,void 0,void 0,(function*(){const{id:t,size:r,format:i}=yield a.validatePathParameterIDSizeFormat(e.query.pathParameter,[c.WaveformFormatType.svg],c.WaveformFormatType.svg,1,6e3);return this.getWaveform(t,i,r)}))}waveformByPathParameter(e){return i(this,void 0,void 0,(function*(){const{id:t,format:r}=yield a.validatePathParameterIDFormat(e.query.pathParameter,c.WaveformFormats,c.WaveformDefaultFormat);return this.getWaveform(t,r)}))}getWaveform(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.byID(e);switch(t=t||c.WaveformDefaultFormat,i.type){case o.DBObjectType.track:return this.waveformService.getTrackWaveform(i,t,r);case o.DBObjectType.episode:return this.waveformService.getEpisodeWaveform(i,t,r)}return Promise.reject(Error("Invalid Object Type for Waveform generation"))}))}waveform(e){return i(this,void 0,void 0,(function*(){return this.getWaveform(e.query.id,e.query.format)}))}json(e){return i(this,void 0,void 0,(function*(){const t=yield this.getWaveform(e.query.id,c.WaveformFormatType.json);return t.json?t.json:t.buffer?JSON.parse(t.buffer.buffer.toString()):t.file?JSON.parse((yield d.default.readFile(t.file.filename)).toString()):Promise.reject(Error("Error on Waveform generation"))}))}byID(e){return i(this,void 0,void 0,(function*(){if(!e||0===e.length)return Promise.reject(n.InvalidParamError());const t=yield this.store.findInStores(e,this.store.streamStores());return t||Promise.reject(n.NotFoundError())}))}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(153));t.registerPublicCORS=function(e,t){e.use(s.default({preflightContinue:!1,credentials:!0,allowedHeaders:["Content-Type","Authorization"],origin:!0,methods:["GET","POST"]}))},t.registerAuthenticatedCors=function(e,t){e.use(s.default((e,r)=>{const i=t.config.server.session.allowedCookieDomains||[];r(null,{preflightContinue:!1,credentials:!0,allowedHeaders:["Content-Type","Authorization"],origin(t,r){!t||i.includes(t)||"OPTIONS"===e.method||e.jwt?r(null,!0):r(new Error("Not allowed by CORS"))},methods:["GET","POST"]})}))}},function(e,t){e.exports=require("cors")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(42),s=r(5);function a(e,t,r){if(!e.client&&e.session&&e.session.client&&(e.client=e.session.client),e.user)return r();i.ApiBaseResponder.sendErrorMsg(e,t,401,s.Errors.unauthorized)}t.registerAuthentication=function(e,t){e.use(a)}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(156)),n=s(r(157)),o=s(r(158)),c=s(r(159)),d=r(31),u=r(20),l=r(2),m=r(51),p=r(23),f=r(30),y=l.logger("Jam.Api.Passport");function h(e){return u.hashMD5(e)}function g(e){return i(this,void 0,void 0,(function*(){e.jwth&&(yield e.engine.sessionService.removeByJwth(e.jwth)),yield function(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{if(!e.session)return t();e.session.destroy(e=>e?r(e):t())})}))}(e),yield e.engine.sessionService.clearCache()}))}t.registerPassPort=function(e,t){e.use(n.default.initialize()),e.use(n.default.session()),n.default.serializeUser((e,t)=>{t(null,e.id)}),n.default.deserializeUser((e,r)=>{t.userService.getByID(e).then(e=>r(null,e||!1)).catch(r)}),n.default.use("local",new c.default.Strategy({usernameField:"username",passwordField:"password"},(e,r,i)=>{t.userService.auth(e,r).then(e=>i(null,e||!1)).catch(i)}));const r=(e,r)=>{t.userService.getByID(e.id).then(t=>r(null,t||!1,e)).catch(r)};n.default.use("jwt-header",new o.default.Strategy({jwtFromRequest:o.default.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:t.config.server.jwt.secret},r)),n.default.use("jwt-parameter",new o.default.Strategy({jwtFromRequest:o.default.ExtractJwt.fromUrlQueryParameter("bearer"),secretOrKey:t.config.server.jwt.secret},r)),e.use((function(e,t,r){if(e.user)return r();let i="",s=e.header("Authorization");if(s?(s=s.slice(7),i="jwt-header"):(s=""+e.query.bearer,s&&(i="jwt-parameter")),!s||!i)return r();const a=h(s);n.default.authenticate(i,{session:!1},(t,i,s)=>t?(y.error(t),r()):s instanceof Error||!i?r():void e.engine.sessionService.isRevoked(a).then(t=>{t||(e.jwt=!!i,e.jwth=a,e.client=s.client,e.user=i),r()}).catch(e=>{throw e}))(e,t,r)}))},t.CallSessionLoginHandler=function(e,t,r){n.default.authenticate("local",(i,s)=>{if(i||!s)return r();e.login(s,i=>{if(i)return y.error(i),r();const n=e.body.client||"Unknown Client";e.client=n;const o=e.body.jwt?function(e,t,r){const i=m.getMaxAge(r.engine.config.server.jwt.maxAge),s={id:e,exp:i>0?Math.floor((Date.now()+i)/1e3):void 0,client:t};return a.default.sign(s,r.engine.config.server.jwt.secret)}(s.id,n,e):void 0;e.session&&(e.session.client=n,e.session.userAgent=e.headers["user-agent"],o&&(e.session.jwth=h(o)));const c={version:f.JAMAPI_VERSION,allowedCookieDomains:e.engine.config.server.session.allowedCookieDomains,jwt:o,user:d.formatUser(e.user)};p.ApiResponder.data(e,t,c)})})(e,t,r)},t.CallSessionLogoutHandler=function(e,t,r){e.logout(),g(e).catch(e=>{console.error(e)}),t.clearCookie(e.engine.config.server.session.cookie.name,{path:"/"}),p.ApiResponder.ok(e,t)}},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("passport-jwt")},function(e,t){e.exports=require("passport-local")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(5);t.checkRoles=function(e,t){return i(this,void 0,void 0,(function*(){if(!e)return Promise.reject(s.UnauthError());if(t&&t.length>0)for(const r of t)if(!e.roles[r])return Promise.reject(s.UnauthError())}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(23);t.registerPublicApi=function(e,t){e.get("/ping",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.sessionController.ping(i);s.ApiResponder.data(e,r,a)}))),e.get("/session",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.sessionController.session(i);s.ApiResponder.data(e,r,a)})))},t.registerAccessControlApi=function(e,t){e.get("/lastfm/lookup",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.lastfmLookup(i);s.ApiResponder.data(e,r,a)}))),e.get("/lyricsovh/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.lyricsovhSearch(i);s.ApiResponder.data(e,r,a)}))),e.get("/acoustid/lookup",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.acoustidLookup(i);s.ApiResponder.data(e,r,a)}))),e.get("/musicbrainz/lookup",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.musicbrainzLookup(i);s.ApiResponder.data(e,r,a)}))),e.get("/musicbrainz/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.musicbrainzSearch(i);s.ApiResponder.data(e,r,a)}))),e.get("/acousticbrainz/lookup",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.acousticbrainzLookup(i);s.ApiResponder.data(e,r,a)}))),e.get("/coverartarchive/lookup",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.coverartarchiveLookup(i);s.ApiResponder.data(e,r,a)}))),e.get("/wikipedia/summary",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.wikipediaSummary(i);s.ApiResponder.data(e,r,a)}))),e.get("/wikidata/summary",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.wikidataSummary(i);s.ApiResponder.data(e,r,a)}))),e.get("/wikidata/lookup",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.metadataController.wikidataLookup(i);s.ApiResponder.data(e,r,a)}))),e.get("/autocomplete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.autocompleteController.autocomplete(i);s.ApiResponder.data(e,r,a)}))),e.get("/genre/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.genreController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/stats",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.statsController.get(i);s.ApiResponder.data(e,r,a)}))),e.get("/nowPlaying/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.nowPlayingController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/chat/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.chatController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/index",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.index(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.tracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/subfolders",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.subfolders(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/artist/similar",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.artistSimilar(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/artist/info",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.artistInfo(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/album/info",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.albumInfo(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/health",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.health(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.get("/folder/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/artist/similar/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.artistSimilarTracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/folder/artworks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.artworks(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/rawTag",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.rawTag(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/rawTags",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.rawTags(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/similar",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.similar(i);s.ApiResponder.data(e,r,a)}))),e.get("/track/health",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.health(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.get("/track/lyrics",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.lyrics(i);s.ApiResponder.data(e,r,a)}))),e.get("/episode/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/episode/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/episode/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/episode/retrieve",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client};yield t.episodeController.retrieve(i),s.ApiResponder.ok(e,r)})),["podcast"]),e.get("/episode/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/episode/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/episode/status",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.status(i);s.ApiResponder.data(e,r,a)}))),e.get("/episode/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/status",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.status(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/episodes",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.episodes(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/refreshAll",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client};yield t.podcastController.refreshAll(i),s.ApiResponder.ok(e,r)})),["podcast"]),e.get("/podcast/refresh",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client};yield t.podcastController.refresh(i),s.ApiResponder.ok(e,r)})),["podcast"]),e.get("/podcast/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/podcast/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/radio/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.radioController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/radio/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.radioController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/radio/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.radioController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/radio/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.radioController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/radio/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.radioController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/similar/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.similarTracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/similar",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.similar(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/index",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.index(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.tracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/albums",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.albums(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/series",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.series(i);s.ApiResponder.data(e,r,a)}))),e.get("/artist/info",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.info(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/index",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.index(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/similar/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.similarTracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.tracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/album/info",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.info(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/index",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.index(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.tracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/albums",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.albums(i);s.ApiResponder.data(e,r,a)}))),e.get("/series/info",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.seriesController.info(i);s.ApiResponder.data(e,r,a)}))),e.get("/playlist/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/playlist/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/playlist/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/playlist/state",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.state(i);s.ApiResponder.data(e,r,a)}))),e.get("/playlist/states",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.states(i);s.ApiResponder.data(e,r,a)}))),e.get("/playlist/tracks",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.tracks(i);s.ApiResponder.data(e,r,a)}))),e.get("/playlist/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/user/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.userController.id(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.get("/user/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.userController.ids(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.get("/user/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.userController.search(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.get("/user/sessions/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.sessionController.sessions(i);s.ApiResponder.data(e,r,a)}))),e.get("/playqueue/get",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playqueueController.get(i);s.ApiResponder.data(e,r,a)}))),e.get("/bookmark/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.bookmarkController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/bookmark/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.bookmarkController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/bookmark/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.bookmarkController.list(i);s.ApiResponder.data(e,r,a)}))),e.get("/bookmark/byTrack/list",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.bookmarkController.byTrackList(i);s.ApiResponder.data(e,r,a)}))),e.get("/root/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.rootController.id(i);s.ApiResponder.data(e,r,a)}))),e.get("/root/ids",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.rootController.ids(i);s.ApiResponder.data(e,r,a)}))),e.get("/root/search",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.rootController.search(i);s.ApiResponder.data(e,r,a)}))),e.get("/root/status",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.rootController.status(i);s.ApiResponder.data(e,r,a)}))),e.get("/admin/settings",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.settingsController.admin(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.get("/admin/queue/id",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.rootController.queueId(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.get("/folder/download",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.download(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/folder/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/folder/artwork/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.folderController.artworkImage(i);s.ApiResponder.binary(e,r,a)}))),e.get("/track/stream",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.stream(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/track/download",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.download(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/track/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.trackController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/episode/stream",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.stream(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/episode/download",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.download(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/episode/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.episodeController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/podcast/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/podcast/download",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.podcastController.download(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/artist/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/artist/download",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.artistController.download(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/album/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/album/download",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.albumController.download(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/playlist/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/playlist/download",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.playlistController.download(i);s.ApiResponder.binary(e,r,a)})),["stream"]),e.get("/user/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.userController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/root/image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.rootController.image(i);s.ApiResponder.binary(e,r,a)}))),e.get("/image/:pathParameter",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.params,user:e.user,client:e.client},a=yield t.imageController.imageByPathParameter(i);s.ApiResponder.binary(e,r,a)})),[],"image/{pathParameter}"),e.get("/stream/:pathParameter",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.params,user:e.user,client:e.client},a=yield t.streamController.streamByPathParameter(i);s.ApiResponder.binary(e,r,a)})),["stream"],"stream/{pathParameter}"),e.get("/waveform/:pathParameter",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.params,user:e.user,client:e.client},a=yield t.waveformController.waveformByPathParameter(i);s.ApiResponder.binary(e,r,a)})),["stream"],"waveform/{pathParameter}"),e.get("/waveform_svg/:pathParameter",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.params,user:e.user,client:e.client},a=yield t.waveformController.svgByPathParameter(i);s.ApiResponder.binary(e,r,a)})),["stream"],"waveform_svg/{pathParameter}"),e.get("/waveform_json",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.query,user:e.user,client:e.client},a=yield t.waveformController.json(i);s.ApiResponder.data(e,r,a)})),["stream"]),e.get("/download/:pathParameter",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.params,user:e.user,client:e.client},a=yield t.downloadController.downloadByPathParameter(i);s.ApiResponder.binary(e,r,a)})),["stream"],"download/{pathParameter}"),e.post("/stream/scrobble",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.streamController.scrobble(i),s.ApiResponder.ok(e,r)}))),e.post("/bookmark/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.bookmarkController.create(i);s.ApiResponder.data(e,r,a)}))),e.post("/bookmark/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.bookmarkController.delete(i),s.ApiResponder.ok(e,r)}))),e.post("/bookmark/byTrack/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.bookmarkController.byTrackDelete(i),s.ApiResponder.ok(e,r)}))),e.post("/chat/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.chatController.create(i),s.ApiResponder.ok(e,r)}))),e.post("/chat/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.chatController.delete(i),s.ApiResponder.ok(e,r)}))),e.post("/radio/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.radioController.create(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/radio/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.radioController.update(i),s.ApiResponder.ok(e,r)})),["admin"]),e.post("/radio/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.radioController.delete(i),s.ApiResponder.ok(e,r)})),["admin"]),e.post("/track/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.trackController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/track/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.trackController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/track/rawTag/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.trackController.rawTagUpdate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/track/name/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.trackController.nameUpdate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/track/parent/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.trackController.parentUpdate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/track/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.trackController.delete(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/track/fix",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.trackController.fix(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/folder/artwork/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.artworkCreate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/folder/artwork/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.artworkDelete(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/folder/artwork/name/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.artworkNameUpdate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.upload("/folder/artworkUpload/create","image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client,file:e.file?e.file.path:void 0,fileType:e.file?e.file.mimetype:void 0},a=yield t.folderController.artworkUploadCreate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.upload("/folder/artworkUpload/update","image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client,file:e.file?e.file.path:void 0,fileType:e.file?e.file.mimetype:void 0},a=yield t.folderController.artworkUploadUpdate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/folder/name/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.nameUpdate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/folder/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/folder/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/folder/parent/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.parentUpdate(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/folder/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.delete(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/folder/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.folderController.create(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/album/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.albumController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/album/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.albumController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/artist/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.artistController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/artist/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.artistController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/series/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.seriesController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/series/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.seriesController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/episode/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.episodeController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/episode/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.episodeController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/podcast/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.podcastController.create(i);s.ApiResponder.data(e,r,a)})),["podcast"]),e.post("/podcast/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.podcastController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/podcast/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.podcastController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/podcast/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.podcastController.delete(i),s.ApiResponder.ok(e,r)})),["podcast"]),e.post("/playlist/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.playlistController.create(i);s.ApiResponder.data(e,r,a)}))),e.post("/playlist/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.playlistController.update(i),s.ApiResponder.ok(e,r)}))),e.post("/playlist/fav/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.playlistController.favUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/playlist/rate/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.playlistController.rateUpdate(i);s.ApiResponder.data(e,r,a)}))),e.post("/playlist/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.playlistController.delete(i),s.ApiResponder.ok(e,r)}))),e.post("/playqueue/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.playqueueController.update(i),s.ApiResponder.ok(e,r)}))),e.post("/playqueue/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.playqueueController.delete(i),s.ApiResponder.ok(e,r)}))),e.post("/user/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.userController.create(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/user/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.userController.update(i),s.ApiResponder.ok(e,r)})),["admin"]),e.post("/user/password/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.userController.passwordUpdate(i),s.ApiResponder.ok(e,r)}))),e.post("/user/email/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.userController.emailUpdate(i),s.ApiResponder.ok(e,r)}))),e.post("/user/image/random",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.userController.imageRandom(i),s.ApiResponder.ok(e,r)}))),e.upload("/user/imageUpload/update","image",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client,file:e.file?e.file.path:void 0,fileType:e.file?e.file.mimetype:void 0};yield t.userController.imageUploadUpdate(i),s.ApiResponder.ok(e,r)}))),e.post("/user/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.userController.delete(i),s.ApiResponder.ok(e,r)})),["admin"]),e.post("/user/sessions/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.sessionController.delete(i),s.ApiResponder.ok(e,r)}))),e.post("/root/create",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.rootController.create(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/root/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.rootController.update(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/root/delete",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.rootController.delete(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/root/refresh",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.rootController.refresh(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/root/refreshAll",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client},a=yield t.rootController.refreshAll(i);s.ApiResponder.data(e,r,a)})),["admin"]),e.post("/admin/settings/update",(e,r)=>i(this,void 0,void 0,(function*(){const i={query:e.body,user:e.user,client:e.client};yield t.settingsController.adminUpdate(i),s.ApiResponder.ok(e,r)})),["admin"])}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(52)),a=r(51),n=r(163);t.registerSession=function(e,t){e.use(function(e){const t=a.getMaxAge(e.config.server.session.cookie.maxAge);return s.default({name:e.config.server.session.cookie.name,secret:e.config.server.session.secret,store:new n.ExpressSessionStore(e.sessionService),resave:!1,proxy:e.config.server.session.cookie.proxy,saveUninitialized:!1,cookie:{secure:e.config.server.session.cookie.secure,maxAge:t>0?t:void 0}})}(t))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(52),a=r(0),n=r(164);class o extends s.Store{constructor(e){super(),this.sessionService=e,this.cache=new Map,this.get=(e,t)=>{this._get(e).then(e=>t(null,e)).catch(t)},this.set=(e,t,r)=>{this.cache.set(e,t),this.sessionService.set(this.toJam(e,t)).then(r).catch(r)},this.destroy=(e,t)=>{this.sessionService.remove(e).then(t).catch(t)},this.all=e=>{this.sessionService.all().then(t=>{const r={};for(const e of t)r[e.sessionID]=this.toExpress(e);e(null,r)}).catch(t=>e(t,void 0))},this.length=e=>{this.sessionService.count().then(t=>e(null,t)).catch(t=>e(t,void 0))},this.clear=e=>{this.cache.clear(),this.sessionService.clear().then(e).catch(e)},e.registerNotify(this)}clearCache(){return i(this,void 0,void 0,(function*(){this.cache.clear()}))}expired(e){return(e.cookie.expires||0)<Date.now()}toJam(e,t){return{id:"",sessionID:e,jwth:t.jwth,agent:t.userAgent,mode:t.jwth?n.SessionMode.jwt:n.SessionMode.browser,client:t.client,cookie:JSON.stringify(t.cookie),type:a.DBObjectType.session,userID:t.passport.user,expires:t.cookie.expires.valueOf()}}toExpress(e){return{cookie:JSON.parse(e.cookie),client:e.client,jwth:e.jwth,userAgent:e.agent,passport:{user:e.userID}}}_get(e){return i(this,void 0,void 0,(function*(){const t=this.cache.get(e);if(t)return this.expired(t)?void(yield this.sessionService.remove(e)):t;const r=yield this.sessionService.get(e);if(r){const t=this.toExpress(r);return this.cache.set(e,t),t}}))}}t.ExpressSessionStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.browser="browser",e.jwt="jwt"}(t.SessionMode||(t.SessionMode={}))},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(166)),a=i(r(167)),n=r(4),o=r(2).logger("Jam.Api.Upload");class c{constructor(e){const t=e+"/";this.upload=s.default({dest:t})}handler(e,t=!0){const r=this.upload.single(e);return(e,i,s)=>{t&&function(e,t){a.default(t,t=>{t&&e.file&&e.file.path&&n.fileDeleteIfExists(e.file.path).catch(e=>{o.error(e)})})}(e,i),r(e,i,s)}}}t.jamUpload=function(e){return new c(e)}},function(e,t){e.exports=require("multer")},function(e,t){e.exports=require("on-finished")},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(3));function a(e){if(!e.server)throw new Error("JamServe Config: Missing server settings");if(!e.database)throw new Error("JamServe Config: Missing database settings");e.server.limit||(console.error("JamServe Config: Missing server limit settings, using default values"),e.server.limit={login:{max:5,window:60},api:{max:20,window:60}})}function n(e,t){return Object.assign(Object.assign({},e),{firstStart:t,getDataPath:t=>s.default.resolve(e.paths.data,...t)})}t.validateConfig=a,t.extendConfig=n,t.loadConfig=function(e){e=e&&e.length>0?e:s.default.join(process.cwd(),"config");const t=s.default.join(e,"config.js"),i=s.default.join(e,"firststart.config.js");let o,c;require?(o=require(t),c=require(i)):(o=r(53)(t),c=r(53)(i));const d=n(o,c);return a(d),d}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(170),a=r(2),n=r(171),o=r(0),c=r(172),d=r(54),u=r(173),l=a.logger("DB.elastic");t.DBElastic=class{constructor(e){this.client=new s.Client({node:e.host,maxRetries:5,requestTimeout:3e4,pingTimeout:3e4}),this.sequence=new u.DbElasticSequence(this.client),this.indexPrefix=e.indexPrefix,this.indexRefresh=e.indexRefresh}drop(){return i(this,void 0,void 0,(function*(){for(const e of this.getTypes())yield this.resetIndex(e)}))}close(){return i(this,void 0,void 0,(function*(){yield this.client.close()}))}ping(){return i(this,void 0,void 0,(function*(){try{yield this.client.ping()}catch(e){return l.error("elasticsearch could not be contacted",e),Promise.reject(e)}}))}open(){return i(this,void 0,void 0,(function*(){l.debug("Open connection to elasticsearch"),yield this.ping(),yield this.sequence.init(this.client),yield this.check()}))}getNewId(){return i(this,void 0,void 0,(function*(){return(yield this.sequence.get(this.indexName("id"))).toString()}))}indexName(e){return`${this.indexPrefix}_${e}`}getTypes(){return Object.keys(o.DBObjectType).filter(e=>!isNaN(Number(e))).map(Number)}resetIndex(e){return i(this,void 0,void 0,(function*(){const t=this.indexName(o.DBObjectType[e]);(yield this.client.indices.exists({index:t}))&&(yield this.client.indices.delete({index:t}))}))}reset(){return i(this,void 0,void 0,(function*(){for(const e of this.getTypes())yield this.resetIndex(e)}))}createIndex(e){return i(this,void 0,void 0,(function*(){const t=o.DBObjectType[e];if(!d.mapping[t])return Promise.reject(Error("Missing Elasticsearch Mapping for type "+t));const r=this.indexName(t),i={_default_:{_default_:{date_detection:!1}}};i[t]=d.mapping[t],yield this.client.indices.create({index:r,body:{mappings:i}})}))}checkIndex(e){return i(this,void 0,void 0,(function*(){const t=o.DBObjectType[e],r=this.indexName(t);return!(yield this.client.indices.exists({index:r})).body&&(yield this.createIndex(e),!0)}))}check(){return i(this,void 0,void 0,(function*(){let e=!1;for(const t of this.getTypes())e=(yield this.checkIndex(t))||e;e&&(yield n.wait(1e3))}))}getDBIndex(e){return new c.DBIndexElastic(e,this)}}},function(e,t){e.exports=require("@elastic/elasticsearch")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.wait=function(e){return i(this,void 0,void 0,(function*(){return new Promise(t=>setTimeout(t,e))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(54);t.DBIndexElastic=class{constructor(e,t){this.type=e,void 0===e?(this._index=t.indexName("*"),this._type=""):(this._type=s.DBObjectType[e],this._index=t.indexName(s.DBObjectType[e])),this._map=a.mapping[this._type],this.db=t}hit2Obj(e){return e._source.id=e._source.id.toString(),e._source.type=this.type,e._source}filterProperties(e){return Object.assign(Object.assign({},e),{type:void 0})}getPropertyMapping(e){const t=e.split(".");let r=this._map;for(const e of t)r=r.properties[e];return r}translateElasticQuery(e){if(e.all)return{match_all:{}};let t=[];if(e.term){const r=e.term;t=t.concat(Object.keys(r).map(e=>{const t={},i=this.getPropertyMapping(e);return i||console.log("Unknown prop",this._type,e),i&&"text"===i.type?t[e+".keyword"]=r[e]:t[e]=r[e],{term:t}}))}if(e.terms){const r=e.terms;t=t.concat(Object.keys(r).map(e=>{const t={},i=this.getPropertyMapping(e);return i||console.log("Unknown prop",this._type,e),i&&"text"===i.type?t[e+".keyword"]=r[e]:t[e]=r[e],{terms:t}}))}if(e.match){const r=e.match;t=t.concat(Object.keys(r).map(e=>{const t={};return t[e]=r[e],{match_phrase_prefix:t}}))}if(e.startsWith){const r=e.startsWith;t=t.concat(Object.keys(r).map(e=>{const t={};return t[e]=r[e],{prefix:t}}))}if(e.startsWiths){const r=e.startsWiths;Object.keys(r).forEach(e=>{r[e].forEach(r=>{const i={};i[e]=r,t.push({prefix:i})})})}if(e.range){const r=e.range;t=t.concat(Object.keys(r).map(e=>{const t=r[e],i={};return i[e]={gte:t.gte,lte:t.lte},{range:i}}))}if(e.notNull){const r=e.notNull;t=t.concat(r.map(e=>({exists:{field:e}})))}return{bool:{must:t}}}scroll(e,t){return i(this,void 0,void 0,(function*(){let r=0;const s=e=>i(this,void 0,void 0,(function*(){if(r+=e.hits.hits.length,yield t(e.hits.hits),e.hits.total!==r&&e._scroll_id){const t=yield this.db.client.scroll({scroll_id:e._scroll_id,scroll:"30s"});yield s(t.body)}}));yield s(e)}))}indexItem(e,t){return i(this,void 0,void 0,(function*(){yield this.db.client.index({index:this._index,type:this._type,body:this.filterProperties(e),id:t,refresh:this.db.indexRefresh})}))}search(e,t){return i(this,void 0,void 0,(function*(){return t.body=Object.assign(Object.assign({},t.body||{}),{query:this.translateElasticQuery(e)}),(yield this.db.client.search(Object.assign(Object.assign({},t),{index:this._index,type:this._type}))).body}))}add(e){return i(this,void 0,void 0,(function*(){return e.id&&0!==e.id.length||(e.id=yield this.getNewId()),yield this.indexItem(e,e.id),e.id}))}aggregate(e,t){return i(this,void 0,void 0,(function*(){return(yield this.search(e,{body:{aggs:{_count:{cardinality:{field:t}}}}})).aggregations._count.value}))}bulk(e){return i(this,void 0,void 0,(function*(){for(const t of e)yield this.add(t)}))}byId(e){return i(this,void 0,void 0,(function*(){if(void 0===this.type)return this.queryOne({term:{id:e}});try{const t=yield this.db.client.get({index:this._index,type:this._type,id:e});if(!t.body.found)return;return this.hit2Obj(t.body)}catch(e){if(404!==e.statusCode)return Promise.reject(e)}}))}byIds(e){return i(this,void 0,void 0,(function*(){if(0===e.length)return[];const t=yield this.db.client.mget({index:this._index,type:this._type,body:{ids:e}});return t.body.docs?t.body.docs.filter(e=>e.found).map(e=>this.hit2Obj(e)):[]}))}count(e){return i(this,void 0,void 0,(function*(){return(yield this.search(e,{size:0})).hits.total}))}distinct(e,t){return i(this,void 0,void 0,(function*(){return(yield this.search(e,{body:{aggs:{distinct:{terms:{field:t}}}}})).aggregations.distinct.buckets.map(e=>e.key)}))}getNewId(){return i(this,void 0,void 0,(function*(){return this.db.getNewId()}))}query(e){return i(this,void 0,void 0,(function*(){if(e.amount&&e.offset){const t=yield this.search(e,{from:e.offset,size:e.amount});return{amount:e.amount,offset:e.offset,total:t.hits.total,items:t.hits.hits.map(e=>this.hit2Obj(e))}}return this.queryScroll(e)}))}queryScroll(e){return i(this,void 0,void 0,(function*(){let t=[];const r=yield this.search(e,{scroll:"30s",size:100});return yield this.scroll(r,e=>i(this,void 0,void 0,(function*(){t=t.concat(e)}))),{total:t.length,items:t.map(e=>this.hit2Obj(e))}}))}queryOne(e){return i(this,void 0,void 0,(function*(){const t=yield this.search(e,{size:1});if(t.hits.total>0)return this.hit2Obj(t.hits.hits[0])}))}queryIds(e){return i(this,void 0,void 0,(function*(){let t=[];const r=yield this.search(e,{scroll:"30s",body:{stored_fields:[]}});return yield this.scroll(r,e=>i(this,void 0,void 0,(function*(){t=t.concat(e.map(e=>e._id.toString()))}))),t}))}iterate(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.search(e,{scroll:"30s",size:100});yield this.scroll(r,e=>i(this,void 0,void 0,(function*(){yield t(e.map(e=>this.hit2Obj(e)))})))}))}remove(e){return i(this,void 0,void 0,(function*(){if(0===e.length)return Promise.resolve(0);if(Array.isArray(e)){return(yield this.db.client.deleteByQuery({index:this._index,type:this._type,body:{query:{terms:{_id:e}}},refresh:!this.db.indexRefresh||"false"!==this.db.indexRefresh})).body.deleted}return yield this.db.client.delete({id:e,index:this._index,type:this._type,refresh:this.db.indexRefresh}),1}))}removeByQuery(e){return i(this,void 0,void 0,(function*(){return(yield this.db.client.deleteByQuery({index:this._index,type:this._type,body:{query:this.translateElasticQuery(e)},refresh:!this.db.indexRefresh||"false"!==this.db.indexRefresh})).body.deleted}))}replace(e,t){return i(this,void 0,void 0,(function*(){yield this.indexItem(t,e)}))}upsert(e,t){return i(this,void 0,void 0,(function*(){e&&0!==e.length?yield this.indexItem(t,e):yield this.add(t)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s={_source:{enabled:!1},_all:{enabled:!1},enabled:!1};class a{constructor(e){this.client=e,this.initPromise=null,this.initError=null,this.cacheFillPromise=null,this.cache={},this.cacheSize=100,this.options={esIndex:"sequences",esType:"sequence"}}static isObject(e){return"object"==typeof e}static isInjectedCacheSizeValid(e){return void 0===e||"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}init(e,t){return i(this,void 0,void 0,(function*(){return null!==this.initPromise?Promise.reject(new Error("Init was called while a previous init is pending.")):null!==this.cacheFillPromise?Promise.reject(new Error("Init was called while get requests are pending.")):a.isInjectedCacheSizeValid(t)?(this.initPromise=new Promise(r=>{this.cache={},this.cacheSize=100,this.initError=null,void 0!==t&&(this.cacheSize=t),a.isObject(e)&&(this.options=Object.assign(Object.assign({},this.options),e)),r(this.initEsIndexIfNeeded())}).catch(e=>{throw this.initError=e,e}).then(()=>{this.initPromise=null}),this.initPromise):Promise.reject(new Error("Init was called with an invalid cacheSize parameter value."))}))}addMappingToEsIndexIfMissing(){return i(this,void 0,void 0,(function*(){const e={};return e[this.options.esType]=s,this.client.indices.putMapping({index:this.options.esIndex,type:this.options.esType,body:e})}))}initEsIndexIfNeeded(){return i(this,void 0,void 0,(function*(){if((yield this.client.indices.exists({index:this.options.esIndex})).body)return this.addMappingToEsIndexIfMissing();const e={settings:{number_of_shards:1,auto_expand_replicas:"0-all"},mappings:{}};return e.mappings[this.options.esType]=s,this.client.indices.create({index:this.options.esIndex,body:e})}))}fillCache(e){return i(this,void 0,void 0,(function*(){return this.cacheFillPromise=new Promise(t=>{this.cache[e]||(this.cache[e]=[]);const r={body:[]};for(let t=0;t<this.cacheSize;t+=1)r.body.push({index:{_index:this.options.esIndex,_type:this.options.esType,_id:e}}),r.body.push({});t(this.client.bulk(r).then(t=>{for(const r of t.body.items)this.cache[e].push(r.index._version)}))}).then(()=>{this.cacheFillPromise=null}),this.cacheFillPromise}))}interal_get(e){return i(this,void 0,void 0,(function*(){if(null!==this.initError)return Promise.reject(this.initError);if(this.cache[e]&&this.cache[e].length>0)return Promise.resolve(this.cache[e].shift());const t=()=>i(this,void 0,void 0,(function*(){return this.interal_get(e)}));return null!==this.cacheFillPromise?this.cacheFillPromise.then(t):this.fillCache(e).then(t)}))}get(e){return i(this,void 0,void 0,(function*(){if(!this.client)throw new Error("Please run init(...) first to provide an elasticsearch client.");if(!e||0===e.length)throw new Error("The parameter value for sequenceName is invalid.");return null!==this.initPromise?this.initPromise.then(()=>this.interal_get(e)):this.interal_get(e)}))}getCacheSize(e){return this.cache[e]?this.cache[e].length:0}}t.DbElasticSequence=a},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(175)),n=s(r(3)),o=r(4),c=r(0),d=r(176);t.DBNedb=class{constructor(e){this.clients={},this.sequenceId=99999,this.getTypes().map(e=>c.DBObjectType[e]).forEach(t=>{this.clients[t]=this.initClient(t,e)})}initClient(e,t){const r=n.default.resolve(t,e+".db");return{client:new a.default({filename:r}),filename:r}}drop(){return i(this,void 0,void 0,(function*(){for(const e of this.getTypes()){const t=this.clients[c.DBObjectType[e]];yield o.fileDeleteIfExists(t.filename)}}))}checkMaxSequence(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{e.client.find({}).sort({id:-1}).exec((e,i)=>{if(e)return r(e);if(i.length>0){const e=Number(i[0].id);isNaN(e)||(this.sequenceId=Math.max(this.sequenceId,e))}t()})})}))}loadDatabase(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{e.client.loadDatabase(e=>{if(e)return r(e);t()})})}))}open(){return i(this,void 0,void 0,(function*(){for(const e of this.getTypes()){const t=this.clients[c.DBObjectType[e]];yield this.loadDatabase(t),yield this.checkMaxSequence(t)}yield this.check()}))}close(){return i(this,void 0,void 0,(function*(){}))}getTypes(){return Object.keys(c.DBObjectType).filter(e=>!isNaN(Number(e))).map(e=>parseInt(e,10))}resetIndex(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{e.remove({},{multi:!0},i=>{if(i)return r(i);e.loadDatabase(e=>{e&&r(e),t()})})})}))}reset(){return i(this,void 0,void 0,(function*(){for(const e of this.getTypes()){const t=this.clients[c.DBObjectType[e]];yield this.resetIndex(t.client)}}))}checkIndex(e){return i(this,void 0,void 0,(function*(){}))}check(){return i(this,void 0,void 0,(function*(){for(const e of this.getTypes()){const t=this.clients[c.DBObjectType[e]];yield this.checkIndex(t.client)}}))}getNewID(){return this.sequenceId++,this.sequenceId.toString()}getDBIndex(e){return new d.DBIndexNedb(e,this.clients[c.DBObjectType[e]].client,()=>this.getNewID())}}},function(e,t){e.exports=require("nedb")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(9),n=r(0);t.DBIndexNedb=class{constructor(e,t,r){this.type=e,this.client=t,this.getGlobalNewID=r,this._type=n.DBObjectType[e],this._index="jam_"+n.DBObjectType[e]}hit2Obj(e){return delete e._id,e}hits2Objs(e){return e.map(e=>this.hit2Obj(e))}getNewId(){return i(this,void 0,void 0,(function*(){return this.getGlobalNewID()}))}translateSortQuery(e){if(e.sort){const t={},r=e.sort;return Object.keys(r).forEach(e=>{t[e]=r[e]===s.DatabaseQuerySortType.ascending?1:-1}),t}}translateQuery(e){if(e.all)return{};let t=[];if(e.term){const r=e.term;t=t.concat(Object.keys(r).map(e=>{const t={};return t[e]=r[e],t}))}if(e.match){const r=e.match;t=t.concat(Object.keys(r).map(e=>{const t={};var i;return t[e]={$regex:new RegExp((i=r[e].toString(),i.replace(/[-[\]{}()*+!<=:?./\\^$|#\s,]/g,"\\$&")),"i")},t}))}if(e.terms){const r=e.terms;t=t.concat(Object.keys(r).map(e=>{const t={};return t[e]={$in:r[e]},t}))}if(e.startsWith){const r=e.startsWith;t=t.concat(Object.keys(r).map(e=>({$where(){return this[e].startsWith(r[e])}})))}if(e.startsWiths){const r=e.startsWiths;t=t.concat(Object.keys(r).map(e=>({$where(){return!!r[e].find(t=>this[e].startsWith(t))}})))}if(e.range){const r=e.range;Object.keys(r).forEach(e=>{const i=r[e];if(void 0!==i.gte){const r={};r[e]={$gte:i.gte},t.push(r)}if(void 0!==i.lte){const r={};r[e]={$lte:i.lte},t.push(r)}})}if(e.notNull){const r=e.notNull;t=t.concat(r.map(e=>{const t={};return t[e]={$exists:!0},t}))}return{$and:t}}add(e){return i(this,void 0,void 0,(function*(){return e.id&&0!==e.id.length||(e.id=yield this.getNewId()),new Promise((t,r)=>{this.client.insert(e,i=>{i?r(i):t(e.id)})})}))}bulk(e){return i(this,void 0,void 0,(function*(){for(const t of e)yield this.add(t)}))}replace(e,t){return i(this,void 0,void 0,(function*(){return new Promise((r,i)=>{this.client.update({id:e},t,{},(t,s)=>{t?i(t):1!==s?i(Error(`Could not find ${this._type} doc with id ${e}`)):r()})})}))}upsert(e,t){return i(this,void 0,void 0,(function*(){e&&0!==e.length?yield this.replace(e,t):yield this.add(t)}))}remove(e){return i(this,void 0,void 0,(function*(){const t=Array.isArray(e)?e:[e];return 0===t.length?0:new Promise((e,r)=>{this.client.remove({id:{$in:t}},{multi:!0},(i,s)=>{i?r(i):s!==t.length?r(Error(`Found nr of items ${s} does not match nr. of ids ${t.length}`)):e(s)})})}))}removeByQuery(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{this.client.remove(this.translateQuery(e),{multi:!0},(e,i)=>{e?r(e):t(i)})})}))}byId(e){return i(this,void 0,void 0,(function*(){return void 0===this.type?this.queryOne({term:{id:e}}):new Promise((t,r)=>{this.client.find({id:e},(e,i)=>{e?r(e):0===i.length?t():t(this.hit2Obj(i[0]))})})}))}byIds(e){return i(this,void 0,void 0,(function*(){return 0===e.length?[]:new Promise((t,r)=>{this.client.find({id:{$in:e}},(e,i)=>{e?r(e):t(this.hits2Objs(i))})})}))}query(e){return i(this,void 0,void 0,(function*(){let t=this.client.find(this.translateQuery(e));const r=this.translateSortQuery(e);return r&&(t=t.sort(r)),new Promise((r,i)=>{t.exec((t,s)=>{if(t)i(t);else{const t=a.paginate(s,e.amount,e.offset);r({items:this.hits2Objs(t.items),offset:t.offset,amount:t.amount,total:t.total})}})})}))}queryOne(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{this.client.find(this.translateQuery(e)).limit(1).exec((e,i)=>{e?r(e):0===i.length?t():t(this.hit2Obj(i[0]))})})}))}prepareFindCursor(e){let t=this.client.find(this.translateQuery(e));const r=this.translateSortQuery(e);return r&&(t=t.sort(r)),e.offset&&(t=t.skip(e.offset)),e.amount&&(t=t.limit(e.amount)),t}iterate(e,t){return i(this,void 0,void 0,(function*(){const r=this.prepareFindCursor(e);return new Promise((e,i)=>{r.exec((r,s)=>{r?i(r):t(this.hits2Objs(s)).then(e).catch(i)})})}))}queryIds(e){return i(this,void 0,void 0,(function*(){const t=this.prepareFindCursor(e);return new Promise((e,r)=>{t.exec((t,i)=>{t?r(t):e(i.map(e=>e.id))})})}))}getDotFieldValues(e,t){const r=[],i=(e,t)=>{const s=t[e[0]];if(void 0!==s)if(Array.isArray(s)){if(1===e.length)return;s.forEach(t=>{i(e.slice(1),t)})}else 1===e.length?r.push(s.toString()):"object"==typeof s&&i(e.slice(1),s)};return i(e.split("."),t),r}collectDistinctValues(e,t){const r=[];return t.forEach(t=>{this.getDotFieldValues(e,t).forEach(e=>{r.includes(e)||r.push(e)})}),r}aggregate(e,t){return i(this,void 0,void 0,(function*(){const r=this.prepareFindCursor(e);return new Promise((e,i)=>{r.exec((r,s)=>{r?i(r):e(this.collectDistinctValues(t,s).length)})})}))}count(e){return i(this,void 0,void 0,(function*(){return new Promise((t,r)=>{this.client.count(this.translateQuery(e),(e,i)=>{e?r(e):t(i)})})}))}distinct(e,t){return i(this,void 0,void 0,(function*(){return new Promise((r,i)=>{this.client.find(this.translateQuery(e),(e,s)=>{e?i(e):r(this.collectDistinctValues(t,s))})})}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(178),c=r(0),d=r(1),u=r(34),l=r(180),m=r(4),p=r(20),f=r(2),y=r(187),h=r(188),g=r(189),v=r(190),b=r(191),k=r(195),I=r(44),q=r(196),D=r(197),S=r(198),w=r(200),T=r(202),A=r(209),M=r(59),C=r(210),P=r(211),j=r(216),R=r(217),x=r(218),_=r(219),F=r(220),B=r(222),E=r(223),O=r(224),$=r(225),U=r(226),z=r(228),L=r(229),J=f.logger("Engine");t.Engine=class{constructor(e,t,r,s){this.config=e,this.store=t,this.version=r,this.imageModule=s&&s.image?s.image:new l.ImageModule(e.getDataPath(["cache","images"])),this.audioModule=s&&s.audio?s.audio:new u.AudioModule(e.getDataPath(["cache","waveforms"]),e.getDataPath(["cache","transcode"]),o.ThirdPartyConfig,this.imageModule),this.chatService=new v.ChatService,this.waveformService=new z.WaveformService(this.audioModule),this.streamService=new O.StreamService(this.audioModule),this.stateService=new B.StateService(this.store.stateStore),this.folderService=new I.FolderService(this.store.folderStore,this.store.trackStore,this.stateService,this.imageModule),this.trackService=new $.TrackService(this.store.trackStore,this.folderService,this.audioModule,this.imageModule,this.stateService),this.albumService=new y.AlbumService(this.store.albumStore,this.trackService,this.folderService,this.stateService),this.indexService=new S.IndexService(this.store.artistStore,this.store.albumStore,this.store.folderStore,this.store.trackStore,this.store.seriesStore),this.workerService=new L.WorkerService(this.store,this.audioModule,this.imageModule),this.settingsService=new F.SettingsService(t.settingsStore,this.chatService,this.indexService,this.workerService,this.audioModule,r),this.artistService=new h.ArtistService(this.store.artistStore,this.store.trackStore,this.folderService,this.stateService),this.userService=new U.UserService(this.config.getDataPath(["images"]),this.store.userStore,this.store.stateStore,this.store.playlistStore,this.store.bookmarkStore,this.store.playQueueStore,this.store.sessionStore,this.imageModule),this.genreService=new q.GenreService(this.store.trackStore),this.statsService=new E.StatsService(this.store),this.ioService=new w.IoService(this.store.rootStore,this.workerService,()=>i(this,void 0,void 0,(function*(){this.refresh().catch(e=>{J.error("Error on Refresh Indexes & Stats",e)})}))),this.downloadService=new b.DownloadService(this.store.trackStore,this.store.episodeStore),this.nowPlayingService=new A.NowPlayingService(this.stateService),this.playlistService=new M.PlaylistService(this.store.playlistStore,this.store.trackStore,this.stateService),this.playQueueService=new C.PlayQueueService(this.store.playQueueStore),this.bookmarkService=new g.BookmarkService(this.store.bookmarkStore),this.episodeService=new k.EpisodeService(e.getDataPath(["podcasts"]),this.store.episodeStore,this.stateService,this.audioModule,this.imageModule),this.podcastService=new P.PodcastService(e.getDataPath(["podcasts"]),this.store.podcastStore,this.episodeService,this.imageModule,this.stateService),this.seriesService=new x.SeriesService(this.store.seriesStore,this.store.trackStore,this.folderService,this.stateService),this.imageService=new D.ImageService(this.imageModule,this.trackService,this.folderService,this.artistService,this.albumService,this.userService,this.podcastService,this.episodeService,this.seriesService),this.metaDataService=new T.MetaDataService(this.store.metaStore,this.store.folderStore,this.store.trackStore,this.store.albumStore,this.store.artistStore,this.audioModule),this.rootService=new R.RootService(this.store.rootStore),this.radioService=new j.RadioService(this.store.radioStore),this.sessionService=new _.SessionService(this.store.sessionStore)}refresh(){return i(this,void 0,void 0,(function*(){J.info("Refresh Indexes & Stats"),yield this.indexService.buildDefaultIndexes(),yield this.genreService.refresh(),yield this.statsService.refresh(),yield this.metaDataService.cleanUp(),yield this.sessionService.clearExpired()}))}buildAdminUser(e){return i(this,void 0,void 0,(function*(){const t=p.hashAndSaltSHA512(e.pass||""),r={id:"",name:e.name,salt:t.salt,hash:t.hash,email:e.mail||"",type:c.DBObjectType.user,scrobblingEnabled:!0,created:Date.now(),roles:{stream:!0,upload:!0,admin:!0,podcast:!0}};yield this.userService.create(r)}))}buildRoots(e){return i(this,void 0,void 0,(function*(){for(const t of e){const e={id:"",created:Date.now(),type:c.DBObjectType.root,name:t.name,path:t.path,strategy:t.strategy||d.RootScanStrategy.auto};yield this.store.rootStore.add(e)}}))}checkFirstStart(){return i(this,void 0,void 0,(function*(){if(this.config.firstStart){if(this.config.firstStart.adminUser){0===(yield this.store.userStore.count())&&(yield this.buildAdminUser(this.config.firstStart.adminUser))}if(this.config.firstStart.roots){0===(yield this.store.rootStore.count())&&(yield this.buildRoots(this.config.firstStart.roots))}}}))}resolveCachePaths(){return[n.default.resolve(this.config.paths.data,"cache","waveforms"),n.default.resolve(this.config.paths.data,"cache","uploads"),n.default.resolve(this.config.paths.data,"cache","images"),n.default.resolve(this.config.paths.data,"cache","transcode"),n.default.resolve(this.config.paths.data,"images"),n.default.resolve(this.config.paths.data,"podcasts")]}checkDataPaths(){return i(this,void 0,void 0,(function*(){yield a.default.ensureDir(n.default.resolve(this.config.paths.data));const e=this.resolveCachePaths();for(const t of e)yield a.default.ensureDir(t)}))}start(){return i(this,void 0,void 0,(function*(){yield this.checkDataPaths(),yield this.store.open(),yield this.settingsService.loadSettings(),yield this.checkFirstStart()}))}stop(){return i(this,void 0,void 0,(function*(){yield this.store.close()}))}clearLocalFiles(){return i(this,void 0,void 0,(function*(){const e=this.resolveCachePaths();for(const t of e)yield m.pathDeleteIfExists(t)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(55);t.userAgent="JamServe/"+i.JAMSERVE_VERSION,t.ThirdPartyConfig={acoustid:{apiKey:"bLwTKyNczi",userAgent:t.userAgent},lastfm:{apiKey:"ead198fb293eefea29e8a5b8f0908e55",userAgent:t.userAgent},musicbrainz:{userAgent:t.userAgent+" ( jamserve@protonmail.com )"},acousticbrainz:{userAgent:t.userAgent+" ( jamserve@protonmail.com )"},coverartarchive:{userAgent:t.userAgent+" ( jamserve@protonmail.com )"},wikipedia:{userAgent:t.userAgent+" ( jamserve@protonmail.com )"},chartlyrics:{userAgent:t.userAgent}}},function(e){e.exports=JSON.parse('{"name":"jamserve","version":"0.2.29-alpha","author":"ffalt","license":"MIT","description":"jamserve streaming audio server","private":true,"repository":{"type":"git","url":"https://github.com/ffalt/jamserve.git"},"scripts":{"start":"node dist/jamserve.js","develop":"concurrently --kill-others \\"npm run build:dev:watch\\" \\"npm run develop:watch\\"","develop:watch":"nodemon --config nodemon.json","clearDB":"node dist/jamserve.js --cleardb","lint":"eslint ./src --ext .js,.ts","lint:debug":"DEBUG=eslint:cli-engine eslint ./src --ext .js,.ts","clean":"rimraf dist","test":"jest --maxWorkers=1","test:watch":"jest --maxWorkers=1 --watch","coverage":"jest --runInBand --coverage","build:changelog":"conventional-changelog -p angular -i CHANGELOG.md -s","build:prod":"webpack --mode production","build:deploy":"npm run clean && npm run build:prod && npm run build:files && npm run build:docs","build:dev":"webpack --mode development","build:dev:watch":"webpack --watch --mode development","build:files":"ts-node dev/bin/deploy-static.ts","build:docs":"npm run build:jam:api:docs","build:model":"npm run build:model:jam","build:model:jam":"npm run build:jam:openapi && npm run build:jam:elastic && npm run build:jam:client:angular && npm run build:jam:client:axios && npm run build:jam:router && npm run build:jam:tests","build:jam:tests":"cd dev/bin && ts-node update-jam-openapi-test.ts","build:jam:openapi":"cd dev/bin && ts-node update-jam-openapi.ts","build:jam:elastic":"cd dev/bin && ts-node update-elastic-mapping.ts","build:jam:client:angular":"cd dev/bin && ts-node update-jam-client.ts","build:jam:client:axios":"cd dev/bin && ts-node update-jam-client-axios.ts","build:jam:router":"cd dev/bin && ts-node update-jam-router.ts","build:jam:api:docs":"redoc-cli bundle src/model/jam-openapi.json --output ./dist/static/docs/api/jam/index.html"},"dependencies":{"@elastic/elasticsearch":"7.6.1","ajv":"6.12.2","archiver":"4.0.1","body-parser":"1.19.0","colors":"1.4.0","commander":"5.1.0","common-password-checker":"0.1.0","cookie-parser":"1.4.5","cors":"2.8.5","d3":"5.16.0","d3-array":"2.4.0","d3-node":"2.2.1","d3-scale":"3.2.1","d3-shape":"1.3.7","eslint":"6.8.0","express":"4.17.1","express-rate-limit":"5.1.3","express-session":"1.17.1","express-useragent":"1.0.13","feedparser":"2.2.10","fluent-ffmpeg":"2.1.2","fs-extra":"9.0.0","helmet":"3.22.0","iconv-lite":"0.5.1","jamp3":"0.4.1","jimp":"0.10.3","json-schema-ref-parser":"9.0.1","jsonwebtoken":"8.5.1","limiter":"1.1.5","mime-types":"2.1.27","moment":"2.25.3","multer":"1.4.2","nedb":"1.8.0","node-worker-threads-pool":"1.2.2","on-finished":"2.3.0","p-queue":"6.4.0","passport":"0.4.1","passport-jwt":"4.0.0","passport-local":"1.0.0","request":"2.88.2","seedrandom":"3.0.5","sharp":"0.25.2","svgo":"1.3.2","tmp":"0.2.1","waveform-data":"3.3.2","which":"2.0.2","winston":"3.2.1","xml2js":"0.4.23","yauzl":"2.10.0"},"devDependencies":{"@types/archiver":"3.1.0","@types/chance":"1.0.10","@types/cookie-parser":"1.4.2","@types/cors":"2.8.6","@types/d3":"5.7.2","@types/express":"4.17.6","@types/express-session":"1.17.0","@types/express-useragent":"1.0.0","@types/feedparser":"2.2.3","@types/fluent-ffmpeg":"2.1.14","@types/fs-extra":"8.1.0","@types/helmet":"0.0.46","@types/jest":"25.2.1","@types/jest-expect-message":"1.0.2","@types/mime-types":"2.1.0","@types/multer":"1.4.3","@types/mustache":"4.0.1","@types/nedb":"1.8.9","@types/nock":"11.1.0","@types/node":"13.13.5","@types/on-finished":"2.3.1","@types/passport":"1.0.3","@types/passport-jwt":"3.0.3","@types/passport-local":"1.0.33","@types/request":"2.48.4","@types/rimraf":"3.0.0","@types/seedrandom":"2.4.28","@types/sharp":"0.25.0","@types/supertest":"2.0.9","@types/svgo":"1.3.2","@types/tmp":"0.2.0","@types/which":"1.3.2","@types/xml2js":"0.4.5","@types/yauzl":"2.9.1","@typescript-eslint/eslint-plugin":"2.31.0","@typescript-eslint/parser":"2.31.0","chance":"1.1.4","concurrently":"5.2.0","conventional-changelog-cli":"2.0.31","copy-webpack-plugin":"5.1.1","jest":"25.5.4","jest-expect-message":"1.0.2","mustache":"4.0.1","nock":"12.0.3","nodemon":"2.0.3","redoc-cli":"0.9.7","rimraf":"3.0.2","source-map-support":"0.5.19","supertest":"4.0.2","ts-jest":"25.5.0","ts-loader":"7.0.3","ts-node":"8.10.1","typescript":"3.8.3","typescript-json-schema":"0.42.0","webpack":"4.43.0","webpack-cli":"3.3.11","webpack-filter-warnings-plugin":"1.2.1","webpack-node-externals":"1.7.2"},"engines":{"node":">= 11.0.0"}}')},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(181)),o=s(r(182)),c=s(r(3)),d=s(r(56)),u=r(57),l=r(17),m=r(4),p=r(39),f=r(2),y=r(15),h=r(184),g=f.logger("Images");d.default.cache(!1),d.default.simd(!1);t.ImageModule=class{constructor(e,t){this.imageCachePath=e,this.format="png",this.avatarPartsLocation=t||c.default.join(__dirname,"static","avatar"),this.cache=new p.IDFolderCache(e,"thumb",e=>`${void 0!==e.size?"-"+e.size:""}.${e.format||this.format}`)}storeImage(e,t,r){return i(this,void 0,void 0,(function*(){g.debug("Requesting image",r);const i=c.default.extname(r).split("?")[0].trim().toLowerCase();if(0===i.length)return Promise.reject(Error("Invalid Image Url"));let s=t+i,n=2;for(;yield a.default.pathExists(c.default.join(e,s));)s=`${t}-${n}${i}`,n++;return yield u.downloadFile(r,c.default.join(e,s)),g.info("image downloaded",s),s}))}paint(e,t,r){return i(this,void 0,void 0,(function*(){t=t||320;const i=new n.default(360,360,"#282828");this.font||(this.font=yield n.default.loadFont(n.default.FONT_SANS_32_WHITE)),i.print(this.font,10,10,{text:e,alignmentX:n.default.HORIZONTAL_ALIGN_CENTER,alignmentY:n.default.VERTICAL_ALIGN_MIDDLE},340,340),i.resize(t,t);const s=o.default.lookup(r||this.format);return s?{buffer:{buffer:yield i.getBufferAsync(s),contentType:s}}:Promise.reject("Unknown Image Format Request")}))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){if(!t)return{file:{filename:e,name:r}};let i=m.fileSuffix(e);return l.SupportedWriteImageFormat.includes(i)||(i=this.format),this.getImageAs(e,i,t,r)}))}getImageAs(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=m.fileSuffix(e);if(!(yield a.default.pathExists(e)))return Promise.reject(Error("File not found"));if(r||i!==t){const i=o.default.lookup(t);if(!i)return Promise.reject(`Unknown Image Format Request: ${t} ${e}`);const s=d.default(e,{failOnError:!1});return r&&s.resize(r,r,{fit:d.default.fit.cover,position:d.default.strategy.entropy}),s.toFormat(t),{buffer:{buffer:yield s.toBuffer(),contentType:i}}}return{file:{filename:e,name:s}}}))}getImageBufferAs(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.getImageInfoBuffer(e);t=t||i.format;const s=o.default.lookup(t);return s?r?{buffer:{buffer:yield d.default(e,{failOnError:!1}).resize(r,r,{fit:d.default.fit.cover}).toFormat(t).toBuffer(),contentType:s}}:t&&i.format!==t?{buffer:{buffer:yield d.default(e,{failOnError:!1}).toFormat(t).toBuffer(),contentType:s}}:{buffer:{buffer:e,contentType:o.default.lookup(i.format)||"image"}}:Promise.reject("Unknown Image Format Request: "+t)}))}getExisting(e,t,r){return i(this,void 0,void 0,(function*(){return this.cache.getExisting(e,{size:t,format:r})}))}getBuffer(e,t,r,s){return i(this,void 0,void 0,(function*(){return s&&!l.SupportedWriteImageFormat.includes(s)?Promise.reject(Error("Invalid Format")):this.cache.get(e,{size:r,format:s},e=>i(this,void 0,void 0,(function*(){const i=yield this.getImageBufferAs(t,s,r);if(!i.buffer)return Promise.reject(Error("Error while writing image cache file"));g.debug("Writing image cache file",e),yield a.default.writeFile(e,i.buffer.buffer)})))}))}get(e,t,r,s){return i(this,void 0,void 0,(function*(){return t?s&&!l.SupportedWriteImageFormat.includes(s)?Promise.reject(Error("Invalid Format")):(s&&s===this.format&&(s=void 0),s||r?this.cache.get(e,{size:r,format:s},e=>i(this,void 0,void 0,(function*(){const i=c.default.basename(e),n=s?yield this.getImageAs(t,s,r,i):yield this.getImage(t,r,i);n.buffer&&(g.debug("Writing image cache file",e),yield a.default.writeFile(e,n.buffer.buffer))}))):this.getImage(t,r,`${e}.${this.format}`)):Promise.reject(Error("Invalid Path"))}))}resizeImagePNG(e,t,r){return i(this,void 0,void 0,(function*(){yield d.default(e,{failOnError:!1}).resize(r,r,{fit:d.default.fit.cover}).png().toFile(t)}))}clearImageCacheByIDs(e){return i(this,void 0,void 0,(function*(){yield this.cache.removeByIDs(e)}))}createAvatar(e,t){return i(this,void 0,void 0,(function*(){if(!e)return Promise.reject(Error("Invalid Path"));if(!(yield a.default.pathExists(e)))return Promise.reject(Error("File not found"));const r=`${e}.new${y.randomString(8)}.png`;yield this.resizeImagePNG(e,r,300),yield m.fileDeleteIfExists(t),yield a.default.rename(r,t)}))}generateAvatar(e,t){return i(this,void 0,void 0,(function*(){const r=new h.AvatarGen(this.avatarPartsLocation),i=yield r.generate(e);yield a.default.writeFile(t,i)}))}formatImageInfo(e){return i(this,void 0,void 0,(function*(){try{const t=yield e.metadata();return{width:t.width||0,height:t.height||0,format:t.format||"",colorDepth:t.density||0,colors:0}}catch(e){return{width:0,height:0,format:"invalid",colorDepth:0,colors:0}}}))}getImageInfo(e){return i(this,void 0,void 0,(function*(){return this.formatImageInfo(d.default(e,{failOnError:!1}))}))}getImageInfoBuffer(e){return i(this,void 0,void 0,(function*(){return this.formatImageInfo(d.default(e,{failOnError:!1}))}))}}},function(e,t){e.exports=require("jimp")},function(e,t){e.exports=require("mime-types")},function(e,t){e.exports=require("http")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(185);t.AvatarGen=class{constructor(e){e&&(s.defaultAvatarSettings.partsLocation=e),this.avatar=new s.AvatarGenerator(s.defaultAvatarSettings)}generate(e){return i(this,void 0,void 0,(function*(){return(yield this.avatar.generate(e,"parts")).png().toBuffer()}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(25)),n=s(r(3)),o=s(r(186)),c=s(r(56));t.defaultAvatarSettings={parts:["background","face","clothes","head","hair","eye","mouth"],partsLocation:n.default.join(__dirname),imageExtension:".png"};class d{constructor(e={}){const r=Object.assign(Object.assign({},t.defaultAvatarSettings),e);this._variants=d.BuildVariantsMap(r),this._parts=r.parts}get variants(){return Object.keys(this._variants)}static BuildVariantsMap({parts:e,partsLocation:t,imageExtension:r}){const i=new RegExp(`(${e.join("|")})(\\d+)${r}`);return a.default.readdirSync(t).filter(e=>a.default.statSync(n.default.join(t,e)).isDirectory()).reduce((e,r)=>{const s=n.default.join(t,r);return e[r]=a.default.readdirSync(s).reduce((e,t)=>{const r=i.exec(t);if(r){const i=r[1];e[i]||(e[i]=[]),e[i][Number(r[2])]=n.default.join(s,t)}return e},{}),e},{})}getParts(e,t){const r=this._variants[t];if(!r)throw new Error(`variant '${t}' is not supported. Supported variants: ${Object.keys(this._variants)}`);const i=o.default(e);return this._parts.map(e=>{const t=r[e];return t&&t[Math.floor(i()*t.length)]}).filter(Boolean)}generate(e,t){return i(this,void 0,void 0,(function*(){const r=this.getParts(e,t);if(!r.length)throw new Error(`variant '${t}'does not contain any parts`);const{width:i,height:s}=yield c.default(r[0]).metadata();if(void 0===i||void 0===s)throw new Error("Invalid part file found");const a={raw:{width:i,height:s,channels:4}},n=r.shift();if(!n)throw new Error(`variant '${t}'does not contain any parts`);return c.default(n,a).composite(r.map(e=>({input:e})))}))}}t.AvatarGenerator=d},function(e,t){e.exports=require("seedrandom")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(13);class n extends a.BaseListService{constructor(e,t,r,i){super(e,i),this.albumStore=e,this.trackService=t,this.folderService=r}defaultSort(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}getAlbumFolder(e){return i(this,void 0,void 0,(function*(){if(0===e.folderIDs.length)return;if(1===e.folderIDs.length)return this.folderService.folderStore.byId(e.folderIDs[0]);const t=[],r=e=>i(this,void 0,void 0,(function*(){let r=yield this.folderService.collectFolderPath(e,t);if(0===r.length)return;r=r.sort((e,t)=>t.tag.level-e.tag.level);let i=r[0];for(const e of r){if(!s.FolderTypesAlbum.includes(e.tag.type))break;i=e}return i&&s.FolderTypesAlbum.includes(i.tag.type)?i:void 0}));for(const t of e.folderIDs){const e=yield r(t);if(e)return e}}))}getAlbumTrackImage(e,t,r){return i(this,void 0,void 0,(function*(){if(e.trackIDs.length>0){const i=yield this.trackService.trackStore.byId(e.trackIDs[0]);if(i)return this.trackService.getImage(i,t,r)}}))}getAlbumFolderImage(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.getAlbumFolder(e);if(i){const e=this.folderService.getImage(i,t,r);if(e)return e}}))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){let i;return e.seriesID&&(i=yield this.getAlbumTrackImage(e,t,r)),i||(i=yield this.getAlbumFolderImage(e,t,r)),i||(i=yield this.getAlbumTrackImage(e,t,r)),i}))}}t.AlbumService=n},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(27),n=r(13);class o extends n.BaseListService{constructor(e,t,r,i){super(e,i),this.artistStore=e,this.trackStore=t,this.folderService=r}defaultSort(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}canHaveArtistImage(e){return e.albumTypes.length>0&&e.mbArtistID!==s.MUSICBRAINZ_VARIOUS_ARTISTS_ID}getArtistFolder(e){return i(this,void 0,void 0,(function*(){if(0===e.folderIDs.length)return;const t=[],r=r=>i(this,void 0,void 0,(function*(){const i=yield this.folderService.collectFolderPath(r,t);if(0===i.length)return;const n=i.find(e=>e.tag.type===s.FolderType.artist);return n&&(n.tag.mbArtistID&&n.tag.mbArtistID===e.mbArtistID||n.tag.artist&&a.slugify(n.tag.artist)===e.slug)?n:void 0}));for(const t of e.folderIDs){const e=yield r(t);if(e)return e}}))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){if(this.canHaveArtistImage(e)){const i=yield this.getArtistFolder(e);if(i)return this.folderService.getImage(i,t,r)}return this.folderService.imageModule.paint(e.name,t,r)}))}}t.ArtistService=o},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(11);class n extends a.BaseStoreService{constructor(e){super(e),this.bookmarkStore=e}defaultSort(e){return e.sort((e,t)=>t.changed-e.changed)}byUser(e,t,r){return i(this,void 0,void 0,(function*(){return this.bookmarkStore.search({userID:e,amount:t,offset:r})}))}byTrack(e,t){return i(this,void 0,void 0,(function*(){return this.bookmarkStore.search({userID:t,destID:e})}))}create(e,t,r,a){return i(this,void 0,void 0,(function*(){let i=yield this.bookmarkStore.searchOne({destID:e,userID:t,position:r});return i?(i.comment=a,i.changed=Date.now(),yield this.bookmarkStore.replace(i)):(i={id:"",type:s.DBObjectType.bookmark,destID:e,userID:t,position:r,comment:a,created:Date.now(),changed:Date.now()},i.id=yield this.bookmarkStore.add(i)),i}))}remove(e,t){return i(this,void 0,void 0,(function*(){yield this.bookmarkStore.removeByQuery({id:e,userID:t})}))}removeByTrack(e,t){return i(this,void 0,void 0,(function*(){yield this.bookmarkStore.removeByQuery({destID:e,userID:t})}))}byID(e,t){return i(this,void 0,void 0,(function*(){return this.bookmarkStore.searchOne({id:e,userID:t})}))}byIDs(e,t,r,s){return i(this,void 0,void 0,(function*(){return this.bookmarkStore.search({ids:e,userID:t,amount:r,offset:s})}))}}t.BookmarkService=n},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(14));t.ChatService=class{constructor(){this.messages=[],this.duration=a.default.duration(0,"s"),this.chatConfig={maxMessages:0,maxAge:{value:0,unit:"s"}}}setSettings(e){this.chatConfig=e,this.duration=a.default.duration(this.chatConfig.maxAge.value,this.chatConfig.maxAge.unit)}cleanOld(){return i(this,void 0,void 0,(function*(){const e=a.default().subtract(this.duration).valueOf();this.messages=this.messages.filter(t=>e<t.time)}))}find(e){return i(this,void 0,void 0,(function*(){return this.messages.find(t=>t.time===e)}))}remove(e){return i(this,void 0,void 0,(function*(){this.messages=this.messages.filter(t=>t.time!==e.time)}))}get(e){return i(this,void 0,void 0,(function*(){yield this.cleanOld();let t=this.messages;return void 0===e||isNaN(e)||(t=t.filter(t=>t.time>e)),t}))}add(e,t){return i(this,void 0,void 0,(function*(){yield this.cleanOld();const r={message:e,time:Date.now(),username:t.name,userID:t.id};return this.messages.push(r),this.messages.length>this.chatConfig.maxMessages&&this.messages.shift(),r}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(5),o=r(0),c=r(192),d=r(194);t.DownloadService=class{constructor(e,t){this.trackStore=e,this.episodeStore=t}downloadEpisode(e,t){return i(this,void 0,void 0,(function*(){return e.path?{pipe:new d.CompressListStream([e.path],a.default.basename(e.path),t)}:Promise.reject(Error("Podcast episode not ready"))}))}downloadTrack(e,t){return i(this,void 0,void 0,(function*(){return{pipe:new d.CompressListStream([a.default.join(e.path,e.name)],a.default.basename(e.name),t)}}))}downloadFolder(e,t){return i(this,void 0,void 0,(function*(){return{pipe:new c.CompressFolderStream(e.path,a.default.basename(e.path),t)}}))}downloadArtist(e,t){return i(this,void 0,void 0,(function*(){const r=(yield this.trackStore.byIds(e.trackIDs)).map(e=>a.default.join(e.path,e.name));return{pipe:new d.CompressListStream(r,e.name,t)}}))}downloadSeries(e,t){return i(this,void 0,void 0,(function*(){const r=(yield this.trackStore.byIds(e.trackIDs)).map(e=>a.default.join(e.path,e.name));return{pipe:new d.CompressListStream(r,e.name,t)}}))}downloadAlbum(e,t){return i(this,void 0,void 0,(function*(){const r=(yield this.trackStore.byIds(e.trackIDs)).map(e=>a.default.join(e.path,e.name));return{pipe:new d.CompressListStream(r,e.name,t)}}))}downloadPodcast(e,t){return i(this,void 0,void 0,(function*(){const r=(yield this.episodeStore.search({podcastID:e.id})).items.filter(e=>!!e.path).map(e=>e.path);return{pipe:new d.CompressListStream(r,e.id,t)}}))}downloadPlaylist(e,t,r){return i(this,void 0,void 0,(function*(){if(e.userID!==r.id&&!e.isPublic)return Promise.reject(Error(n.Errors.unauthorized));const i=(yield this.trackStore.byIds(e.trackIDs)).map(e=>a.default.join(e.path,e.name));return{pipe:new d.CompressListStream(i,e.name,t)}}))}getObjDownload(e,t,r){return i(this,void 0,void 0,(function*(){switch(e.type){case o.DBObjectType.track:return this.downloadTrack(e,t);case o.DBObjectType.folder:return this.downloadFolder(e,t);case o.DBObjectType.artist:return this.downloadArtist(e,t);case o.DBObjectType.series:return this.downloadSeries(e,t);case o.DBObjectType.album:return this.downloadAlbum(e,t);case o.DBObjectType.episode:return this.downloadEpisode(e,t);case o.DBObjectType.podcast:return this.downloadPodcast(e,t);case o.DBObjectType.playlist:return this.downloadPlaylist(e,t,r)}return Promise.reject(Error("Invalid Download Type"))}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(58);class s extends i.BaseCompressStream{constructor(e,t,r){super(t,r),this.folder=e}run(e){e.directory(this.folder,!1)}}t.CompressFolderStream=s},function(e,t){e.exports=require("archiver")},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(3)),a=r(58);class n extends a.BaseCompressStream{constructor(e,t,r){super(t,r),this.list=[],this.list=e}run(e){this.list.forEach(t=>{e.file(t,{name:s.default.basename(t)})})}}t.CompressListStream=n},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(1),c=r(26),d=r(57),u=r(17),l=r(4),m=r(2),p=r(13),f=m.logger("EpisodeService");class y extends p.BaseListService{constructor(e,t,r,i,s){super(t,r),this.podcastsPath=e,this.episodeStore=t,this.audioModule=i,this.imageModule=s,this.episodeDownloadDebounce=new c.DebouncePromises}defaultSort(e){return e.sort((e,t)=>{if(!e.tag)return-1;if(!t.tag)return 1;if(void 0!==e.tag.track&&void 0!==t.tag.track){const r=e.tag.track-t.tag.track;if(0!==r)return r}return t.date-e.date})}isDownloading(e){return this.episodeDownloadDebounce.isPending(e)}downloadEpisodeFile(e){return i(this,void 0,void 0,(function*(){let t="";if(!(e.enclosures&&e.enclosures.length>0))throw new Error("No podcast episode url found");t=e.enclosures[0].url;let r=l.fileSuffix(t);if(r.includes("?")&&(r=r.slice(0,r.indexOf("?"))),!u.SupportedAudioFormat.includes(r))throw new Error("Unsupported Podcast audio format ."+r);const i=n.default.resolve(this.podcastsPath,e.podcastID);yield a.default.ensureDir(i);const s=n.default.join(i,`${e.id}.${r}`);return f.info("retrieving file",t),yield d.downloadFile(t,s),s}))}downloadEpisode(e){return i(this,void 0,void 0,(function*(){if(this.episodeDownloadDebounce.isPending(e.id))return this.episodeDownloadDebounce.append(e.id);this.episodeDownloadDebounce.setPending(e.id);try{try{const t=yield this.downloadEpisodeFile(e),r=yield a.default.stat(t),i=yield this.audioModule.read(t);e.status=o.PodcastStatus.completed,e.tag=i.tag,e.media=i.media,e.stat={created:r.ctime.valueOf(),modified:r.mtime.valueOf(),size:r.size},e.path=t}catch(t){e.status=o.PodcastStatus.error,e.error=(t||"").toString()}yield this.episodeStore.replace(e),this.episodeDownloadDebounce.resolve(e.id,void 0)}catch(t){return this.episodeDownloadDebounce.resolve(e.id,void 0),Promise.reject(t)}}))}removeEpisodes(e){return i(this,void 0,void 0,(function*(){const t=yield this.episodeStore.search({podcastID:e}),r=t.items.map(e=>e.id);yield this.episodeStore.remove(r);for(const e of t.items)e.path&&(yield l.fileDeleteIfExists(e.path))}))}deleteEpisode(e){return i(this,void 0,void 0,(function*(){e.path&&(yield l.fileDeleteIfExists(e.path),e.path=void 0,e.stat=void 0,e.media=void 0,e.status=o.PodcastStatus.deleted,yield this.episodeStore.replace(e))}))}mergeEpisodes(e,t,r){return i(this,void 0,void 0,(function*(){if(!r||!r.length)return[];const i=[],s=[],a=yield this.episodeStore.search({podcastID:e});for(const e of r){const r=a.items.find(t=>t.guid===e.guid);r?(r.podcast=t,r.duration=e.duration,r.chapters=e.chapters,r.date=e.date,r.summary=e.summary,r.name=e.name,r.guid=e.guid,r.author=e.author,r.enclosures=e.enclosures,i.push(r)):(e.podcast=t,i.push(e),s.push(e))}return yield this.episodeStore.upsert(i),s}))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){if(e.tag&&e.tag.nrTagImages&&e.path){const i=yield this.imageModule.getExisting(e.id,t,r);if(i)return i;try{const i=yield this.audioModule.extractTagImage(e.path);if(i)return yield this.imageModule.getBuffer(e.id,i,t,r)}catch(t){f.error("getImage","Extracting image from audio failed: "+e.path)}}}))}countEpisodes(e){return i(this,void 0,void 0,(function*(){return this.store.searchCount({podcastID:e})}))}}t.EpisodeService=y},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.GenreService=class{constructor(e){this.trackStore=e,this.genres=[]}refresh(){return i(this,void 0,void 0,(function*(){const e={};yield this.trackStore.iterate(t=>i(this,void 0,void 0,(function*(){for(const r of t){const t=r.tag.genre||"[No genre]",i=e[t]||{roots:{}},s=i.roots[r.rootID]||{count:0,artists:{},albums:{}};s.count++,r.artistID&&(s.artists[r.artistID]=(s.artists[r.artistID]||0)+1),r.albumID&&(s.albums[r.albumID]=(s.albums[r.albumID]||0)+1),i.roots[r.rootID]=s,e[t]=i}}))),this.genres=Object.keys(e).map(t=>{const r=e[t];return{name:t,sections:Object.keys(r.roots).map(e=>{const t=r.roots[e];return{rootID:e,artistCount:Object.keys(t.artists).length,albumCount:Object.keys(t.albums).length,trackCount:t.count}})}})}))}getGenres(e){return i(this,void 0,void 0,(function*(){return 0===this.genres.length&&(yield this.refresh()),this.genres.map(t=>{const r={name:t.name,albumCount:0,artistCount:0,trackCount:0};return t.sections.forEach(t=>{e&&t.rootID!==e||(r.albumCount+=t.albumCount,r.artistCount+=t.artistCount,r.trackCount+=t.trackCount)}),r}).filter(e=>e.trackCount>0).sort((e,t)=>e.name.localeCompare(t.name))}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(0),o=r(1);class c{constructor(e,t,r,i,s,a,n,o,c){this.imageModule=e,this.trackService=t,this.folderService=r,this.artistService=i,this.albumService=s,this.userService=a,this.podcastService=n,this.episodeService=o,this.seriesService=c}static getCoverArtTextFolder(e){let t;return e.tag&&(e.tag.type===o.FolderType.artist?t=e.tag.artist:[o.FolderType.multialbum,o.FolderType.album].includes(e.tag.type)&&(t=e.tag.album)),t&&0!==t.length||(t=a.default.basename(e.path)),t}static getCoverArtTextEpisode(e){let t=e.tag?e.tag.title:void 0;return!t&&e.path&&(t=a.default.basename(e.path)),t||(t=e.name),t||(t="Podcast Episode"),t}static getCoverArtTextTrack(e){return e.tag&&e.tag.title?e.tag.title:a.default.basename(e.path)}static getCoverArtTextPodcast(e){return e.tag?e.tag.title:e.url}getCoverArtText(e){switch(e.type){case n.DBObjectType.track:return c.getCoverArtTextTrack(e);case n.DBObjectType.folder:return c.getCoverArtTextFolder(e);case n.DBObjectType.episode:return c.getCoverArtTextEpisode(e);case n.DBObjectType.playlist:case n.DBObjectType.series:return e.name;case n.DBObjectType.podcast:return c.getCoverArtTextPodcast(e);case n.DBObjectType.album:case n.DBObjectType.artist:case n.DBObjectType.user:case n.DBObjectType.root:return e.name;default:return n.DBObjectType[e.type]}}getObjImage(e,t,r){return i(this,void 0,void 0,(function*(){let i;switch(e.type){case n.DBObjectType.track:i=yield this.trackService.getImage(e,t,r);break;case n.DBObjectType.folder:i=yield this.folderService.getImage(e,t,r);break;case n.DBObjectType.artist:i=yield this.artistService.getImage(e,t,r);break;case n.DBObjectType.album:i=yield this.albumService.getImage(e,t,r);break;case n.DBObjectType.user:i=yield this.userService.getImage(e,t,r);break;case n.DBObjectType.podcast:i=yield this.podcastService.getImage(e,t,r);break;case n.DBObjectType.episode:i=yield this.podcastService.getEpisodeImage(e,t,r);break;case n.DBObjectType.series:i=yield this.seriesService.getImage(e,t,r);break;case n.DBObjectType.root:{const s=yield this.folderService.folderStore.searchOne({rootID:e.id,level:0});s&&(i=yield this.folderService.getImage(s,t,r));break}}return i||this.paintImage(e,t,r)}))}paintImage(e,t,r){return i(this,void 0,void 0,(function*(){const i=this.getCoverArtText(e);return this.imageModule.paint(i,t||128,r)}))}}t.ImageService=c},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(26),n=r(199);t.IndexService=class{constructor(e,t,r,i,s){this.artistStore=e,this.albumStore=t,this.folderStore=r,this.trackStore=i,this.seriesStore=s,this.cached={folder:{},artist:{},series:{},album:{}},this.indexCacheFolderDebounce=new a.DebouncePromises,this.indexCacheArtistDebounce=new a.DebouncePromises,this.indexCacheSeriesDebounce=new a.DebouncePromises,this.indexCacheAlbumDebounce=new a.DebouncePromises,this.indexConfig={ignoreArticles:[]}}clearCache(){this.cached={folder:{},artist:{},series:{},album:{}}}setSettings(e){this.indexConfig=e,this.clearCache()}getFolderIndex(e){return i(this,void 0,void 0,(function*(){const t=JSON.stringify(e);if(this.cached.folder[t])return this.cached.folder[t];if(this.indexCacheFolderDebounce.isPending(t))return this.indexCacheFolderDebounce.append(t);this.indexCacheFolderDebounce.setPending(t);try{const r=new n.IndexFolderTreeBuilder(this.indexConfig,this.folderStore,this.trackStore),i=yield r.buildFolderIndex(e);return this.indexCacheFolderDebounce.resolve(t,i),this.cached.folder[t]=i,i}catch(e){return this.indexCacheFolderDebounce.reject(t,e),Promise.reject(e)}}))}getArtistIndex(e){return i(this,void 0,void 0,(function*(){const t=JSON.stringify(e);if(this.cached.artist[t])return this.cached.artist[t];if(this.indexCacheArtistDebounce.isPending(t))return this.indexCacheArtistDebounce.append(t);this.indexCacheArtistDebounce.setPending(t);try{const r=new n.IndexArtistTreeBuilder(this.indexConfig,this.artistStore),i=yield r.buildArtistIndex(e);return this.indexCacheArtistDebounce.resolve(t,i),this.cached.artist[t]=i,i}catch(e){return this.indexCacheArtistDebounce.reject(t,e),Promise.reject(e)}}))}getSeriesIndex(e){return i(this,void 0,void 0,(function*(){const t=JSON.stringify(e);if(this.cached.series[t])return this.cached.series[t];if(this.indexCacheSeriesDebounce.isPending(t))return this.indexCacheSeriesDebounce.append(t);this.indexCacheSeriesDebounce.setPending(t);try{const r=new n.IndexSeriesTreeBuilder(this.indexConfig,this.seriesStore),i=yield r.buildSeriesIndex(e);return this.indexCacheSeriesDebounce.resolve(t,i),this.cached.series[t]=i,i}catch(e){return this.indexCacheSeriesDebounce.reject(t,e),Promise.reject(e)}}))}getAlbumIndex(e){return i(this,void 0,void 0,(function*(){const t=JSON.stringify(e);if(this.cached.album[t])return this.cached.album[t];if(this.indexCacheAlbumDebounce.isPending(t))return this.indexCacheAlbumDebounce.append(t);this.indexCacheAlbumDebounce.setPending(t);try{const r=new n.IndexAlbumTreeBuilder(this.indexConfig,this.albumStore),i=yield r.buildAlbumIndex(e);return this.indexCacheAlbumDebounce.resolve(t,i),this.cached.album[t]=i,i}catch(e){return this.indexCacheAlbumDebounce.reject(t,e),Promise.reject(e)}}))}buildDefaultIndexes(){return i(this,void 0,void 0,(function*(){this.clearCache(),yield this.getFolderIndex({level:1}),yield this.getArtistIndex({albumType:s.AlbumType.album})}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3));class n{constructor(e){this.ignore=e.ignoreArticles.join("|")}removeArticles(e){const t=new RegExp(`^(?:(?:${this.ignore})\\s+)?(.*)`,"gi").exec(e);return t?t[1]:e}getIndexChar(e){const t=e.replace(/[¿…¡?[\]{}<>‘`“'&_~=:./;@#«!%$*()+\-\\|]/g,"").trim();if(0===t.length)return"#";const r=t.charAt(0).toUpperCase();return isNaN(Number(r))?r:"#"}}t.IndexTreeBuilder=n;t.IndexFolderTreeBuilder=class extends n{constructor(e,t,r){super(e),this.folderStore=t,this.trackStore=r}getTotalTrackCount(e){return i(this,void 0,void 0,(function*(){return this.trackStore.searchCount({inPath:e.path})}))}buildFolderIndex(e){return i(this,void 0,void 0,(function*(){const t={groups:[],lastModified:Date.now()},r=yield this.folderStore.search(e);for(const e of r.items){const r=yield this.getTotalTrackCount(e),i={name:a.default.basename(e.path),nameSort:e.tag.artistSort||this.removeArticles(a.default.basename(e.path)),trackCount:r||0,folder:e},s=this.getIndexChar(i.nameSort);let n=t.groups.find(e=>e.name===s);n||(n={name:s,entries:[]},t.groups.push(n)),n.entries.push(i)}return t.groups.forEach(e=>{e.entries.sort((e,t)=>e.nameSort.localeCompare(t.nameSort))}),t.groups.sort((e,t)=>e.name.localeCompare(t.name)),t}))}};t.IndexArtistTreeBuilder=class extends n{constructor(e,t){super(e),this.artistStore=t}buildArtistIndex(e){return i(this,void 0,void 0,(function*(){const t={groups:[],lastModified:Date.now()};return(yield this.artistStore.search(e)).items.forEach(e=>{const r={artist:e},i=this.getIndexChar(e.nameSort||this.removeArticles(e.name)||"");let s=t.groups.find(e=>e.name===i);s||(s={name:i,entries:[]},t.groups.push(s)),s.entries.push(r)}),t.groups.forEach(e=>{e.entries=e.entries.sort((e,t)=>(e.artist.nameSort||this.removeArticles(e.artist.name)).localeCompare(t.artist.nameSort||this.removeArticles(t.artist.name)))}),t.groups=t.groups.sort((e,t)=>e.name.localeCompare(t.name)),t}))}};t.IndexSeriesTreeBuilder=class extends n{constructor(e,t){super(e),this.seriesStore=t}buildSeriesIndex(e){return i(this,void 0,void 0,(function*(){const t={groups:[],lastModified:Date.now()};return(yield this.seriesStore.search(e)).items.forEach(e=>{const r={series:e},i=this.getIndexChar(this.removeArticles(e.name)||"");let s=t.groups.find(e=>e.name===i);s||(s={name:i,entries:[]},t.groups.push(s)),s.entries.push(r)}),t.groups.forEach(e=>{e.entries=e.entries.sort((e,t)=>this.removeArticles(e.series.name).localeCompare(this.removeArticles(t.series.name)))}),t.groups=t.groups.sort((e,t)=>e.name.localeCompare(t.name)),t}))}};t.IndexAlbumTreeBuilder=class extends n{constructor(e,t){super(e),this.albumStore=t}buildAlbumIndex(e){return i(this,void 0,void 0,(function*(){const t={groups:[],lastModified:Date.now()};return(yield this.albumStore.search(e)).items.forEach(e=>{const r={album:e},i=this.getIndexChar(e.name);let s=t.groups.find(e=>e.name===i);s||(s={name:i,entries:[]},t.groups.push(s)),s.entries.push(r)}),t.groups.forEach(e=>{e.entries.sort((e,t)=>e.album.name.localeCompare(t.album.name))}),t.groups.sort((e,t)=>e.name.localeCompare(t.name)),t}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),a=r(201),n=s.logger("IO");var o;!function(e){e[e.refreshRoot=0]="refreshRoot",e[e.removeRoot=1]="removeRoot",e[e.updateRoot=2]="updateRoot",e[e.createRoot=3]="createRoot",e[e.fixTrack=4]="fixTrack",e[e.moveTracks=5]="moveTracks",e[e.removeTracks=6]="removeTracks",e[e.renameTrack=7]="renameTrack",e[e.writeTrackTags=8]="writeTrackTags",e[e.createFolder=9]="createFolder",e[e.deleteFolders=10]="deleteFolders",e[e.moveFolders=11]="moveFolders",e[e.renameFolder=12]="renameFolder",e[e.deleteArtwork=13]="deleteArtwork",e[e.downloadArtwork=14]="downloadArtwork",e[e.updateArtwork=15]="updateArtwork",e[e.createArtwork=16]="createArtwork",e[e.renameArtwork=17]="renameArtwork"}(o=t.WorkerRequestMode||(t.WorkerRequestMode={}));class c{constructor(e,t,r,i){this.id=e,this.mode=t,this.execute=r,this.parameters=i}run(){return i(this,void 0,void 0,(function*(){try{return yield this.execute(this.parameters)}catch(e){return console.error(e.stack),["EACCES","ENOENT"].includes(e.code)?Promise.reject(Error("Directory not found/no access/error in filesystem")):Promise.reject(e)}}))}}t.IoService=class{constructor(e,t,r){this.rootStore=e,this.workerService=t,this.onRefresh=r,this.scanning=!1,this.rootstatus=new Map,this.queue=[],this.delayedTrackTagWrite=new Map,this.delayedTrackFix=new Map,this.nextID=Date.now(),this.history=[]}generateRequestID(){return this.nextID+=1,this.nextID.toString()}runRequest(e){return i(this,void 0,void 0,(function*(){this.clearAfterRefresh(),this.rootstatus.set(e.parameters.rootID,{lastScan:Date.now(),scanning:!0});try{this.current=e;const t=yield e.run();a.logChanges(t),this.rootstatus.set(e.parameters.rootID,{lastScan:Date.now()}),this.history.push({id:e.id,date:Date.now()}),this.current=void 0}catch(t){this.current=void 0;let r=t.toString();r.startsWith("Error:")&&(r=r.slice(6).trim()),this.rootstatus.set(e.parameters.rootID,{lastScan:Date.now(),error:r}),this.history.push({id:e.id,error:r,date:Date.now()})}0===this.queue.length&&this.runAfterRefresh()}))}runAfterRefresh(){this.clearAfterRefresh(),this.afterScanTimeout=setTimeout(()=>{this.clearAfterRefresh(),this.onRefresh().catch(e=>{console.error(e)})},1e4)}clearAfterRefresh(){this.afterScanTimeout&&clearTimeout(this.afterScanTimeout),this.afterScanTimeout=void 0}findRequest(e,t){return this.queue.find(r=>!!r.parameters.rootID&&r.parameters.rootID===e&&r.mode===t)}next(){return i(this,void 0,void 0,(function*(){const e=this.queue.shift();e&&(yield this.runRequest(e),yield this.next())}))}run(){this.scanning||(this.scanning=!0,n.info("Start Processing"),this.next().then(()=>{this.scanning=!1,n.info("Stop Processing")}).catch(e=>{this.scanning=!1,n.info("Stop Processing"),n.error(e)}))}addRequest(e){return this.queue.push(e),this.run(),this.getRequestInfo(e)}getRequestInfo(e){const t=this.queue.indexOf(e);return{id:e.id,pos:t>=0?t:void 0}}newRequest(e,t,r){return this.addRequest(new c(this.generateRequestID(),e,t,r))}getAdminChangeQueueInfoStatus(e){if(this.current&&this.current.id===e)return{id:e};const t=this.queue.find(t=>t.id===e);if(t){const r=this.queue.indexOf(t);return{id:e,pos:r>=0?r:void 0}}const r=this.history.find(t=>t.id===e);if(r)return{id:e,error:r.error,done:r.date};for(const t of this.delayedTrackTagWrite)if(t[1].request.id===e)return{id:e};for(const t of this.delayedTrackFix)if(t[1].request.id===e)return{id:e};return{id:e,error:"ID not found",done:Date.now()}}getRootStatus(e){let t=this.rootstatus.get(e);if(t||(t={lastScan:Date.now()}),!t.scanning){const r=this.queue.find(t=>t.parameters.rootID===e);t.scanning=!!r}return t}refresh(e){return i(this,void 0,void 0,(function*(){const t=yield this.rootStore.allIds(),r=[];for(const i of t)r.push(yield this.refreshRoot(i,e));return r}))}refreshRoot(e,t){return i(this,void 0,void 0,(function*(){const r=this.findRequest(e,o.refreshRoot);return r?(t&&(r.parameters.forceMetaRefresh=!0),this.getRequestInfo(r)):this.newRequest(o.refreshRoot,e=>this.workerService.refreshRoot(e),{rootID:e,forceMetaRefresh:!!t})}))}removeRoot(e){return i(this,void 0,void 0,(function*(){const t=this.findRequest(e,o.removeRoot);return t?this.getRequestInfo(t):this.newRequest(o.removeRoot,e=>this.workerService.removeRoot(e),{rootID:e})}))}moveFolders(e,t,r){return i(this,void 0,void 0,(function*(){const i=this.queue.find(e=>!!e.parameters.rootID&&e.parameters.rootID===r&&e.mode===o.moveFolders&&e.parameters.newParentID===t);if(i){for(const t of e)i.parameters.folderIDs.includes(t)||i.parameters.folderIDs.push(t);return this.getRequestInfo(i)}return this.newRequest(o.moveFolders,e=>this.workerService.moveFolders(e),{rootID:r,newParentID:t,folderIDs:e})}))}deleteFolder(e,t){return i(this,void 0,void 0,(function*(){const r=this.findRequest(t,o.deleteFolders);return r?(r.parameters.folderIDs.includes(e)||r.parameters.folderIDs.push(e),this.getRequestInfo(r)):this.newRequest(o.deleteFolders,e=>this.workerService.deleteFolders(e),{rootID:t,folderIDs:[e]})}))}renameArtwork(e,t,r,s){return i(this,void 0,void 0,(function*(){return this.newRequest(o.renameArtwork,e=>this.workerService.renameArtwork(e),{rootID:s,folderID:e,artworkID:t,name:r})}))}updateArtwork(e,t,r,s,a){return i(this,void 0,void 0,(function*(){return this.newRequest(o.updateArtwork,e=>this.workerService.updateArtwork(e),{rootID:a,folderID:e,artworkID:t,artworkFilename:r,artworkMimeType:s})}))}createArtwork(e,t,r,s,a){return i(this,void 0,void 0,(function*(){return this.newRequest(o.createArtwork,e=>this.workerService.createArtwork(e),{rootID:a,folderID:e,artworkFilename:t,artworkMimeType:r,types:s})}))}downloadArtwork(e,t,r,s){return i(this,void 0,void 0,(function*(){return this.newRequest(o.downloadArtwork,e=>this.workerService.downloadArtwork(e),{rootID:s,folderID:e,artworkURL:t,types:r})}))}deleteArtwork(e,t,r){return i(this,void 0,void 0,(function*(){return this.newRequest(o.deleteArtwork,e=>this.workerService.deleteArtwork(e),{rootID:r,folderID:e,artworkID:t})}))}removeTrack(e,t){return i(this,void 0,void 0,(function*(){const r=this.findRequest(t,o.removeTracks);return r?(r.parameters.trackIDs.includes(e)||r.parameters.trackIDs.push(e),this.getRequestInfo(r)):this.newRequest(o.removeTracks,e=>this.workerService.removeTracks(e),{rootID:t,trackIDs:[e]})}))}moveTracks(e,t,r){return i(this,void 0,void 0,(function*(){const i=this.queue.find(e=>!!e.parameters.rootID&&e.parameters.rootID===r&&e.mode===o.moveTracks&&e.parameters.newParentID===t);if(i){for(const t of e)i.parameters.trackIDs.includes(t)||i.parameters.trackIDs.push(t);return this.getRequestInfo(i)}return this.newRequest(o.moveTracks,e=>this.workerService.moveTracks(e),{rootID:r,trackIDs:e,newParentID:t})}))}renameTrack(e,t,r){return i(this,void 0,void 0,(function*(){return this.newRequest(o.renameTrack,e=>this.workerService.renameTrack(e),{rootID:r,trackID:e,newName:t})}))}writeRawTag(e,t,r){return i(this,void 0,void 0,(function*(){const i=this.findRequest(r,o.writeTrackTags);if(i)return i.parameters.tags.push({trackID:e,tag:t}),this.getRequestInfo(i);let s=this.delayedTrackTagWrite.get(r);return s?(s.timeout&&clearTimeout(s.timeout),s.request.parameters.tags.push({trackID:e,tag:t})):(s={request:new c(this.generateRequestID(),o.writeTrackTags,e=>this.workerService.writeTrackTags(e),{rootID:r,tags:[{trackID:e,tag:t}]}),timeout:void 0},this.delayedTrackTagWrite.set(r,s)),s.timeout=setTimeout(()=>{this.delayedTrackTagWrite.delete(r),s&&this.addRequest(s.request)},1e4),this.getRequestInfo(s.request)}))}fixTrack(e,t,r){return i(this,void 0,void 0,(function*(){const i=this.findRequest(r,o.fixTrack);if(i)return i.parameters.fixes.push({trackID:e,fixID:t}),this.getRequestInfo(i);let s=this.delayedTrackFix.get(r);return s?(s.timeout&&clearTimeout(s.timeout),s.request.parameters.fixes.push({trackID:e,fixID:t})):(s={request:new c(this.generateRequestID(),o.fixTrack,e=>this.workerService.fixTracks(e),{rootID:r,fixes:[{trackID:e,fixID:t}]}),timeout:void 0},this.delayedTrackFix.set(r,s)),s.timeout=setTimeout(()=>{this.delayedTrackFix.delete(r),s&&this.addRequest(s.request)},1e4),this.getRequestInfo(s.request)}))}renameFolder(e,t,r){return i(this,void 0,void 0,(function*(){return this.newRequest(o.renameFolder,e=>this.workerService.renameFolder(e),{rootID:r,folderID:e,newName:t})}))}newFolder(e,t,r){return i(this,void 0,void 0,(function*(){return this.newRequest(o.createFolder,e=>this.workerService.createFolder(e),{rootID:r,parentID:e,name:t})}))}updateRoot(e,t,r,s){return i(this,void 0,void 0,(function*(){return this.newRequest(o.updateRoot,e=>this.workerService.updateRoot(e),{rootID:e,name:t,path:r,strategy:s})}))}createRoot(e,t,r){return i(this,void 0,void 0,(function*(){return this.newRequest(o.createRoot,e=>this.workerService.createRoot(e),{rootID:"",name:e,path:t,strategy:r})}))}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(14)),a=r(2).logger("IO");t.logChanges=function(e){function t(e,t){t.length>0&&a.info(e,t.length)}const r=s.default.utc(e.end-e.start).format("HH:mm:ss.SSS");a.info("Duration:",r),t("Added Tracks",e.newTracks),t("Updated Tracks",e.updateTracks),t("Removed Tracks",e.removedTracks),t("Added Folders",e.newFolders),t("Updated Folders",e.updateFolders),t("Removed Folders",e.removedFolders),t("Added Artists",e.newArtists),t("Updated Artists",e.updateArtists),t("Removed Artists",e.removedArtists),t("Added Albums",e.newAlbums),t("Updated Albums",e.updateAlbums),t("Removed Albums",e.removedAlbums),t("Added Series",e.newSeries),t("Updated Series",e.updateSeries),t("Removed Series",e.removedSeries)}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(14)),n=s(r(3)),o=r(0),c=r(1),d=r(2),u=r(11),l=r(203),m=r(205),p=r(206),f=r(207),y=r(208),h=d.logger("Metadata");class g extends u.BaseStoreService{constructor(e,t,r,i,s,a){super(e),this.metadataStore=e,this.folderStore=t,this.trackStore=r,this.albumStore=i,this.artistStore=s,this.audioModule=a,this.extInfo=new l.MetadataServiceExtendedInfo(this),this.similarArtists=new m.MetadataServiceSimilarArtists(this,t,s),this.similarTracks=new p.MetadataServiceSimilarTracks(this,r),this.topTracks=new f.MetadataServiceTopTracks(this)}defaultSort(e){return e}addToStore(e,t,r){return i(this,void 0,void 0,(function*(){yield this.metadataStore.add({id:"",name:e,type:o.DBObjectType.metadata,dataType:t,data:r,date:Date.now()})}))}cleanUp(){return i(this,void 0,void 0,(function*(){const e=Date.now()-a.default.duration(1,"d").asMilliseconds(),t=yield this.metadataStore.removeByQuery({olderThan:e});t>0&&h.info(`Removed meta data cache entries: ${t} `)}))}clear(){return i(this,void 0,void 0,(function*(){const e=yield this.metadataStore.allIds();yield this.metadataStore.remove(e)}))}searchInStore(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.metadataStore.searchOne({name:e,dataType:t});if(i)return i.data;const s=yield r();return yield this.addToStore(e,t,s),s}))}musicbrainzSearch(e,t){return i(this,void 0,void 0,(function*(){return this.searchInStore(`search-${e}${JSON.stringify(t)}`,y.MetaDataType.musicbrainz,()=>i(this,void 0,void 0,(function*(){return this.audioModule.musicbrainz.search({type:e,query:t})})))}))}acoustidLookupTrack(e,t){return i(this,void 0,void 0,(function*(){return this.audioModule.acoustid.acoustid(n.default.join(e.path,e.name),t)}))}lastFMLookup(e,t){return i(this,void 0,void 0,(function*(){return this.searchInStore(`lookup-${e}${t}`,y.MetaDataType.lastfm,()=>i(this,void 0,void 0,(function*(){return this.audioModule.lastFM.lookup(e,t)})))}))}lastFMAlbumSearch(e,t){return i(this,void 0,void 0,(function*(){return this.searchInStore(`search-album-${e}//${t}`,y.MetaDataType.lastfm,()=>i(this,void 0,void 0,(function*(){return{album:yield this.audioModule.lastFM.album(e,t)}})))}))}lastFMArtistSearch(e){return i(this,void 0,void 0,(function*(){return this.searchInStore("search-artist-"+e,y.MetaDataType.lastfm,()=>i(this,void 0,void 0,(function*(){return{artist:yield this.audioModule.lastFM.artist(e)}})))}))}lastFMTopTracksArtist(e){return i(this,void 0,void 0,(function*(){return this.searchInStore("toptracks-artist-"+e,y.MetaDataType.lastfm,()=>i(this,void 0,void 0,(function*(){return{toptracks:yield this.audioModule.lastFM.topArtistSongs(e)}})))}))}lastFMTopTracksArtistID(e){return i(this,void 0,void 0,(function*(){return this.searchInStore("toptracks-artistid-"+e,y.MetaDataType.lastfm,()=>i(this,void 0,void 0,(function*(){return{toptracks:yield this.audioModule.lastFM.topArtistSongsID(e)}})))}))}lastFMSimilarTracks(e){return i(this,void 0,void 0,(function*(){return this.searchInStore("similar-trackid-"+e,y.MetaDataType.lastfm,()=>i(this,void 0,void 0,(function*(){return{similartracks:yield this.audioModule.lastFM.similarTrackID(e)}})))}))}acousticbrainzLookup(e,t){return i(this,void 0,void 0,(function*(){return this.searchInStore(`lookup-${e}${void 0!==t?"-"+t:""}`,y.MetaDataType.acousticbrainz,()=>i(this,void 0,void 0,(function*(){return this.audioModule.acousticbrainz.highLevel(e,t)})))}))}coverartarchiveLookup(e,t){return i(this,void 0,void 0,(function*(){return this.searchInStore(`lookup-${e}${t}`,y.MetaDataType.coverartarchive,()=>i(this,void 0,void 0,(function*(){return e===c.CoverArtArchiveLookupType.release?this.audioModule.coverArtArchive.releaseImages(t):e===c.CoverArtArchiveLookupType.releaseGroup?this.audioModule.coverArtArchive.releaseGroupImages(t):Promise.reject(Error("Invalid CoverArtArchive Lookup Type"))})))}))}musicbrainzLookup(e,t,r){return i(this,void 0,void 0,(function*(){return this.searchInStore(`lookup-${e}${t}${r||""}`,y.MetaDataType.musicbrainz,()=>i(this,void 0,void 0,(function*(){return this.audioModule.musicbrainz.lookup({type:e,id:t,inc:r})})))}))}lyrics(e,t){return i(this,void 0,void 0,(function*(){return this.searchInStore(`lyrics-${e}/${t}`,y.MetaDataType.lyrics,()=>i(this,void 0,void 0,(function*(){let r=yield this.audioModule.lyricsOVH.search(e,t);const i=["(","/","[",":"];for(const s of i)if((!r||!r.lyrics)&&t.includes(s)){const i=t.slice(0,t.indexOf(s)).trim();i.length>0&&(r=yield this.audioModule.lyricsOVH.search(e,i))}return r})))}))}wikipediaSummary(e,t){return i(this,void 0,void 0,(function*(){return t=t||"en",this.searchInStore(`summary-${e}/${t}`,y.MetaDataType.wikipedia,()=>i(this,void 0,void 0,(function*(){return{summary:yield this.audioModule.wikipedia.summary(e,t)}})))}))}wikidataLookup(e){return i(this,void 0,void 0,(function*(){return this.searchInStore("wikidata-entity-"+e,y.MetaDataType.wikidata,()=>i(this,void 0,void 0,(function*(){const t=yield this.audioModule.wikipedia.wikidata(e);return{id:e,type:o.DBObjectType.metadata,dataType:y.MetaDataType.wikidata,data:t,date:Date.now()}})))}))}wikidataSummary(e,t){return i(this,void 0,void 0,(function*(){return this.searchInStore("wikidata-summary-"+e,y.MetaDataType.wikidata,()=>i(this,void 0,void 0,(function*(){const r=yield this.wikidataLookup(e);if(!r)return{};const i=r.entity||r.data;if(!i)return{};const s=(t=t||"en")+"wiki";if(i.sitelinks){const e=i.sitelinks[s];return e?this.wikipediaSummary(e.title,t):{}}return{}})))}))}}t.MetaDataService=g},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(2),n=r(204),o=a.logger("Metadata");t.MetadataServiceExtendedInfo=class{constructor(e){this.service=e}getWikiDataExtendedInfo(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.service.wikidataSummary(e,t);if(r&&r.summary)return n.MetaDataFormat.formatWikipediaExtendedInfo(r.summary.url,r.summary.summary)}))}getMusicBrainzIDWikipediaArtistInfo(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.musicbrainzLookup(s.MusicBrainzLookupType.artist,e);if(t&&t.artist&&t.artist.relations){let e=t.artist.relations.find(e=>"wikidata"===e.type);if(e&&e.url&&e.url.resource){const t=e.url.resource.split("/"),r=t[t.length-1],i=this.getWikiDataExtendedInfo(r,"en");if(i)return i}if(e=t.artist.relations.find(e=>"wikipedia"===e.type),e&&e.url&&e.url.resource){const t=e.url.resource.split("/"),r=t[t.length-1],i=t[2].split(".")[0],s=yield this.service.wikipediaSummary(r,i);if(s&&s.summary)return n.MetaDataFormat.formatWikipediaExtendedInfo(s.summary.url,s.summary.summary)}}}))}getMusicBrainzIDWikipediaAlbumInfo(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.musicbrainzLookup(s.MusicBrainzLookupType.release,e);if(t&&t.release&&t.release.relations){const e=t.release.relations.find(e=>"wikidata"===e.type);if(e&&e.url&&e.url.resource){const t=e.url.resource.split("/"),r=t[t.length-1];return this.getWikiDataExtendedInfo(r,"en")}}}))}getLastFMArtistInfo(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.lastFMLookup(s.LastFMLookupType.artist,e);if(t&&t.artist&&t.artist.bio&&t.artist.bio.content)return n.MetaDataFormat.formatLastFMExtendedInfo(t.artist.url,t.artist.bio.content)}))}getLastFMAlbumInfo(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.lastFMLookup(s.LastFMLookupType.album,e);if(t&&t.album&&t.album.wiki&&t.album.wiki.content)return n.MetaDataFormat.formatLastFMExtendedInfo(t.album.url,t.album.wiki.content)}))}getArtistInfoByMusicBrainzID(e){return i(this,void 0,void 0,(function*(){const t=yield this.getMusicBrainzIDWikipediaArtistInfo(e);return t||this.getLastFMArtistInfo(e)}))}getAlbumInfoByMusicBrainzID(e){return i(this,void 0,void 0,(function*(){const t=yield this.getMusicBrainzIDWikipediaAlbumInfo(e);return t||this.getLastFMAlbumInfo(e)}))}getArtistInfoByName(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.musicbrainzSearch(s.MusicBrainzSearchType.artist,{artist:e});let r;if(t&&t.artists&&1===t.artists.length&&(r=yield this.getArtistInfoByMusicBrainzID(t.artists[0].id)),!r){const t=yield this.service.lastFMArtistSearch(e);t&&t.artist&&t.artist.mbid&&(r=yield this.getArtistInfoByMusicBrainzID(t.artist.mbid))}return r}))}getAlbumInfoByName(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.service.musicbrainzSearch(s.MusicBrainzSearchType.release,{release:e,artist:t});let i;if(r&&r.releases&&r.releases.length>1&&(i=yield this.getAlbumInfoByMusicBrainzID(r.releases[0].id)),!i){const r=yield this.service.lastFMAlbumSearch(e,t);r&&r.album&&r.album.mbid&&(i=yield this.getAlbumInfoByMusicBrainzID(r.album.mbid))}return i}))}byArtist(e){return i(this,void 0,void 0,(function*(){let t;try{e.mbArtistID&&(t=yield this.getArtistInfoByMusicBrainzID(e.mbArtistID)),!t&&e.name&&(t=yield this.getArtistInfoByName(e.name))}catch(e){o.error(e)}return t}))}bySeries(e){return i(this,void 0,void 0,(function*(){try{if(e.name){const t=yield this.getArtistInfoByName(e.name);if(t)return t}}catch(e){o.error(e)}}))}byAlbum(e){return i(this,void 0,void 0,(function*(){let t;try{e.mbReleaseID&&(t=yield this.getAlbumInfoByMusicBrainzID(e.mbReleaseID)),!t&&e.name&&e.artist&&(t=yield this.getAlbumInfoByName(e.name,e.artist))}catch(e){o.error(e)}return t}))}byFolderArtist(e){return i(this,void 0,void 0,(function*(){let t;try{e.tag.mbArtistID&&(t=yield this.getArtistInfoByMusicBrainzID(e.tag.mbArtistID)),!t&&e.tag.artist&&(t=yield this.getArtistInfoByName(e.tag.artist))}catch(e){o.error(e)}return t}))}byFolderAlbum(e){return i(this,void 0,void 0,(function*(){let t;try{e.tag.mbReleaseID&&(t=yield this.getAlbumInfoByMusicBrainzID(e.tag.mbReleaseID)),!t&&e.tag.album&&e.tag.artist&&(t=yield this.getAlbumInfoByName(e.tag.album,e.tag.artist))}catch(e){o.error(e)}return t}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static stripInlineLastFM(e){return(e||"").replace(/<a href=".*">Read more on Last\.fm<\/a>\.?/g,"").replace(/<a .* href=".*">Read more on Last\.fm<\/a>\.?/g,"").replace("User-contributed text is available under the Creative Commons By-SA License; additional terms may apply.","")}static stripInlineWikipediaHTML(e){return(e||"").replace(/<p class="mw-empty-elt">\s*<\/p>/g,"").replace(/<p>/g,"").replace(/<\/p>/g,"\n")}static formatWikipediaExtendedInfo(e,t){return{url:e,description:i.stripInlineWikipediaHTML(t),source:"Wikipedia",license:"Creative Commons BY-SA license",licenseUrl:"https://creativecommons.org/licenses/by-sa/3.0/"}}static formatLastFMExtendedInfo(e,t){return{url:e,description:i.stripInlineLastFM(t),source:"LastFM",license:"Creative Commons BY-SA license",licenseUrl:"https://creativecommons.org/licenses/by-sa/3.0/"}}}t.MetaDataFormat=i},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(2).logger("Metadata");t.MetadataServiceSimilarArtists=class{constructor(e,t,r){this.service=e,this.folderStore=t,this.artistStore=r}getLastFMSimilarArtists(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.lastFMLookup(s.LastFMLookupType.artist,e);return t&&t.artist&&t.artist.similar&&t.artist.similar.artist?t.artist.similar.artist:[]}))}findSimilarArtistFolders(e){return i(this,void 0,void 0,(function*(){const t=[];return e.forEach(e=>{e.name&&t.push(e.name)}),(yield this.folderStore.search({types:[s.FolderType.artist],artists:t})).items}))}findSimilarArtists(e){return i(this,void 0,void 0,(function*(){const t=[];return e.forEach(e=>{e.name&&t.push(e.name)}),(yield this.artistStore.search({names:t})).items}))}byArtistIdName(e,t){return i(this,void 0,void 0,(function*(){let r=[];if(e)r=yield this.getLastFMSimilarArtists(e);else if(t){const e=yield this.service.lastFMArtistSearch(t);e&&e.artist&&(r=yield this.getLastFMSimilarArtists(e.artist.mbid))}return r}))}byArtist(e){return i(this,void 0,void 0,(function*(){try{const t=yield this.byArtistIdName(e.mbArtistID,e.name);if(t&&t.length>0)return this.findSimilarArtists(t)}catch(e){a.error(e)}return[]}))}byFolder(e){return i(this,void 0,void 0,(function*(){try{const t=yield this.byArtistIdName(e.tag.mbArtistID,e.tag.artist);if(t&&t.length>0)return this.findSimilarArtistFolders(t)}catch(e){a.error(e)}return[]}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(15);t.MetadataServiceSimilarTracks=class{constructor(e,t){this.service=e,this.trackStore=t}findSongTracks(e){return i(this,void 0,void 0,(function*(){const t=[],r=[],i=[];e.forEach(e=>{e.mbid?t.push(e):r.push(e)});const s=t.map(e=>e.mbid||"-").filter(e=>"-"!==e),a=yield this.trackStore.search({mbTrackIDs:s});t.forEach(e=>{const t=a.items.find(t=>t.tag.mbTrackID===e.mbid);t?i.push(t):r.push(e)});for(const e of r){const t=yield this.trackStore.searchOne({title:e.name,artist:e.artist});t&&i.push(t)}return i}))}getSimilarSongs(e){return i(this,void 0,void 0,(function*(){let t=[];for(const r of e){let e;r.mbid?e=yield this.service.lastFMTopTracksArtistID(r.mbid):r.name&&(e=yield this.service.lastFMTopTracksArtist(r.name)),e&&e.toptracks&&e.toptracks.track&&(t=t.concat(e.toptracks.track.map(e=>({name:e.name,artist:e.artist.name,mbid:e.mbid,url:e.url}))))}return s.shuffle(t)}))}getSimilarArtistTracks(e){return i(this,void 0,void 0,(function*(){if(!e||0===e.length)return[];const t=yield this.getSimilarSongs(e);return this.findSongTracks(t)}))}byAlbum(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.similarArtists.byArtistIdName(e.mbArtistID,e.artist);return this.getSimilarArtistTracks(t)}))}byArtist(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.similarArtists.byArtistIdName(e.mbArtistID,e.name);return this.getSimilarArtistTracks(t)}))}byFolder(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.similarArtists.byArtistIdName(e.tag.mbArtistID,e.tag.artist);return this.getSimilarArtistTracks(t)}))}byTrack(e){return i(this,void 0,void 0,(function*(){if(e.tag.mbTrackID){const t=yield this.service.lastFMSimilarTracks(e.tag.mbTrackID);if(t&&t.similartracks&&t.similartracks.track){const e=t.similartracks.track.map(e=>({name:e.name,artist:e.artist.name,mbid:e.mbid,url:e.url}));return this.findSongTracks(e)}}return[]}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.MetadataServiceTopTracks=class{constructor(e){this.service=e}byArtistName(e){return i(this,void 0,void 0,(function*(){const t=yield this.service.lastFMTopTracksArtist(e);if(t&&t.toptracks&&t.toptracks.track){const e=t.toptracks.track.map(e=>({name:e.name,artist:e.artist.name,mbid:e.mbid,url:e.url}));return this.service.similarTracks.findSongTracks(e)}return[]}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.musicbrainz=0]="musicbrainz",e[e.wikipedia=1]="wikipedia",e[e.wikidata=2]="wikidata",e[e.acoustid=3]="acoustid",e[e.acousticbrainz=4]="acousticbrainz",e[e.coverartarchive=5]="coverartarchive",e[e.lastfm=6]="lastfm",e[e.lyrics=7]="lyrics"}(t.MetaDataType||(t.MetaDataType={}))},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);t.NowPlayingService=class{constructor(e){this.stateService=e,this.playing=[]}getNowPlaying(){return i(this,void 0,void 0,(function*(){return this.playing}))}clear(){this.playing=[]}reportEpisode(e,t){return i(this,void 0,void 0,(function*(){this.playing=this.playing.filter(e=>e.user.id!==t.id),this.playing.push({time:Date.now(),obj:e,user:t}),yield this.stateService.reportPlaying(e.id,s.DBObjectType.episode,t.id),yield this.stateService.reportPlaying(e.podcastID,s.DBObjectType.podcast,t.id)}))}reportTrack(e,t){return i(this,void 0,void 0,(function*(){this.playing=this.playing.filter(e=>e.user.id!==t.id),this.playing.push({time:Date.now(),obj:e,user:t}),yield this.stateService.reportPlaying(e.id,s.DBObjectType.track,t.id),yield this.stateService.reportPlaying(e.albumID,s.DBObjectType.album,t.id),yield this.stateService.reportPlaying(e.artistID,s.DBObjectType.artist,t.id),yield this.stateService.reportPlaying(e.parentID,s.DBObjectType.folder,t.id),e.seriesID&&(yield this.stateService.reportPlaying(e.seriesID,s.DBObjectType.series,t.id))}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(11);class n extends a.BaseStoreService{constructor(e){super(e),this.playQueueStore=e}defaultSort(e){return e}getQueueOrCreate(e,t){return i(this,void 0,void 0,(function*(){let r=yield this.get(e);return r||(r=this.emptyPlaylist(e,t),r.id=yield this.playQueueStore.add(r)),r}))}emptyPlaylist(e,t){return{id:"",type:s.DBObjectType.playqueue,userID:e,trackIDs:[],changed:Date.now(),changedBy:t||"Unknown Client"}}get(e){return i(this,void 0,void 0,(function*(){return this.playQueueStore.searchOne({userID:e})}))}save(e,t,r,a,n){return i(this,void 0,void 0,(function*(){let i=yield this.playQueueStore.searchOne({userID:e});return i?(i.trackIDs=t,i.currentID=r,i.position=a,i.changed=Date.now(),i.changedBy=n||"Unknown Client",yield this.playQueueStore.replace(i)):(i={id:"",type:s.DBObjectType.playqueue,userID:e,trackIDs:t,currentID:r,position:a,changed:Date.now(),changedBy:n||"Unknown Client"},i.id=yield this.playQueueStore.add(i)),i}))}remove(e){return i(this,void 0,void 0,(function*(){const t=yield this.get(e);t&&(yield this.playQueueStore.remove(t.id))}))}}t.PlayQueueService=n},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(0),c=r(1),d=r(26),u=r(212),l=r(4),m=r(2),p=r(13),f=m.logger("PodcastService");class y extends p.BaseListService{constructor(e,t,r,i,s){super(t,s),this.podcastsPath=e,this.podcastStore=t,this.episodeService=r,this.imageModule=i,this.podcastRefreshDebounce=new d.DebouncePromises}defaultSort(e){return e.sort((e,t)=>(e.tag&&e.tag.title?e.tag.title:e.url).localeCompare(t.tag&&t.tag.title?t.tag.title:t.url))}isDownloading(e){return this.podcastRefreshDebounce.isPending(e)}create(e){return i(this,void 0,void 0,(function*(){const t={id:"",type:o.DBObjectType.podcast,created:Date.now(),lastCheck:0,url:e,status:c.PodcastStatus.new};return t.id=yield this.podcastStore.add(t),t}))}remove(e){return i(this,void 0,void 0,(function*(){yield this.podcastStore.remove(e.id),yield this.episodeService.removeEpisodes(e.id);const t=n.default.resolve(this.podcastsPath,e.id);yield l.pathDeleteIfExists(t),yield this.imageModule.clearImageCacheByIDs([e.id])}))}refresh(e){return i(this,void 0,void 0,(function*(){if(this.podcastRefreshDebounce.isPending(e.id))return this.podcastRefreshDebounce.append(e.id);this.podcastRefreshDebounce.setPending(e.id);try{f.debug("Refreshing Podcast",e.url);const t=new u.Feed;let r=[];try{const i=yield t.get(e);i&&(e.tag=i.tag,r=i.episodes),e.status=c.PodcastStatus.completed,e.errorMessage=void 0}catch(t){f.info("Refreshing Podcast failed",t),e.status=c.PodcastStatus.error,e.errorMessage=(t||"").toString()}if(e.lastCheck=Date.now(),e.image){const t=n.default.resolve(this.podcastsPath,e.id,e.image);(yield a.default.pathExists(t))||(e.image=void 0)}if(!e.image&&e.tag&&e.tag.image){f.info("Try downloading Podcast image");const t=n.default.resolve(this.podcastsPath,e.id);yield a.default.ensureDir(t);try{e.image=yield this.imageModule.storeImage(t,"cover",e.tag.image)}catch(t){e.image=void 0,f.info("Downloading Podcast image failed",t)}}yield this.podcastStore.replace(e);const i=yield this.episodeService.mergeEpisodes(e.id,e.tag?e.tag.title:e.url,r);f.info(`${e.url}: New Episodes: ${i.length}`),this.podcastRefreshDebounce.resolve(e.id,void 0)}catch(t){return this.podcastRefreshDebounce.resolve(e.id,void 0),Promise.reject(t)}}))}refreshPodcasts(){return i(this,void 0,void 0,(function*(){f.info("Refreshing");const e=yield this.podcastStore.all();for(const t of e)yield this.refresh(t);f.info("Refreshed")}))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){if(e.image)return this.imageModule.get(e.id,n.default.join(this.podcastsPath,e.id,e.image),t,r)}))}getEpisodeImage(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.episodeService.getImage(e,t,r);if(!i){const i=yield this.podcastStore.byId(e.podcastID);if(i)return this.getImage(i,t,r)}return i}))}}t.PodcastService=y},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(213)),n=s(r(214)),o=s(r(14)),c=s(r(37)),d=s(r(215)),u=r(0),l=r(1);class m{static parseDurationMilliseconds(e){return o.default.duration(e).as("milliseconds")}static parseItunesDurationSeconds(e){const t=Number(e);return e.includes(":")||isNaN(t)?(5===e.length&&(e="00:"+e),o.default.duration(e).as("seconds")):t}static getParams(e){return e.split(";").reduce((e,t)=>{const r=t.split("=").map(e=>e.trim());return 2===r.length&&(e[r[0]]=r[1]),e},{})}static maybeDecompress(e,t,r){let i;return t.match(/\bdeflate\b/)?(i=d.default.createInflate(),i.on("error",r)):t.match(/\bgzip\b/)&&(i=d.default.createGunzip(),i.on("error",r)),i?e.pipe(i):e}static maybeTranslate(e,t,r){if(t&&!/utf-*8/i.test(t))try{const i=n.default.decodeStream(t);i.on("error",r),e=e.pipe(i)}catch(t){e.emit("error",t)}return e}fetch(e){return i(this,void 0,void 0,(function*(){const t=[];let r,i=!1;const s=c.default(e,{timeout:1e4,pool:!1});s.setMaxListeners(50),s.setHeader("user-agent","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36"),s.setHeader("accept","text/html,application/xhtml+xml");const n=new a.default({});return n.on("readable",(function(){const e=n;r=e.meta;let i=e.read();for(;i;)t.push(i),i=e.read()})),new Promise((e,a)=>{const o=s=>{i||(i=!0,s?a(s):e({feed:r,posts:t}))};s.on("error",o),s.on("response",e=>{if(200!==e.statusCode)return s.abort(),o(new Error(`Bad status code ${e.statusCode}${e.statusMessage?" "+e.statusMessage:""}`));const t=e.headers["content-encoding"]||"identity",r=m.getParams(e.headers["content-type"]||"").charset;let i=m.maybeDecompress(e,t,o);i=m.maybeTranslate(i,r,o),i.pipe(n)}),n.on("error",o),n.on("end",o)})}))}get(e){return i(this,void 0,void 0,(function*(){const t=yield this.fetch(e.url),r={title:t.feed.title,description:t.feed.description,link:t.feed.link,author:t.feed.author,generator:t.feed.generator,image:t.feed.image&&t.feed.image.url?t.feed.image.url:void 0,categories:t.feed.categories};t.feed["itunes:summary"]&&t.feed["itunes:summary"]["#"]&&(r.description=t.feed["itunes:summary"]["#"]);const i=t.posts.map(t=>{let i=[];const s=t;let a;s["itunes:duration"]&&s["itunes:duration"]["#"]&&(a=m.parseItunesDurationSeconds(s["itunes:duration"]["#"]));const n=s["psc:chapters"];if(n){const e=n["psc:chapter"];e&&(i=e.map(e=>{const t=e["@"];return{start:m.parseDurationMilliseconds(t.start),title:t.title}}).sort((e,t)=>e.start-t.start))}return{id:"",podcastID:e.id,podcast:r.title||"",status:l.PodcastStatus.new,type:u.DBObjectType.episode,author:t.author,link:t.link,guid:t.guid||t.link,summary:t.summary,enclosures:t.enclosures,date:t.date?t.date.valueOf():0,name:t.title,duration:a,chapters:i}});return{tag:r,episodes:i}}))}}t.Feed=m},function(e,t){e.exports=require("feedparser")},function(e,t){e.exports=require("iconv-lite")},function(e,t){e.exports=require("zlib")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(11);class n extends a.BaseStoreService{constructor(e){super(e),this.radioStore=e}defaultSort(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}create(e,t,r){return i(this,void 0,void 0,(function*(){const i={id:"",type:s.DBObjectType.radio,name:e,homepage:r,url:t,created:Date.now(),changed:Date.now()};return i.id=yield this.radioStore.add(i),i}))}update(e,t,r,s){return i(this,void 0,void 0,(function*(){e.homepage=s||e.homepage,e.url=r||e.url,e.name=t||e.name,e.changed=Date.now(),yield this.radioStore.replace(e)}))}remove(e){return i(this,void 0,void 0,(function*(){yield this.radioStore.remove(e.id)}))}}t.RadioService=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(11);class s extends i.BaseStoreService{constructor(e){super(e),this.rootStore=e}defaultSort(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}}t.RootService=s},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(13);class a extends s.BaseListService{constructor(e,t,r,i){super(e,i),this.seriesStore=e,this.trackStore=t,this.folderService=r}defaultSort(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.folderService.folderStore.byIds(e.folderIDs);i.sort((e,t)=>e.tag.level-t.tag.level);for(const e of i){const i=this.folderService.getImage(e,t,r);if(i)return i}}))}}t.SeriesService=a},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(11);class a extends s.BaseStoreService{constructor(e){super(e),this.sessionStore=e,this.events=[],this.jwthCache=[]}defaultSort(e){return e}expired(e){return e.expires<Date.now()}exists(e){return i(this,void 0,void 0,(function*(){return!!(yield this.sessionStore.searchOne({sessionID:e}))}))}set(e){return i(this,void 0,void 0,(function*(){const t=yield this.get(e.sessionID);t?(e.id=t.id,yield this.sessionStore.replace(e)):yield this.sessionStore.add(e)}))}get(e){return i(this,void 0,void 0,(function*(){try{const t=yield this.sessionStore.searchOne({sessionID:e});return t&&this.expired(t)?void(yield this.remove(e)):t}catch(e){return}}))}clearExpired(){return i(this,void 0,void 0,(function*(){const e=yield this.sessionStore.all();for(const t of e)this.expired(t)&&(yield this.remove(t.id))}))}byJwth(e){return i(this,void 0,void 0,(function*(){return this.sessionStore.searchOne({jwth:e})}))}byUserID(e){return i(this,void 0,void 0,(function*(){return(yield this.sessionStore.search({userID:e})).items}))}byID(e){return i(this,void 0,void 0,(function*(){return this.sessionStore.byId(e)}))}remove(e){return i(this,void 0,void 0,(function*(){this.jwthCache=[],yield this.sessionStore.removeByQuery({sessionID:e})}))}removeByJwth(e){return i(this,void 0,void 0,(function*(){this.jwthCache=[],yield this.sessionStore.removeByQuery({jwth:e})}))}all(){return i(this,void 0,void 0,(function*(){return this.sessionStore.all()}))}clear(){return i(this,void 0,void 0,(function*(){return this.jwthCache=[],this.sessionStore.clear()}))}count(){return i(this,void 0,void 0,(function*(){return this.sessionStore.count()}))}clearCache(){return i(this,void 0,void 0,(function*(){this.jwthCache=[];for(const e of this.events)yield e.clearCache()}))}registerNotify(e){this.events.push(e)}isRevoked(e){return i(this,void 0,void 0,(function*(){if(this.jwthCache.includes(e))return!1;const t=yield this.sessionStore.searchOne({jwth:e});return t&&this.jwthCache.push(e),!t}))}}t.SessionService=a},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(221),a=r(0);t.SettingsService=class{constructor(e,t,r,i,a,n){this.settingsStore=e,this.chatService=t,this.indexService=r,this.workerService=i,this.audiomodule=a,this.version=n,this.settings=s.defaultSettings()}get(){return i(this,void 0,void 0,(function*(){return this.settings}))}settingsVersion(){return i(this,void 0,void 0,(function*(){return(yield this.getSettings()).version}))}saveSettings(){return i(this,void 0,void 0,(function*(){const e=yield this.getSettings();e.version=this.version,e.data=this.settings,yield this.settingsStore.upsert([e])}))}initSettingsStoreObj(){return{id:"",type:a.DBObjectType.settings,section:"jamserve",data:s.defaultSettings(),version:this.version}}getSettings(){return i(this,void 0,void 0,(function*(){let e=yield this.settingsStore.searchOne({section:"jamserve"});return e?e.data=Object.assign(Object.assign({},s.defaultSettings()),e.data):(e=this.initSettingsStoreObj(),e.id=yield this.settingsStore.add(e)),e}))}loadSettings(){return i(this,void 0,void 0,(function*(){const e=yield this.getSettings();this.setSettings(e.data)}))}updateSettings(e){return i(this,void 0,void 0,(function*(){this.setSettings(e),yield this.saveSettings()}))}setSettings(e){this.settings=e,this.chatService.setSettings(this.settings.chat),this.indexService.setSettings(this.settings.index),this.workerService.setSettings(this.settings.library),this.audiomodule.setSettings(this.settings.externalServices)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSettings=function(){return{chat:{maxMessages:100,maxAge:{value:1,unit:"day"}},index:{ignoreArticles:["The","El","La","Los","Las","Le","Les","Die"]},library:{scanAtStart:!0},externalServices:{enabled:!1}}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(11);class n extends a.BaseStoreService{constructor(e){super(e),this.stateStore=e}defaultSort(e){return e}emptyState(e,t,r){return{id:"",type:s.DBObjectType.state,destID:e,destType:t,played:0,lastplayed:0,faved:void 0,rated:0,userID:r}}fav(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=yield this.findOrCreate(e,r,t);if(s){if(void 0===i.faved)return i;i.faved=void 0}else{if(void 0!==i.faved)return i;i.faved=Date.now()}return 0===i.id.length?yield this.stateStore.add(i):yield this.stateStore.replace(i),i}))}rate(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=yield this.findOrCreate(e,r,t);return i.rated=0===s?void 0:s,0===i.id.length?yield this.stateStore.add(i):yield this.stateStore.replace(i),i}))}findOrCreate(e,t,r){return i(this,void 0,void 0,(function*(){return(yield this.stateStore.searchOne({userID:t,destID:e,type:r}))||this.emptyState(e,r,t)}))}findOrCreateMany(e,t,r){return i(this,void 0,void 0,(function*(){if(!e||0===e.length)return{};const i=yield this.stateStore.search({userID:t,type:r,destIDs:e}),s={};return i.items.forEach(e=>{s[e.destID]=e}),e.forEach(e=>{s[e]||(s[e]=this.emptyState(e,r,t))}),s}))}getHighestRatedDestIDs(e,t){return i(this,void 0,void 0,(function*(){return(yield this.stateStore.search({userID:t,type:e,minRating:1})).items.filter(e=>void 0!==e.rated).sort((e,t)=>Number(t.rated)-Number(e.rated)).map(e=>e.destID)}))}getAvgHighestDestIDs(e){return i(this,void 0,void 0,(function*(){const t=yield this.stateStore.search({type:e}),r={};return t.items.forEach(e=>{void 0!==e.rated&&(r[e.destID]=r[e.destID]||[],r[e.destID].push(e.rated))}),Object.keys(r).map(e=>({id:e,avg:r[e].reduce((e,t)=>e+t,0)/r[e].length})).sort((e,t)=>t.avg-e.avg).map(e=>e.id)}))}getFrequentlyPlayedDestIDs(e,t){return i(this,void 0,void 0,(function*(){return(yield this.stateStore.search({userID:t,type:e,isPlayed:!0})).items.sort((e,t)=>t.played-e.played).map(e=>e.destID)}))}getFavedDestIDs(e,t){return i(this,void 0,void 0,(function*(){return(yield this.stateStore.search({userID:t,type:e,isFaved:!0})).items.sort((e,t)=>Number(t.faved)-Number(e.faved)).map(e=>e.destID)}))}getRecentlyPlayedDestIDs(e,t){return i(this,void 0,void 0,(function*(){return(yield this.stateStore.search({userID:t,type:e,isPlayed:!0})).items.sort((e,t)=>t.lastplayed-e.lastplayed).map(e=>e.destID)}))}reportPlaying(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.findOrCreate(e,r,t);return i.played++,i.lastplayed=Date.now(),yield this.stateStore.upsert([i]),i}))}}t.StateService=n},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1);t.StatsService=class{constructor(e){this.store=e,this.stats=[]}refresh(){return i(this,void 0,void 0,(function*(){this.stats=[]}))}getStats(e){return i(this,void 0,void 0,(function*(){let t=this.stats.find(t=>t.rootID===e);return t||(t={rootID:e,album:yield this.store.albumStore.searchCount({rootID:e}),series:yield this.store.seriesStore.searchCount({rootID:e}),albumTypes:{album:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.album}),compilation:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.compilation,mbArtistID:s.MUSICBRAINZ_VARIOUS_ARTISTS_ID}),artist_compilation:(yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.compilation}))-(yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.compilation,mbArtistID:s.MUSICBRAINZ_VARIOUS_ARTISTS_ID})),audiobook:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.audiobook}),series:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.series}),soundtrack:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.soundtrack}),bootleg:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.bootleg}),live:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.live}),ep:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.ep}),unknown:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.unknown}),single:yield this.store.albumStore.searchCount({rootID:e,albumType:s.AlbumType.single})},artist:yield this.store.artistStore.searchCount({rootID:e}),artistTypes:{album:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.album}),compilation:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.compilation,mbArtistID:s.MUSICBRAINZ_VARIOUS_ARTISTS_ID}),artist_compilation:(yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.compilation}))-(yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.compilation,mbArtistID:s.MUSICBRAINZ_VARIOUS_ARTISTS_ID})),audiobook:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.audiobook}),series:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.series}),soundtrack:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.soundtrack}),bootleg:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.bootleg}),live:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.live}),ep:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.ep}),unknown:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.unknown}),single:yield this.store.artistStore.searchCount({rootID:e,albumType:s.AlbumType.single})},folder:yield this.store.folderStore.searchCount({rootID:e}),track:yield this.store.trackStore.searchCount({rootID:e}),podcasts:yield this.store.podcastStore.searchCount({})},this.stats.push(t)),t}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(5),c=r(1),d=r(49),u=r(4);t.StreamService=class{constructor(e){this.audioModule=e}streamFile(e,t,r,s,n){return i(this,void 0,void 0,(function*(){let i;try{i=yield a.default.stat(e)}catch(e){i=void 0}if(!i)return Promise.reject(Error("File not found"));"."===(s=s||c.AudioFormatType.mp3)[0]&&(s=s.slice(1));const o=n||0;return"raw"!==s&&d.TranscoderStream.needsTranscoding(r||u.fileSuffix(e),s,o)?this.audioModule.transcoder.get(e,t,s,o):{file:{filename:e,name:`${t}.${s}`}}}))}streamTrack(e,t,r,s){return i(this,void 0,void 0,(function*(){return this.streamFile(n.default.join(e.path,e.name),e.id,e.media.format,t,r)}))}streamEpisode(e,t,r,s){return i(this,void 0,void 0,(function*(){return e.path&&e.media?this.streamFile(e.path,e.id,e.media.format,t,r):Promise.reject(o.GenericError("Podcast episode not ready"))}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(13),o=r(2).logger("TrackService");class c extends n.BaseListService{constructor(e,t,r,i,s){super(e,s),this.trackStore=e,this.folderService=t,this.audioModule=r,this.imageModule=i}defaultCompare(e,t){let r=e.path.localeCompare(t.path);return 0!==r||void 0!==e.tag.disc&&void 0!==t.tag.disc&&(r=e.tag.disc-t.tag.disc,0!==r)||void 0!==e.tag.track&&void 0!==t.tag.track&&(r=e.tag.track-t.tag.track,0!==r)?r:e.name.localeCompare(t.name)}defaultSort(e){return e.sort((e,t)=>this.defaultCompare(e,t))}getTrackFolder(e){return i(this,void 0,void 0,(function*(){return this.folderService.folderStore.byId(e.parentID)}))}getImage(e,t,r){return i(this,void 0,void 0,(function*(){if(e.tag&&e.tag.nrTagImages){const i=yield this.imageModule.getExisting(e.id,t,r);if(i)return i;try{const i=yield this.audioModule.extractTagImage(a.default.join(e.path,e.name));if(i)return yield this.imageModule.getBuffer(e.id,i,t,r)}catch(t){o.error("TrackService","Extracting image from audio failed: "+a.default.join(e.path,e.name))}}const i=yield this.getTrackFolder(e);if(i)return this.folderService.getImage(i,t,r)}))}}t.TrackService=c},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(227)),n=s(r(6)),o=s(r(3)),c=r(4),d=r(20),u=r(11);class l extends u.BaseStoreService{constructor(e,t,r,i,s,a,n,o){super(t),this.userAvatarPath=e,this.userStore=t,this.stateStore=r,this.playlistStore=i,this.bookmarkStore=s,this.playQueueStore=a,this.sessionStore=n,this.imageModule=o,this.cachedUsers=new Map}defaultSort(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}avatarImageFilename(e){return o.default.join(this.userAvatarPath,`avatar-${e.id}.png`)}getImage(e,t,r){return i(this,void 0,void 0,(function*(){const i=this.avatarImageFilename(e);let s=yield n.default.pathExists(i);if(s||(yield this.generateAvatar(e),s=yield n.default.pathExists(i)),s)return this.imageModule.get(e.id,i,t,r)}))}generateAvatar(e,t){return i(this,void 0,void 0,(function*(){const r=this.avatarImageFilename(e);yield c.fileDeleteIfExists(r),yield this.imageModule.generateAvatar(t||e.name,r),yield this.imageModule.clearImageCacheByIDs([e.id])}))}setUserImage(e,t,r){return i(this,void 0,void 0,(function*(){const r=this.avatarImageFilename(e);yield this.imageModule.createAvatar(t,r),yield c.fileDeleteIfExists(t),yield this.imageModule.clearImageCacheByIDs([e.id])}))}create(e){return i(this,void 0,void 0,(function*(){if(!e.name||0===e.name.trim().length)return Promise.reject(Error("Invalid Username"));return(yield this.getByName(e.name))?Promise.reject(Error("Username already exists")):this.userStore.add(e)}))}update(e){return i(this,void 0,void 0,(function*(){yield this.userStore.replace(e),this.cachedUsers.delete(e.id)}))}remove(e){return i(this,void 0,void 0,(function*(){this.cachedUsers.delete(e.id),yield this.stateStore.removeByQuery({userID:e.id}),yield this.playlistStore.removeByQuery({userID:e.id}),yield this.bookmarkStore.removeByQuery({userID:e.id}),yield this.playQueueStore.removeByQuery({userID:e.id}),yield this.sessionStore.removeByQuery({userID:e.id}),yield this.imageModule.clearImageCacheByIDs([e.id]),yield this.userStore.remove(e.id),yield c.fileDeleteIfExists(this.avatarImageFilename(e))}))}getByName(e){return i(this,void 0,void 0,(function*(){if(!e||0===e.trim().length)return Promise.reject(Error("Invalid Username"));for(const t of this.cachedUsers)if(t[1].name===e)return t[1];const t=yield this.userStore.searchOne({name:e});return t&&this.cachedUsers.set(t.id,t),t}))}getByID(e){return i(this,void 0,void 0,(function*(){let t=this.cachedUsers.get(e);return t||(t=yield this.userStore.byId(e),t&&this.cachedUsers.set(e,t),t)}))}auth(e,t){return i(this,void 0,void 0,(function*(){if(!t||!t.length)return Promise.reject(Error("Invalid Password"));const r=yield this.getByName(e);return r?d.hashSaltSHA512(t,r.salt)!==r.hash?Promise.reject(Error("Invalid Password")):r:Promise.reject(Error("Invalid Username"))}))}clearCache(){this.cachedUsers.clear()}setUserPassword(e,t){return i(this,void 0,void 0,(function*(){yield this.testPassword(t);const r=d.hashAndSaltSHA512(t);e.salt=r.salt,e.hash=r.hash,yield this.userStore.replace(e),this.cachedUsers.delete(e.id)}))}testPassword(e){return i(this,void 0,void 0,(function*(){return e&&e.trim().length?e.length<4?Promise.reject(Error("Password is too short")):a.default(e)?Promise.reject(Error("Your password is found in the most frequently used password list and too easy to guess")):void 0:Promise.reject(Error("Invalid Password"))}))}setUserEmail(e,t){return i(this,void 0,void 0,(function*(){if(!t||!t.trim().length)return Promise.reject(Error("Invalid Email"));e.email=t,yield this.userStore.replace(e),this.cachedUsers.delete(e.id)}))}}t.UserService=l},function(e,t){e.exports=require("common-password-checker")},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3));t.WaveformService=class{constructor(e){this.audioModule=e}getTrackWaveform(e,t,r){return i(this,void 0,void 0,(function*(){return this.audioModule.waveform.get(e.id,a.default.join(e.path,e.name),t,r)}))}getEpisodeWaveform(e,t,r){return i(this,void 0,void 0,(function*(){return e.path&&e.media?this.audioModule.waveform.get(e.id,e.path,t,r):Promise.reject(Error("Podcast episode not ready"))}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(230),a=r(231),n=r(232),o=r(240),c=r(241),d=r(244);t.WorkerService=class{constructor(e,t,r){this.store=e,this.audioModule=t,this.imageModule=r,this.settings={scanAtStart:!0},this.artworkWorker=new a.ArtworkWorker(e,r),this.trackWorker=new d.TrackWorker(e,r,t),this.folderWorker=new o.FolderWorker(e),this.rootWorker=new c.RootWorker(e),this.changes=new n.ChangesWorker(e,t,r,this.settings)}setSettings(e){this.settings=e,this.changes.settings=e}mergeDBMatch(e,t,r,a){return i(this,void 0,void 0,(function*(){if(t.length+r.length===0)return;const i=new s.MatchDirBuilderDB(this.store),{rootMatch:n,changedDirs:o}=yield i.build(t,r);yield this.changes.mergeMatch(e,n,e=>o.includes(e),!1,a)}))}refreshRoot(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{rootMatch:i,removedFolders:s,removedTracks:a}=yield this.rootWorker.scan(t);return r.removedFolders=s,r.removedTracks=a,yield this.changes.mergeMatch(t,i,()=>!0,e.forceMetaRefresh,r),this.changes.finish(r,t.id,e.forceMetaRefresh)}))}updateRoot(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),i=t.strategy!==e.strategy;yield this.rootWorker.update(t,e.name,e.path,e.strategy);const{rootMatch:s,removedFolders:a,removedTracks:n}=yield this.rootWorker.scan(t);return r.removedFolders=a,r.removedTracks=n,yield this.changes.mergeMatch(t,s,()=>!0,!1,r),this.changes.finish(r,t.id,i)}))}createRoot(e){return i(this,void 0,void 0,(function*(){const t=yield this.rootWorker.create(e.name,e.path,e.strategy),{changes:r}=yield this.changes.start(t.id);return this.changes.finish(r,t.id,!1)}))}removeRoot(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{removedFolders:i,removedTracks:s}=yield this.rootWorker.remove(t);return r.removedFolders=i,r.removedTracks=s,yield this.mergeDBMatch(t,[],[],r),this.changes.finish(r,t.id,!1)}))}deleteFolders(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{removedFolders:i,removedTracks:s,changedFolderIDs:a,changedTrackIDs:n}=yield this.folderWorker.delete(t,e.folderIDs);return r.removedFolders=i,r.removedTracks=s,yield this.mergeDBMatch(t,a,n,r),this.changes.finish(r,t.id,!1)}))}refreshFolders(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID);return yield this.mergeDBMatch(t,e.folderIDs,[],r),this.changes.finish(r,t.id,!1)}))}createFolder(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{folder:i,parent:s}=yield this.folderWorker.create(e.parentID,e.name);return r.newFolders.push(i),r.updateFolders.push(s),this.changes.finish(r,t.id,!1)}))}moveFolders(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{changedFolderIDs:i,changedTrackIDs:s}=yield this.folderWorker.move(e.newParentID,e.folderIDs);return yield this.mergeDBMatch(t,i,s,r),this.changes.finish(r,t.id,!1)}))}renameFolder(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{changedFolderIDs:i,changedTrackIDs:s}=yield this.folderWorker.rename(e.folderID,e.newName);return yield this.mergeDBMatch(t,i,s,r),this.changes.finish(r,t.id,!1)}))}refreshTracks(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{changedFolderIDs:i,changedTrackIDs:s}=yield this.trackWorker.refresh(e.trackIDs);return yield this.mergeDBMatch(t,i,s,r),this.changes.finish(r,t.id,!1)}))}removeTracks(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{changedFolderIDs:i,changedTrackIDs:s,removedTracks:a}=yield this.trackWorker.delete(t,e.trackIDs);return r.removedTracks=a,yield this.mergeDBMatch(t,i,s,r),this.changes.finish(r,t.id,!1)}))}moveTracks(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{changedFolderIDs:i,changedTrackIDs:s}=yield this.trackWorker.move(e.trackIDs,e.newParentID);return yield this.mergeDBMatch(t,i,s,r),this.changes.finish(r,t.id,!1)}))}renameTrack(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID);return yield this.trackWorker.rename(e.trackID,e.newName),this.changes.finish(r,t.id,!1)}))}fixTracks(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{changedFolderIDs:i,changedTrackIDs:s}=yield this.trackWorker.fix(e.fixes);return yield this.mergeDBMatch(t,i,s,r),this.changes.finish(r,t.id,!1)}))}writeTrackTags(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID),{changedFolderIDs:i,changedTrackIDs:s}=yield this.trackWorker.writeTags(e.tags);return yield this.mergeDBMatch(t,i,s,r),this.changes.finish(r,t.id,!1)}))}renameArtwork(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID);return yield this.artworkWorker.rename(e.folderID,e.artworkID,e.name,r),this.changes.finish(r,t.id,!1)}))}createArtwork(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID);return yield this.artworkWorker.create(e.folderID,e.artworkFilename,e.artworkMimeType,e.types,r),this.changes.finish(r,t.id,!1)}))}updateArtwork(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID);return yield this.artworkWorker.update(e.folderID,e.artworkID,e.artworkFilename,e.artworkMimeType,r),this.changes.finish(r,t.id,!1)}))}downloadArtwork(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID);return yield this.artworkWorker.download(e.folderID,e.folderID,e.artworkURL,e.types,r),this.changes.finish(r,t.id,!1)}))}deleteArtwork(e){return i(this,void 0,void 0,(function*(){const{root:t,changes:r}=yield this.changes.start(e.rootID);return yield this.artworkWorker.delete(e.folderID,e.artworkID,r),this.changes.finish(r,t.id,!1)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(1);t.MatchDirBuilderDB=class{constructor(e){this.store=e}buildMatchFileFromDB(e){return i(this,void 0,void 0,(function*(){return{rootID:e.rootID,track:e,name:n.default.join(e.path,e.name),type:o.FileTyp.AUDIO,stat:{ctime:e.stat.created,mtime:e.stat.modified,size:e.stat.size}}}))}buildMatchDirDBData(e){return i(this,void 0,void 0,(function*(){const t={name:e.path,level:e.tag.level,rootID:e.rootID,tag:e.tag,stat:{ctime:e.stat.created,mtime:e.stat.modified},parent:void 0,folder:e,files:[],directories:[],metaStat:void 0},r=yield this.store.trackStore.search({parentID:e.id});for(const e of r.items)t.files.push(yield this.buildMatchFileFromDB(e));if(e.tag.artworks)for(const r of e.tag.artworks){const i={rootID:e.rootID,name:n.default.join(e.path,r.name),type:o.FileTyp.IMAGE,stat:{ctime:r.stat.created,mtime:r.stat.modified,size:r.stat.size}};t.files.push(i)}return t}))}buildMatchDirParentsFromDBData(e,t){return i(this,void 0,void 0,(function*(){const r=e.folder;if(!r||!r.parentID)return;let i=t.find(e=>!!e.folder&&e.folder.id===r.parentID);if(i)return i.directories.includes(e)||i.directories.push(e),e.parent=i,i;const s=yield this.store.folderStore.byId(r.parentID);if(s){if(i=yield this.buildMatchDirDBData(s),i.directories.push(e),e.level>1){const e=yield this.store.folderStore.search({parentID:s.id});for(const s of e.items)if(s.id!==r.id){let e=t.find(e=>!!e.folder&&e.folder.id===s.id);e||(e=yield this.buildMatchDirDBData(s),t.push(e)),e.parent=i,i.directories.push(e)}}return t.push(i),i.parent=yield this.buildMatchDirParentsFromDBData(i,t),i}}))}loadChildsFromDBData(e,t){return i(this,void 0,void 0,(function*(){const r=e.folder;if(r&&(!e.directories||0===e.directories.length)){const i=yield this.store.folderStore.search({parentID:r.id});for(const r of i.items){const i=yield this.buildMatchDirDBData(r);i.parent=e,t.push(e),e.directories.push(i),yield this.loadChildsFromDBData(i,t)}}}))}build(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.folderStore.byIds(e),i=[],s=[],n=[];for(const e of r){let r=i.find(t=>!!t.folder&&t.folder.id===e.id);r||(r=yield this.buildMatchDirDBData(e),i.push(r)),r.parent=yield this.buildMatchDirParentsFromDBData(r,i),yield this.loadChildsFromDBData(r,i);for(const e of r.files)e.track&&t.includes(e.track.id)&&n.push(e);i.push(r),s.includes(r)||s.push(r);let a=r.parent;for(;a;)a.level>0&&!s.includes(a)&&s.push(a),a=a.parent}for(const e of n){const t=yield a.default.stat(e.name);e.stat={ctime:t.ctime.valueOf(),mtime:t.mtime.valueOf(),size:t.size}}for(const e of s){const t=yield a.default.stat(e.name);e.stat={ctime:t.ctime.valueOf(),mtime:t.mtime.valueOf()}}const o=i.find(e=>0===e.level);return o?{rootMatch:o,changedDirs:s}:Promise.reject(Error("Root Match not found"))}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(1),c=r(60),d=r(4),u=r(29);t.ArtworkWorker=class{constructor(e,t){this.store=e,this.imageModule=t}buildArtworkImageFile(e,t,r){return i(this,void 0,void 0,(function*(){const i=n.default.join(e.path,t),s=yield a.default.stat(i),o=c.generateArtworkId(e.id,t,s.size),d={id:o,name:t,types:u.artWorkImageNameToType(t),image:yield this.imageModule.getImageInfo(i),stat:{created:s.ctime.valueOf(),modified:s.mtime.valueOf(),size:s.size}};return e.tag.artworks=(e.tag.artworks||[]).filter(e=>e.id!==o&&e.id!==r),e.tag.artworks.push(d),yield this.store.folderStore.replace(e),yield this.imageModule.clearImageCacheByIDs([e.id,d.id].concat(r?[r]:[])),d}))}rename(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=yield this.store.folderStore.byId(e);if(!i)return Promise.reject(Error(`Folder ${e} not found`));const s=(i.tag.artworks||[]).find(e=>e.id===t);if(!s)return Promise.reject(Error(`Artwork ${t} not found`));if(d.containsFolderSystemChars(r))return Promise.reject(Error("Invalid Image File Name"));if(0===(r=d.replaceFolderSystemChars(r,"").trim()).length)return Promise.reject(Error("Invalid Image File Name"));const o=d.fileExt(s.name),c=r+o;yield a.default.rename(n.default.join(i.path,s.name),n.default.join(i.path,c)),yield this.buildArtworkImageFile(i,c,t)}))}create(e,t,r,s,c){return i(this,void 0,void 0,(function*(){const r=yield this.store.folderStore.byId(e);if(!r)return Promise.reject(Error(`Folder ${e} not found`));const i=o.FolderTypeImageName[r.tag.type];let s=d.fileSuffix(t);if(0===s.length){s=(yield this.imageModule.getImageInfo(t)).format}if(!s||0===s.length)return Promise.reject(Error("Image Format not known"));let c=`${i}.${s}`,u=2;for(;yield a.default.pathExists(n.default.join(r.path,c));)c=`${i}-${u}.${s}`,u++;const l=n.default.join(r.path,c);yield a.default.move(t,l),yield this.buildArtworkImageFile(r,c)}))}update(e,t,r,s,o){return i(this,void 0,void 0,(function*(){const i=yield this.store.folderStore.byId(e);if(!i)return Promise.reject(Error(`Folder ${e} not found`));const s=(i.tag.artworks||[]).find(e=>e.id===t);if(!s)return Promise.reject(Error(`Artwork ${t} not found`));const o=n.default.join(i.path,s.name);yield d.fileDeleteIfExists(o),yield a.default.move(r,o),yield this.buildArtworkImageFile(i,s.name,t)}))}download(e,t,r,s,a){return i(this,void 0,void 0,(function*(){const e=yield this.store.folderStore.byId(t);if(!e)return Promise.reject(Error(`Folder ${t} not found`));const i=s.sort((e,t)=>e.localeCompare(t)).join("-"),a=yield this.imageModule.storeImage(e.path,i,r);yield this.buildArtworkImageFile(e,a)}))}delete(e,t,r){return i(this,void 0,void 0,(function*(){const r=yield this.store.folderStore.byId(e);if(!r)return Promise.reject(Error(`Folder ${e} not found`));const i=(r.tag.artworks||[]).find(e=>e.id===t);if(!i)return Promise.reject(Error(`Artwork ${t} not found`));r.tag.artworks=(r.tag.artworks||[]).filter(e=>e.id!==i.id),yield this.store.folderStore.replace(r);const s=n.default.join(r.path,i.name);yield d.fileDeleteIfExists(s),yield this.imageModule.clearImageCacheByIDs([r.id,i.id])}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(1),n=r(59),o=r(233),c=r(234),d=r(238),u=r(2).logger("IO.ChangesWorker");t.ChangesWorker=class{constructor(e,t,r,i){this.store=e,this.audioModule=t,this.imageModule=r,this.settings=i}cleanChanges(e){return i(this,void 0,void 0,(function*(){let t=new Set,r=new Set;if(e.removedAlbums.length>0){u.debug("Removing Albums:",e.removedAlbums.length);const r=e.removedAlbums.map(e=>e.id);yield this.store.albumStore.remove(r),yield this.store.stateStore.removeByQuery({destIDs:r,type:s.DBObjectType.album}),t=new Set([...t,...r])}if(e.removedArtists.length>0){u.debug("Removing Artists:",e.removedArtists.length);const r=e.removedArtists.map(e=>e.id);yield this.store.artistStore.remove(r),yield this.store.stateStore.removeByQuery({destIDs:r,type:s.DBObjectType.artist}),t=new Set([...t,...r])}if(e.removedFolders.length>0){u.debug("Removing Folders:",e.removedFolders.length);const r=e.removedFolders.map(e=>e.id);yield this.store.folderStore.remove(r),yield this.store.stateStore.removeByQuery({destIDs:r,type:s.DBObjectType.folder}),t=new Set([...t,...r])}if(e.removedSeries.length>0){u.debug("Removing Series:",e.removedSeries.length);const r=e.removedSeries.map(e=>e.id);yield this.store.seriesStore.remove(r),yield this.store.stateStore.removeByQuery({destIDs:r,type:s.DBObjectType.series}),t=new Set([...t,...r])}if(e.removedTracks.length>0){u.debug("Removing Tracks:",e.removedTracks.length);const i=e.removedTracks.map(e=>e.id);t=new Set([...t,...i]),r=new Set([...r,...i]),yield this.store.trackStore.remove(i),yield this.store.stateStore.removeByQuery({destIDs:i,type:s.DBObjectType.track}),yield this.store.bookmarkStore.removeByQuery({destIDs:i});const a=yield this.store.playlistStore.search({trackIDs:i});if(a.items.length>0)for(const e of a.items){const t=e.trackIDs.length;e.trackIDs=e.trackIDs.filter(e=>!i.includes(e)),t!==e.trackIDs.length&&(u.debug("Updating Playlist:",e.name),yield n.updatePlayListTracks(this.store.trackStore,e),yield this.store.playlistStore.replace(e))}}if(e.updateAlbums.length>0){const r=e.updateAlbums.map(e=>e.id);t=new Set([...t,...r])}if(e.updateArtists.length>0){const r=e.updateArtists.map(e=>e.id);t=new Set([...t,...r])}if(e.updateFolders.length>0){const r=e.updateFolders.map(e=>e.id);t=new Set([...t,...r])}if(e.updateSeries.length>0){const r=e.updateSeries.map(e=>e.id);t=new Set([...t,...r])}if(e.updateTracks.length>0)for(const r of e.updateTracks)t.add(r.track.albumID),t.add(r.oldTrack.albumID);let i=[...t];i.length>0&&(u.debug("Cleaning Image Cache IDs:",i.length),yield this.imageModule.clearImageCacheByIDs(i)),i=[...r],i.length>0&&(u.debug("Cleaning Audio Cache IDs:",i.length),yield this.audioModule.clearCacheByIDs(i))}))}storeChanges(e){return i(this,void 0,void 0,(function*(){u.debug("Storing New Tracks:",e.newTracks.length),yield this.store.trackStore.bulk(e.newTracks),u.debug("Updating Tracks:",e.updateTracks.length),yield this.store.trackStore.upsert(e.updateTracks.map(e=>e.track)),u.debug("Storing New Folders:",e.newTracks.length),yield this.store.folderStore.bulk(e.newFolders),u.debug("Updating Folders:",e.updateFolders.length),yield this.store.folderStore.upsert(e.updateFolders),u.debug("Storing New Albums:",e.newTracks.length),yield this.store.albumStore.bulk(e.newAlbums),u.debug("Updating Albums:",e.updateAlbums.length),yield this.store.albumStore.upsert(e.updateAlbums),u.debug("Storing New Artists:",e.newTracks.length),yield this.store.artistStore.bulk(e.newArtists),u.debug("Updating Artists:",e.updateArtists.length),yield this.store.artistStore.upsert(e.updateArtists),u.debug("Storing New Series:",e.newTracks.length),yield this.store.seriesStore.bulk(e.newSeries),u.debug("Updating Series:",e.updateSeries.length),yield this.store.seriesStore.upsert(e.updateSeries)}))}mergeMatch(e,t,r,s,n){return i(this,void 0,void 0,(function*(){const i=new c.MatchDirMerge(this.audioModule,this.imageModule,this.store,this.settings,e.strategy||a.RootScanStrategy.auto);yield i.merge(t,e.id,r,s,n)}))}start(e){return i(this,void 0,void 0,(function*(){const t=yield this.store.rootStore.byId(e);return t?{root:t,changes:o.emptyChanges()}:Promise.reject(Error(`Root ${e} not found`))}))}finish(e,t,r){return i(this,void 0,void 0,(function*(){const i=new d.MetaMerger(this.store);return yield i.mergeMeta(r,t,e),yield this.storeChanges(e),yield this.cleanChanges(e),e.end=Date.now(),e}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyChanges=function(){return{newArtists:[],updateArtists:[],removedArtists:[],newAlbums:[],updateAlbums:[],removedAlbums:[],newTracks:[],updateTracks:[],removedTracks:[],newSeries:[],updateSeries:[],removedSeries:[],newFolders:[],updateFolders:[],removedFolders:[],start:Date.now(),end:0}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(235),a=r(2),n=r(236),o=r(19),c=a.logger("IO.MatchDirMerge");class d{constructor(e,t,r,i,s){this.audioModule=e,this.imageModule=t,this.store=r,this.settings=i,this.strategy=s,this.folderBuilder=new n.MatchDirMergeBuilder(e,r),this.tagBuilder=new n.MatchDirMergeTagBuilder(i,s,t)}static folderHasChanged(e){return!e.folder||e.stat.mtime!==e.folder.stat.modified||e.stat.ctime!==e.folder.stat.created||!s.deepCompare(e.folder.tag,e.tag)}static mergeRecursive(e,t){return i(this,void 0,void 0,(function*(){if(c.debug("Check For Changes:",e.name),d.folderHasChanged(e)){c.info("Folder Changed:",e.name);const r=n.MatchDirMergeBuilder.buildFolder(e);r.id=e.folder.id,e.folder=r,t.newFolders.find(e=>e.id===r.id)?(t.newFolders=t.newFolders.filter(e=>e.id!==r.id),t.newFolders.push(r)):t.updateFolders.push(r)}e.directories.length>0&&(yield o.processQueue(3,e.directories,e=>i(this,void 0,void 0,(function*(){yield d.mergeRecursive(e,t)}))))}))}merge(e,t,r,s,a){return i(this,void 0,void 0,(function*(){const t=yield this.folderBuilder.buildMerge(e,a,s);yield this.tagBuilder.buildMergeTags(t,r),yield d.mergeRecursive(t,a)}))}}t.MatchDirMerge=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deepCompare=function e(t,r,i){const s=i||[],a=(s,a)=>{if(void 0===t)return!1;if(void 0===r)return!1;if("object"==typeof s){if(!e(s,a,i))return!1}else if(s!==a)return!1;return!0};if(void 0===t)return!1;if(void 0===r)return!1;let n;for(n in t)if(t.hasOwnProperty(n)&&!s.includes(n)&&!a(t[n],r[n]))return!1;for(n in r)if(r.hasOwnProperty(n)&&!s.includes(n)&&!a(t[n],r[n]))return!1;return!0}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(0),o=r(1),c=r(60),d=r(4),u=r(2),l=r(19),m=r(29),p=r(237),f=u.logger("IO.MatchDirMergeBuilder");class y{constructor(e,t){this.audioModule=e,this.store=t}static trackHasChanged(e){return!e.track||e.stat.mtime!==e.track.stat.modified||e.stat.ctime!==e.track.stat.created||e.stat.size!==e.track.stat.size}static buildDefaultTag(e){return{level:e.level,type:o.FolderType.unknown,trackCount:e.files.filter(e=>e.type===o.FileTyp.AUDIO).length,folderCount:e.directories.length}}static buildFolder(e){return{id:"",rootID:e.rootID,path:d.ensureTrailingPathSeparator(e.name),parentID:e.parent&&e.parent.folder?e.parent.folder.id:void 0,stat:{created:e.stat.ctime,modified:e.stat.mtime},tag:e.tag||y.buildDefaultTag(e),type:n.DBObjectType.folder}}buildTrack(e,t){return i(this,void 0,void 0,(function*(){f.debug("Building Track:",e.name);const r=yield this.audioModule.read(e.name),i=r.tag||{format:o.TrackTagFormatType.none};return i.title=i.title||d.basenameStripExt(e.name),{id:"",rootID:e.rootID,albumID:"",artistID:"",albumArtistID:"",parentID:t?t.id:"",name:a.default.basename(e.name),path:d.ensureTrailingPathSeparator(a.default.dirname(e.name)),stat:{created:e.stat.ctime,modified:e.stat.mtime,size:e.stat.size},media:r.media||{},tag:i,type:n.DBObjectType.track}}))}buildMergeTrack(e,t,r,s){return i(this,void 0,void 0,(function*(){if(e.track){if(s||y.trackHasChanged(e)){const i=e.track;e.track=yield this.buildTrack(e,t),e.track.id=i.id,r.updateTracks.push({track:e.track,oldTrack:i})}}else e.track=yield this.buildTrack(e,t),e.track.id=yield this.store.trackStore.getNewId(),r.newTracks.push(e.track)}))}buildMerge(e,t,r){return i(this,void 0,void 0,(function*(){e.folder||(f.debug("Building Folder:",e.name),e.folder=y.buildFolder(e),e.folder.id=yield this.store.trackStore.getNewId(),t.newFolders.push(e.folder));for(const i of e.directories)yield this.buildMerge(i,t,r);if(e.folder){const s=e.files.filter(e=>e.type===o.FileTyp.AUDIO),a=e.folder;yield l.processQueue(3,s,e=>i(this,void 0,void 0,(function*(){yield this.buildMergeTrack(e,a,t,r)})))}return e}))}}t.MatchDirMergeBuilder=y;class h{constructor(e,t,r){this.settings=e,this.strategy=t,this.imageModule=r}static isExtraFolder(e){return!!a.default.basename(e.name).toLowerCase().match(/(\[(extra|various)]|^(extra|various)$)/)}static getMixedFolderType(e,t,r){return h.getMultiAlbumFolderType(e)}static getFolderType(e,t,r){if(0===e.level)return o.FolderType.collection;if(h.isExtraFolder(e))return o.FolderType.extras;if(t.trackCount>0){if(t.hasMultipleAlbums&&e.tag&&e.tag.albumType===o.AlbumType.series)return o.FolderType.artist;return e.directories.filter(e=>!!e.tag&&e.tag.type!==o.FolderType.extras).length>0?h.getMixedFolderType(e,t,r):o.FolderType.album}return 0===e.directories.length?0===e.files.filter(e=>e.type===o.FileTyp.AUDIO).length?o.FolderType.extras:o.FolderType.album:t.hasMultipleAlbums?t.hasMultipleArtists||r===o.RootScanStrategy.compilation?o.FolderType.collection:o.FolderType.artist:1===e.directories.length?r===o.RootScanStrategy.compilation?o.FolderType.collection:o.FolderType.artist:!t.hasMultipleArtists&&e.directories.filter(e=>e.tag&&e.tag.type===o.FolderType.artist).length>0?o.FolderType.artist:h.getMultiAlbumFolderType(e)}static getMultiAlbumFolderType(e){return e.directories.find(e=>!!e.tag&&e.tag.type===o.FolderType.artist)?o.FolderType.collection:o.FolderType.multialbum}static applyFolderTagType(e,t){if(!e.tag||!e.metaStat)return;const r=h.getFolderType(e,e.metaStat,t);h.setFolderTagType(e.tag,r),r===o.FolderType.multialbum?h.markMultiAlbumChildDirs(e):r===o.FolderType.artist&&e.directories.forEach(h.markArtistChildDirs)}static markMultiAlbumChildDirs(e){e.tag&&e.tag.type!==o.FolderType.extras&&h.setFolderTagType(e.tag,o.FolderType.multialbum),e.directories.forEach(t=>{e.tag&&t.tag&&t.tag.type!==o.FolderType.extras&&(e.tag.albumType=t.tag.albumType),h.markMultiAlbumChildDirs(t)})}static markArtistChildDirs(e){e.tag&&e.tag.type===o.FolderType.artist&&h.setFolderTagType(e.tag,o.FolderType.collection),e.directories.forEach(e=>{h.markArtistChildDirs(e)})}static setFolderTagType(e,t){switch(e.type=t,t){case o.FolderType.collection:e.albumType=void 0,e.mbArtistID=void 0,e.mbReleaseID=void 0,e.mbAlbumType=void 0,e.mbReleaseGroupID=void 0,e.artist=void 0,e.artistSort=void 0,e.album=void 0,e.year=void 0;break;case o.FolderType.artist:e.mbReleaseID=void 0,e.mbAlbumType=void 0,e.mbReleaseGroupID=void 0,e.album=void 0,e.year=void 0}}static splitDirectoryName(e){const t={title:a.default.basename(e).trim()},r=t.title.split(" "),i=r[0].replace(/[^\w\s]/gi,"");if(4===i.length){const e=Number(i);isNaN(e)||(t.year=e,r.shift(),"-"===r[0]&&r.shift(),t.title=r.join(" "))}return t}buildFolderTag(e){return i(this,void 0,void 0,(function*(){const t=e.metaStat;if(!t)throw Error("internal error, metastat must exist");const r=h.splitDirectoryName(e.name);return{trackCount:t.trackCount,folderCount:e.directories.length,level:e.level,type:o.FolderType.unknown,album:t.album,albumType:t.albumType,albumTrackCount:(t.subFolderTrackCount||0)+t.trackCount,artist:t.artist,artistSort:t.artistSort,title:r.title,artworks:yield this.buildFolderArtworks(e),genres:t.genres,mbReleaseID:t.mbReleaseID,mbReleaseGroupID:t.mbReleaseGroupID,mbAlbumType:t.mbAlbumType,mbArtistID:t.mbArtistID,year:void 0!==r.year&&r.year>0?r.year:t.year}}))}buildFolderArtwork(e,t){return i(this,void 0,void 0,(function*(){const r=a.default.basename(e.name);return{id:c.generateArtworkId(t,r,e.stat.size),name:r,types:m.artWorkImageNameToType(r),image:yield this.imageModule.getImageInfo(e.name),stat:{created:e.stat.ctime,modified:e.stat.mtime,size:e.stat.size}}}))}buildFolderArtworks(e){return i(this,void 0,void 0,(function*(){const t=e.files.filter(e=>e.type===o.FileTyp.IMAGE),r=[],i=e.folder&&e.folder.tag&&e.folder.tag.artworks?e.folder.tag.artworks:[];for(const s of t){const t=a.default.basename(s.name),n=i.find(e=>e.name===t);n&&n.stat.modified===s.stat.mtime?r.push(n):r.push(yield this.buildFolderArtwork(s,e.folder.id))}return r}))}buildMergeTags(e,t){return i(this,void 0,void 0,(function*(){for(const r of e.directories)yield this.buildMergeTags(r,t);t(e)&&(e.metaStat=p.MatchDirMetaStats.buildMetaStat(e,this.settings,this.strategy),e.tag=yield this.buildFolderTag(e)),h.applyFolderTagType(e,this.strategy)}))}}t.MatchDirMergeTagBuilder=h},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(r(3)),a=r(1),n=r(61),o=r(62),c={audiobook:a.AlbumType.audiobook,"audio theater":a.AlbumType.audiobook,"audio drama":a.AlbumType.audiobook,"audio series":a.AlbumType.audiobook,soundtrack:a.AlbumType.soundtrack},d=[{type:a.AlbumType.audiobook,names:["audiobook","spokenword","audiodrama","audio drama","audio theater","audio series"]},{type:a.AlbumType.bootleg,names:["bootleg"]},{type:a.AlbumType.compilation,names:["compilation"]},{type:a.AlbumType.live,names:["live"]},{type:a.AlbumType.soundtrack,names:["soundtrack"]},{type:a.AlbumType.ep,names:["ep"]},{type:a.AlbumType.single,names:["single"]},{type:a.AlbumType.album,names:["album"]}];class u{static getGenreAlbumType(e){return c[e.toLowerCase()]||a.AlbumType.unknown}static getMusicbrainzAlbumType(e){const t=e.toLowerCase();for(const e of d)for(const r of e.names)if(t.includes(r))return e.type;return a.AlbumType.unknown}static getStrategyAlbumType(e,t){switch(e){case a.RootScanStrategy.auto:return t?a.AlbumType.compilation:a.AlbumType.album;case a.RootScanStrategy.artistalbum:return a.AlbumType.album;case a.RootScanStrategy.compilation:return a.AlbumType.compilation;case a.RootScanStrategy.audiobook:return a.AlbumType.audiobook;default:return a.AlbumType.unknown}}static buildTrackSlugs(e,t){if(!e||!e.tag)return;const r=e.tag;t.statSlugValue("artist",r.albumArtist||r.artist),t.statSlugValue("artistSort",r.albumArtistSort||r.artistSort),t.statSlugValue("genre",r.genre),t.statSlugValue("series",r.series),t.statSlugValue("album",r.album?n.extractAlbumName(r.album):void 0),t.statNumber("year",r.year),t.statTrackCount("albumTrackCount",r.trackTotal,r.disc),t.statSlugValue("mbAlbumType",`${r.mbAlbumType||""}/${r.mbAlbumStatus||""}`),t.statID("mbArtistID",r.mbArtistID),t.statID("mbReleaseID",r.mbReleaseID),t.statID("mbReleaseGroupID",r.mbReleaseGroupID)}static buildTracksSlugs(e,t){let r=0;for(const i of e.files)i.type===a.FileTyp.AUDIO&&(r++,u.buildTrackSlugs(i.track,t));return r}static buildSubFolderSlugs(e,t){if(t.statSlugValue("artist",e.artist),t.statSlugValue("artistSort",e.artistSort),t.statSlugValue("album",e.album?n.extractAlbumName(e.album):void 0),e.genres)for(const r of e.genres)t.statSlugValue("genre",r);return t.statNumber("year",e.year),t.statSlugValue("mbAlbumType",e.mbAlbumType),t.statID("mbArtistID",e.mbArtistID),t.statID("mbReleaseID",e.mbReleaseID),t.statID("mbReleaseGroupID",e.mbReleaseGroupID),e.albumTrackCount||0}static buildSubFoldersSlugs(e,t){let r=0;for(const i of e.directories)i.folder&&i.tag&&i.tag.type!==a.FolderType.extras&&(r+=u.buildSubFolderSlugs(i.tag,t));return r>0?r:void 0}static getAlbumInfo(e,t){const r=e.mostUsed("artist",a.MUSICBRAINZ_VARIOUS_ARTISTS_NAME),i=e.mostUsed("genre"),s=e.mostUsed("mbAlbumType",""),n=r===a.MUSICBRAINZ_VARIOUS_ARTISTS_NAME;let o=a.AlbumType.unknown;if(i&&(o=u.getGenreAlbumType(i)),s&&o===a.AlbumType.unknown&&(o=u.getMusicbrainzAlbumType(s)),o===a.AlbumType.unknown&&(o=u.getStrategyAlbumType(t,n)),o===a.AlbumType.audiobook){e.mostUsed("series")&&(o=a.AlbumType.series)}return{albumType:o,artist:r,hasMultipleArtists:n,mbAlbumType:s,genres:e.asStringList("genre")}}static buildMetaStat(e,t,r){const i=new o.MetaStatBuilder,a=u.buildTracksSlugs(e,i),c=u.buildSubFoldersSlugs(e,i),{albumType:d,artist:l,hasMultipleArtists:m,mbAlbumType:p,genres:f}=u.getAlbumInfo(i,r);return{trackCount:a,subFolderTrackCount:c,albumType:d,genres:f,artist:l,hasMultipleArtists:m,mbAlbumType:p,hasMultipleAlbums:i.asList("album").length>1,album:i.mostUsed("album",n.extractAlbumName(s.default.basename(e.name))),artistSort:m?void 0:i.mostUsed("artistSort"),mbReleaseID:i.mostUsed("mbReleaseID",""),mbReleaseGroupID:i.mostUsed("mbReleaseGroupID",""),mbArtistID:i.mostUsed("mbArtistID",""),year:i.mostUsedNumber("year")}}}t.MatchDirMetaStats=u},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),a=r(2),n=r(27),o=r(62),c=r(239),d=a.logger("IO.MetaMerger");t.MetaMerger=class{constructor(e){this.store=e,this.cache=new c.MetaMergerCache(e)}addMeta(e,t){return i(this,void 0,void 0,(function*(){if(!e.parent)return;const r=yield this.cache.findOrCreateArtist(e,!1,t);e.track.artistID=r.id;const i=e.parent.tag.artist===s.MUSICBRAINZ_VARIOUS_ARTISTS_NAME?yield this.cache.findOrCreateCompilationArtist(t):yield this.cache.findOrCreateArtist(e,!0,t);e.track.albumArtistID=i.id;const a=yield this.cache.findOrCreateAlbum(e,i.id,t);if(e.track.albumID=a.id,e.track.tag.series){const s=yield this.cache.findOrCreateSeries(e,i.id,i.name,a.id,t);s&&(e.track.seriesID=s.id,a.seriesID=s.id,r.seriesIDs.includes(s.id)||r.seriesIDs.push(s.id))}}))}removeMeta(e,t){return i(this,void 0,void 0,(function*(){if(e.seriesID){const r=yield this.cache.getSeriesByID(e.seriesID,t);r&&!t.updateSeries.includes(r)&&t.updateSeries.push(r)}let r=yield this.cache.getArtistByID(e.artistID,t);r&&!t.updateArtists.includes(r)&&t.updateArtists.push(r),e.artistID!==e.albumArtistID&&(r=yield this.cache.getArtistByID(e.albumArtistID,t),r&&!t.updateArtists.includes(r)&&t.updateArtists.push(r));const i=yield this.cache.getAlbumByID(e.albumID,t);i&&!t.updateAlbums.includes(i)&&t.updateAlbums.push(i)}))}collectNewTrackInfos(e){return i(this,void 0,void 0,(function*(){const t=[];for(const r of e.newTracks){const i=yield this.cache.getFolderByID(r.parentID,e);i&&t.push({track:r,parent:i})}return t}))}collectUpdateTrackInfos(e){return i(this,void 0,void 0,(function*(){const t=[];for(const r of e.updateTracks){const i=yield this.cache.getFolderByID(r.track.parentID,e);i&&t.push({track:r.track,oldTrack:r.oldTrack,parent:i})}return t}))}collectAll(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.artistStore.searchIDs({rootID:e});for(const e of r)yield this.cache.getArtistByID(e,t);const i=yield this.store.albumStore.searchIDs({rootID:e});for(const e of i)yield this.cache.getAlbumByID(e,t);const s=yield this.store.seriesStore.searchIDs({rootID:e});for(const e of s)yield this.cache.getSeriesByID(e,t)}))}refreshArtistTracks(e,t,r,s){return i(this,void 0,void 0,(function*(){let i=yield this.store.trackStore.searchIDs({artistID:e.id});const a=yield this.store.trackStore.searchIDs({albumArtistID:e.id});for(const e of a)i.includes(e)||i.push(e);i=i.filter(e=>!t.includes(e));let n=r.filter(t=>t.oldTrack.artistID===e.id&&t.track.artistID!==e.id).map(e=>e.track.id);i=i.filter(e=>!n.includes(e)),n=r.filter(t=>t.oldTrack.albumArtistID===e.id&&t.track.albumArtistID!==e.id).map(e=>e.track.id),i=i.filter(e=>!n.includes(e));const o=r.filter(t=>t.track.artistID===e.id||t.track.albumArtistID===e.id).concat(s.filter(t=>t.track.artistID===e.id||t.track.albumArtistID===e.id));return(yield this.store.trackStore.byIds(i)).concat(o.map(e=>e.track))}))}refreshArtistAlbums(e,t){return i(this,void 0,void 0,(function*(){let r=yield this.store.albumStore.searchIDs({artistID:e.id});r=r.filter(e=>!t.removedAlbums.find(t=>t.id===e));const i=t.updateAlbums.filter(t=>t.artistID===e.id).concat(t.newAlbums.filter(t=>t.artistID===e.id));r=r.filter(e=>!i.find(t=>t.id===e));const s=yield this.store.albumStore.byIds(r);return i.concat(s)}))}refreshArtist(e,t,r,a,c){return i(this,void 0,void 0,(function*(){d.debug("Refreshing Artist:",e.name);const i=yield this.refreshArtistTracks(e,r,a,c);if(0===i.length)return void(t.newArtists.includes(e)?d.error("new artist without tracks",e):t.removedArtists.push(e));const u=new o.MetaStatBuilder,l=new Set,m=new Set,p=new Set,f=new Set;for(const t of i)t.artistID===e.id&&(u.statSlugValue("artist",t.tag.artist),u.statSlugValue("artistSort",t.tag.artistSort)),t.albumArtistID===e.id&&(u.statSlugValue("artist",t.tag.albumArtist),u.statSlugValue("artistSort",t.tag.albumArtistSort)),u.statSlugValue("genre",t.tag.genre),l.add(t.rootID),m.add(t.parentID),p.add(t.id),t.seriesID&&f.add(t.seriesID);if(e.rootIDs=[...l],e.trackIDs=[...p],e.folderIDs=[...m],e.seriesIDs=[...f],e.genres=u.asStringList("genre"),e.name!==s.MUSICBRAINZ_VARIOUS_ARTISTS_NAME){const t=u.mostUsed("artist")||s.cUnknownArtist;e.name=t,e.slug=n.slugify(t),e.nameSort=u.mostUsed("artistSort")}const y=yield this.refreshArtistAlbums(e,t),h=new Set,g=new Set;for(const e of y)h.add(e.id),g.add(e.albumType);e.albumIDs=[...h],e.albumTypes=[...g],t.newArtists.includes(e)||t.updateArtists.push(e)}))}refreshArtists(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=e.updateArtists.concat(e.newArtists);e.removedArtists=[],e.updateArtists=[];for(const a of i)yield this.refreshArtist(a,e,t,r,s)}))}refreshSeriesTracks(e,t,r,s,a){return i(this,void 0,void 0,(function*(){let i=yield this.store.trackStore.searchIDs({seriesID:e.id});i=i.filter(e=>!r.includes(e));const n=s.filter(t=>t.oldTrack.seriesID===e.id&&t.track.seriesID!==e.id).map(e=>e.track.id);i=i.filter(e=>!n.includes(e));const o=s.filter(t=>t.track&&t.track.seriesID===e.id).concat(a.filter(t=>t.track.seriesID===e.id)),c=o.map(e=>e.track.id);i=i.filter(e=>!c.includes(e));const d=yield this.store.trackStore.byIds(i);for(const e of d){const r=yield this.cache.getFolderByID(e.parentID,t);r&&o.push({track:e,parent:r})}return o}))}refreshSeriesAlbums(e,t){return i(this,void 0,void 0,(function*(){let r=yield this.store.albumStore.searchIDs({seriesID:e.id});r=r.filter(e=>!t.removedAlbums.find(t=>t.id===e));const i=t.updateAlbums.filter(t=>t.seriesID===e.id).concat(t.newAlbums.filter(t=>t.seriesID===e.id));r=r.filter(e=>!i.find(t=>t.id===e));const s=yield this.store.albumStore.byIds(r);return i.concat(s)}))}refreshSeries(e,t,r,s,a){return i(this,void 0,void 0,(function*(){d.debug("Refreshing Series:",e.name);const i=yield this.refreshSeriesTracks(e,t,r,s,a);if(0===i.length)return void(t.newSeries.includes(e)?console.error("new series without tracks",e):t.removedSeries.push(e));const n=new Set,o=new Set,c=new Set,u=new Set;for(const e of i){const t=e.track;n.add(t.rootID),c.add(t.parentID),u.add(t.albumID),o.add(t.id)}const l=yield this.refreshSeriesAlbums(e,t),m=new Set;for(const e of l)m.add(e.albumType);const p=yield this.cache.getArtistByID(e.artistID,t);p&&(e.artist=p.name),e.rootIDs=[...n],e.trackIDs=[...o],e.folderIDs=[...c],e.albumIDs=[...u],e.albumTypes=[...m],t.newSeries.includes(e)||t.updateSeries.push(e)}))}refreshSerieses(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=e.updateSeries.concat(e.newSeries);e.removedSeries=[],e.updateSeries=[];for(const a of i)yield this.refreshSeries(a,e,t,r,s)}))}refreshAlbumTracks(e,t,r,s,a){return i(this,void 0,void 0,(function*(){let i=yield this.store.trackStore.searchIDs({albumID:e.id});i=i.filter(e=>!r.includes(e));const n=s.filter(t=>t.oldTrack.albumID===e.id&&t.track.albumID!==e.id).map(e=>e.track.id);i=i.filter(e=>!n.includes(e));const o=s.filter(t=>t.track&&t.track.albumID===e.id).concat(a.filter(t=>t.track.albumID===e.id)),c=o.map(e=>e.track.id);i=i.filter(e=>!c.includes(e));const d=yield this.store.trackStore.byIds(i);for(const e of d){const r=yield this.cache.getFolderByID(e.parentID,t);r&&o.push({track:e,parent:r})}return o}))}refreshAlbum(e,t,r,a,n){return i(this,void 0,void 0,(function*(){d.debug("Refreshing Album:",e.name);const i=yield this.refreshAlbumTracks(e,t,r,a,n);if(0===i.length)return void(t.removedAlbums.includes(e)?console.error("new album without tracks",e):t.removedAlbums.push(e));let u=0;const l=new Set,m=new Set,p=new Set,f=new o.MetaStatBuilder;for(const e of i){const t=e.track;l.add(t.rootID),m.add(t.parentID),p.add(t.id),f.statSlugValue("artist",t.tag.albumArtist||t.tag.artist),f.statID("mbArtistID",t.tag.mbAlbumArtistID||t.tag.mbArtistID),f.statID("mbReleaseID",t.tag.mbReleaseID),f.statSlugValue("genre",t.tag.genre),f.statSlugValue("seriesNr",t.tag.seriesNr),f.statSlugValue("series",t.tag.series),f.statNumber("year",t.tag.year),u+=t.media.duration||0,f.statSlugValue("name",c.getAlbumName(e)),f.statID("albumType",e.parent&&e.parent.tag&&void 0!==e.parent.tag.albumType?e.parent.tag.albumType:void 0)}e.rootIDs=[...l],e.trackIDs=[...p],e.folderIDs=[...m],e.artist=f.mostUsed("artist")||s.cUnknownArtist,e.name=f.mostUsed("name")||s.cUnknownAlbum,e.seriesNr=f.mostUsed("seriesNr"),e.mbArtistID=f.mostUsed("mbArtistID"),e.mbReleaseID=f.mostUsed("mbReleaseID"),e.genres=f.asStringList("genre"),e.series=f.mostUsed("series"),e.year=f.mostUsedNumber("year"),e.albumType=f.mostUsed("albumType")||s.AlbumType.unknown,e.duration=u,t.newAlbums.includes(e)||t.updateAlbums.push(e)}))}refreshAlbums(e,t,r,s){return i(this,void 0,void 0,(function*(){const i=e.updateAlbums.concat(e.newAlbums);e.removedAlbums=[],e.updateAlbums=[];for(const a of i)yield this.refreshAlbum(a,e,t,r,s)}))}mergeMeta(e,t,r){return i(this,void 0,void 0,(function*(){const i=yield this.collectNewTrackInfos(r),s=yield this.collectUpdateTrackInfos(r);for(const e of i)yield this.addMeta(e,r);for(const e of r.removedTracks)yield this.removeMeta(e,r);for(const e of s)yield this.removeMeta(e.oldTrack,r),yield this.addMeta(e,r);e&&(yield this.collectAll(t,r));const a=r.removedTracks.map(e=>e.id);yield this.refreshAlbums(r,a,s,i),yield this.refreshArtists(r,a,s,i),yield this.refreshSerieses(r,a,s,i)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(1),n=r(61),o=r(27);function c(e){return e.parent&&e.parent.tag.albumType===a.AlbumType.compilation?e.parent.tag.album||a.cUnknownAlbum:n.extractAlbumName(e.track.tag.album||a.cUnknownAlbum)}function d(e){return o.slugify(c(e))}t.getAlbumName=c,t.getAlbumSlug=d;t.MetaMergerCache=class{constructor(e){this.store=e,this.artistCache=[],this.seriesCache=[],this.albumCache=[],this.folderCache=[]}buildSeries(e,t,r){return i(this,void 0,void 0,(function*(){return{id:yield this.store.seriesStore.getNewId(),type:s.DBObjectType.series,name:e.track.tag.series||"",albumTypes:e.parent&&e.parent.tag&&void 0!==e.parent.tag.albumType?[e.parent.tag.albumType]:[a.AlbumType.unknown],artistID:t,artist:r,folderIDs:[],albumIDs:[],trackIDs:[],rootIDs:[],created:Date.now()}}))}findSeriesInDB(e,t){return i(this,void 0,void 0,(function*(){return this.store.seriesStore.searchOne({name:e.track.tag.series,artistID:t})}))}findSeriesInCache(e,t){return i(this,void 0,void 0,(function*(){if(e.track.tag.series)return this.seriesCache.find(r=>r.name===e.track.tag.series&&r.artistID===t)}))}getSeriesByID(e,t){return i(this,void 0,void 0,(function*(){let r=this.seriesCache.find(t=>t.id===e);return r||(r=yield this.store.seriesStore.byId(e),r&&(this.seriesCache.push(r),t&&t.updateSeries.push(r)),r)}))}findOrCreateSeries(e,t,r,s,a){return i(this,void 0,void 0,(function*(){let i=yield this.findSeriesInCache(e,t);return i||(i=yield this.findSeriesInDB(e,t),i?a.updateSeries.push(i):(i=yield this.buildSeries(e,t,r),a.newSeries.push(i)),this.seriesCache.push(i),i)}))}buildAlbum(e,t){return i(this,void 0,void 0,(function*(){return{id:yield this.store.albumStore.getNewId(),type:s.DBObjectType.album,slug:d(e),name:c(e),albumType:e.parent&&e.parent.tag&&void 0!==e.parent.tag.albumType?e.parent.tag.albumType:a.AlbumType.unknown,artist:e.track.tag.albumArtist||e.track.tag.artist||a.cUnknownArtist,artistID:t,mbArtistID:e.track.tag.mbAlbumArtistID||e.track.tag.mbArtistID,mbReleaseID:e.track.tag.mbReleaseID,series:e.track.tag.series,seriesNr:e.track.tag.seriesNr,genres:[],folderIDs:[],trackIDs:[],rootIDs:[],year:e.track.tag.year,duration:e.track.media.duration||0,created:Date.now()}}))}findAlbumInDB(e,t){return i(this,void 0,void 0,(function*(){if(e.track.tag.mbReleaseID){const t=yield this.store.albumStore.searchOne({mbReleaseID:e.track.tag.mbReleaseID});if(t)return t}return this.store.albumStore.searchOne({slug:d(e),artistID:t})}))}findAlbumInCache(e,t){return i(this,void 0,void 0,(function*(){if(e.track.tag.mbReleaseID){const t=this.albumCache.find(t=>t.mbReleaseID===e.track.tag.mbReleaseID);if(t)return t}const r=c(e);return this.albumCache.find(e=>e.name===r&&e.artistID===t)}))}getAlbumByID(e,t){return i(this,void 0,void 0,(function*(){let r=this.albumCache.find(t=>t.id===e);return r||(r=yield this.store.albumStore.byId(e),r&&(this.albumCache.push(r),t&&t.updateAlbums.push(r)),r)}))}findOrCreateAlbum(e,t,r){return i(this,void 0,void 0,(function*(){let i=yield this.findAlbumInCache(e,t);return i||(i=yield this.findAlbumInDB(e,t),i?r.updateAlbums.push(i):(i=yield this.buildAlbum(e,t),r.newAlbums.push(i)),this.albumCache.push(i),i)}))}buildArtist(e,t){return i(this,void 0,void 0,(function*(){let r={mbArtistID:e.track.tag.mbArtistID,name:e.track.tag.artist,nameSort:e.track.tag.artistSort};return t&&(e.track.tag.mbAlbumArtistID||e.track.tag.albumArtist)&&(r={mbArtistID:e.track.tag.mbAlbumArtistID,name:e.track.tag.albumArtist,nameSort:e.track.tag.albumArtistSort}),r.name=r.name||a.cUnknownArtist,{id:yield this.store.artistStore.getNewId(),type:s.DBObjectType.artist,rootIDs:[],slug:o.slugify(r.name),name:r.name,nameSort:r.nameSort,mbArtistID:r.mbArtistID,albumTypes:[],seriesIDs:[],albumIDs:[],folderIDs:[],trackIDs:[],created:Date.now()}}))}findArtistInDB(e,t){return i(this,void 0,void 0,(function*(){const r=t&&e.track.tag.mbAlbumArtistID||e.track.tag.mbArtistID;if(r){const e=yield this.store.artistStore.searchOne({mbArtistID:r});if(e)return e}const i=o.slugify(t&&e.track.tag.albumArtist||e.track.tag.artist||a.cUnknownArtist);return this.store.artistStore.searchOne({slug:i})}))}findArtistInCache(e,t){return i(this,void 0,void 0,(function*(){let r={mbArtistID:e.track.tag.mbArtistID,name:e.track.tag.artist};t&&(e.track.tag.mbAlbumArtistID||e.track.tag.albumArtist)&&(r={mbArtistID:e.track.tag.mbAlbumArtistID,name:e.track.tag.albumArtist});const i=o.slugify(r.name||a.cUnknownArtist);if(r.mbArtistID){const e=this.artistCache.find(e=>e.artist.mbArtistID===r.mbArtistID);if(e)return e.artist}const s=this.artistCache.find(e=>e.slugs.includes(i));if(s)return!s.artist.mbArtistID&&r.mbArtistID&&(s.artist.mbArtistID=r.mbArtistID),s.artist}))}getArtistByID(e,t){return i(this,void 0,void 0,(function*(){const r=this.artistCache.find(t=>t.artist.id===e);if(r)return r.artist;const i=yield this.store.artistStore.byId(e);return i&&(this.artistCache.push({artist:i,slugs:[i.slug]}),t.updateArtists.push(i)),i}))}findCompilationArtist(e){return i(this,void 0,void 0,(function*(){const t=this.artistCache.find(e=>e.artist.mbArtistID===a.MUSICBRAINZ_VARIOUS_ARTISTS_ID);if(t)return t.artist;const r=yield this.store.artistStore.searchOne({mbArtistID:a.MUSICBRAINZ_VARIOUS_ARTISTS_ID});return r&&(e.updateArtists.push(r),this.artistCache.push({artist:r,slugs:[r.slug]})),r}))}findOrCreateCompilationArtist(e){return i(this,void 0,void 0,(function*(){let t=yield this.findCompilationArtist(e);return t||(t={id:yield this.store.artistStore.getNewId(),type:s.DBObjectType.artist,rootIDs:[],slug:o.slugify(a.MUSICBRAINZ_VARIOUS_ARTISTS_NAME),name:a.MUSICBRAINZ_VARIOUS_ARTISTS_NAME,mbArtistID:a.MUSICBRAINZ_VARIOUS_ARTISTS_ID,albumTypes:[a.AlbumType.compilation],seriesIDs:[],folderIDs:[],albumIDs:[],trackIDs:[],created:Date.now()},e.newArtists.push(t),this.artistCache.push({artist:t,slugs:[t.slug]}),t)}))}findOrCreateArtist(e,t,r){return i(this,void 0,void 0,(function*(){let i=yield this.findArtistInCache(e,t);if(i)return i;if(i=yield this.findArtistInDB(e,t),i)r.updateArtists.push(i);else{if((t&&e.track.tag.albumArtist||e.track.tag.artist||a.cUnknownArtist)===a.MUSICBRAINZ_VARIOUS_ARTISTS_NAME)return this.findOrCreateCompilationArtist(r);i=yield this.buildArtist(e,t),r.newArtists.push(i)}return this.artistCache.push({artist:i,slugs:[i.slug]}),i}))}getFolderByID(e,t){return i(this,void 0,void 0,(function*(){let r=t.newFolders.find(t=>t.id===e);return r||(r=t.updateFolders.find(t=>t.id===e)),r||(r=this.folderCache.find(t=>t.id===e)),r||(r=yield this.store.folderStore.byId(e),r&&this.folderCache.push(r)),r}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(0),c=r(1),d=r(4);class u{constructor(e){this.store=e}static validateFolderName(e){return i(this,void 0,void 0,(function*(){if(d.containsFolderSystemChars(e))return Promise.reject(Error("Invalid Directory Name"));const t=d.replaceFolderSystemChars(e,"").trim();return 0===t.length||[".",".."].includes(t)?Promise.reject(Error("Invalid Directory Name")):t}))}static validateFolderTask(e,t,r){return i(this,void 0,void 0,(function*(){if(!(yield a.default.pathExists(e)))return Promise.reject(Error("Directory does not exists"));const i=n.default.join(t,r);return(yield a.default.pathExists(i))?Promise.reject(Error("Folder name already used in Destination")):void 0}))}static buildNewFolder(e,t){return i(this,void 0,void 0,(function*(){const r=yield a.default.stat(e);return{id:"",type:o.DBObjectType.folder,rootID:t.rootID,path:d.ensureTrailingPathSeparator(e),parentID:t.id,stat:{created:r.ctime.valueOf(),modified:r.mtime.valueOf()},tag:{level:t.tag.level+1,trackCount:0,folderCount:0,type:c.FolderType.extras}}}))}updatePaths(e,t,r){return i(this,void 0,void 0,(function*(){t=d.ensureTrailingPathSeparator(t),e=d.ensureTrailingPathSeparator(e);const i=(yield this.store.folderStore.search({inPath:e})).items;for(const s of i)s.path=s.path.replace(d.ensureTrailingPathSeparator(e),d.ensureTrailingPathSeparator(t)),s.rootID=r;yield this.store.folderStore.replaceMany(i);const s=(yield this.store.trackStore.search({inPath:e})).items;for(const i of s)i.path=i.path.replace(d.ensureTrailingPathSeparator(e),d.ensureTrailingPathSeparator(t)),i.rootID=r;return yield this.store.trackStore.replaceMany(s),{changedFolderIDs:new Set(i.map(e=>e.id)),changedTrackIDs:new Set(s.map(e=>e.id))}}))}moveFolder(e,t){return i(this,void 0,void 0,(function*(){if(e.parentID===t.id)return Promise.reject(Error("Folder name already used in Destination"));const r=t.path,i=n.default.basename(e.path),s=e.path,o=n.default.join(r,i);yield u.validateFolderTask(s,r,i);try{yield a.default.move(e.path,o)}catch(e){return Promise.reject(Error("Folder moving failed"))}return e.path=d.ensureTrailingPathSeparator(o),e.rootID=t.rootID,e.parentID=t.id,yield this.store.folderStore.replace(e),this.updatePaths(s,o,t.rootID)}))}move(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.folderStore.byId(e);if(!r)return Promise.reject(Error("Destination Folder not found"));if(t.includes(e))return Promise.reject(Error("Folder cannot be moved to itself"));let i=new Set,s=new Set;i.add(r.id);for(const e of t){i.add(e);const t=yield this.store.folderStore.byId(e);if(!t)return Promise.reject(Error("Source Folder not found"));t.parentID&&i.add(t.parentID);const a=yield this.moveFolder(t,r);i=new Set([...i,...a.changedFolderIDs]),s=new Set([...s,...a.changedTrackIDs])}return{changedFolderIDs:[...i],changedTrackIDs:[...s]}}))}rename(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.folderStore.byId(e);if(!r)return Promise.reject(Error("Folder not found"));const i=yield u.validateFolderName(t),s=n.default.dirname(r.path),o=n.default.join(s,i);yield u.validateFolderTask(r.path,s,i);try{yield a.default.rename(r.path,o)}catch(e){return Promise.reject(Error("Folder renaming failed"))}return yield this.updatePaths(r.path,o,r.rootID),r.path=d.ensureTrailingPathSeparator(o),{changedFolderIDs:[],changedTrackIDs:[]}}))}create(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.folderStore.byId(e);if(!r)return Promise.reject(Error("Destination Folder not found"));t=yield u.validateFolderName(t);const i=n.default.join(r.path,t);yield u.validateFolderTask(r.path,r.path,t),yield a.default.mkdir(i);const s=yield u.buildNewFolder(i,r);return r.tag.folderCount+=1,{folder:s,parent:r}}))}delete(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.folderStore.byIds(t);for(const e of r)if(0===e.tag.level)return Promise.reject(Error("Root folder can not be deleted"));const i=r.map(e=>e.path),s=(yield this.store.folderStore.search({inPaths:i})).items,o=n.default.join(e.path,".trash");for(const e of r)yield a.default.move(e.path,n.default.join(o,`${Date.now()}_${n.default.basename(e.path)}`));const c=(yield this.store.trackStore.search({inPaths:i})).items,d=new Set;for(const e of r)e.parentID&&d.add(e.parentID);return{removedFolders:s,removedTracks:c,changedFolderIDs:[...d],changedTrackIDs:[]}}))}}t.FolderWorker=u},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),a=r(242),n=r(243);t.RootWorker=class{constructor(e){this.store=e}checkUsedPath(e){return i(this,void 0,void 0,(function*(){const t=yield this.store.rootStore.all();for(const r of t)if(e.startsWith(r.path)||r.path.startsWith(e))return Promise.reject(Error("Root path already used"))}))}remove(e){return i(this,void 0,void 0,(function*(){const t=(yield this.store.trackStore.search({rootID:e.id})).items,r=(yield this.store.folderStore.search({rootID:e.id})).items;return yield this.store.rootStore.remove(e.id),{removedTracks:t,removedFolders:r}}))}scan(e){return i(this,void 0,void 0,(function*(){const t=new n.DirScanner,r=yield t.scan(e.path,e.id);return new a.MatchDirBuilderScan(this.store).match(r)}))}create(e,t,r){return i(this,void 0,void 0,(function*(){const i={id:"",created:Date.now(),type:s.DBObjectType.root,name:e,path:t,strategy:r};return yield this.addRoot(i),i}))}addRoot(e){return i(this,void 0,void 0,(function*(){return yield this.checkUsedPath(e.path),e.id=yield this.store.rootStore.add(e),e.id}))}update(e,t,r,s){return i(this,void 0,void 0,(function*(){e.name=t,e.path!==r&&(yield this.checkUsedPath(r),e.path=r),e.strategy=s,yield this.store.rootStore.replace(e)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(3)),n=r(2).logger("IO.MatchDirBuilderScan");t.MatchDirBuilderScan=class{constructor(e){this.store=e}cloneScanDir(e,t,r){const i={rootID:e.rootID,parent:t,level:r,name:e.name,stat:e.stat,folder:void 0,files:e.files.map(t=>({name:t.name,type:t.type,stat:t.stat,rootID:e.rootID})),directories:[]};return i.directories=e.directories.map(e=>this.cloneScanDir(e,i,r+1)),i}matchDirR(e,t,r,s,o){return i(this,void 0,void 0,(function*(){if(n.debug("Matching:",e.name),t.filter(t=>t.path===e.name).forEach(t=>{const r=a.default.join(t.path,t.name),i=e.files.find(e=>e.name===r);i?i.track=t:o.push(t)}),e.folder){const i=e.folder.id,a=r.filter(e=>e.parentID===i).sort((e,t)=>e.path.localeCompare(t.path));for(const i of a){const a=e.directories.find(e=>e.name===i.path);a?(a.folder=i,yield this.matchDirR(a,t,r,s,o)):s.push(i)}}}))}match(e){return i(this,void 0,void 0,(function*(){const t=yield this.store.trackStore.search({inPath:e.name}),r=yield this.store.folderStore.search({inPath:e.name}),i=this.cloneScanDir(e,void 0,0);i.folder=yield this.store.folderStore.searchOne({path:e.name});const s=[],a=[];yield this.matchDirR(i,t.items,r.items,s,a);for(const e of s){const t=yield this.store.folderStore.search({inPath:e.path});for(const e of t.items)s.find(t=>t.id===e.id)||s.push(e);const r=yield this.store.trackStore.search({inPath:e.path});for(const e of r.items)a.find(t=>t.id===e.id)||a.push(e)}return{rootMatch:i,removedTracks:a,removedFolders:s}}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(17),c=r(4),d=r(2),u=r(19),l=d.logger("IO.DirScanner");t.DirScanner=class{scanDirR(e,t,r){return i(this,void 0,void 0,(function*(){l.debug("Scanning:",e);const s={name:c.ensureTrailingPathSeparator(e),stat:{ctime:t.ctime.valueOf(),mtime:t.mtime.valueOf()},rootID:r,directories:[],files:[]},d=[],m=yield a.default.readdir(e);for(const t of m)if("."!==t[0]){const r=n.default.join(e,t),i=yield a.default.stat(r);if(i.isDirectory())d.push({dir:r,stat:i});else{const e={name:r,type:o.getFileType(r),stat:{ctime:i.ctime.valueOf(),mtime:i.mtime.valueOf(),size:i.size}};s.files.push(e)}}return d.length>0&&(yield u.processQueue(3,d,e=>i(this,void 0,void 0,(function*(){const t=yield this.scanDirR(e.dir,e.stat,r);s.directories.push(t)})))),s}))}scan(e,t){return i(this,void 0,void 0,(function*(){l.info("Scanning Root",e);const r=yield a.default.stat(e);return this.scanDirR(e,r,t)}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),n=s(r(3)),o=r(1),c=r(4),d=r(19);t.TrackWorker=class{constructor(e,t,r){this.store=e,this.imageModule=t,this.audioModule=r}writeTags(e){return i(this,void 0,void 0,(function*(){const t=[],r=yield this.store.trackStore.byIds(e.map(e=>e.trackID)),i=[];for(const s of r){const r=e.find(e=>e.trackID===s.id);if(r){t.push(s.id);const e=n.default.join(s.path,s.name);yield this.audioModule.writeRawTag(e,r.tag),i.includes(s.parentID)||i.push(s.parentID)}}return{changedTrackIDs:t,changedFolderIDs:i}}))}fix(e){return i(this,void 0,void 0,(function*(){const t=new Set,r=new Set,s=yield this.store.trackStore.byIds(e.map(e=>e.trackID)),a=[];for(const i of s)r.add(i.id),t.add(i.parentID),a.push({filename:n.default.join(i.path,i.name),fixIDs:e.filter(e=>e.trackID===i.id).map(e=>e.fixID)});return yield d.processQueue(3,a,e=>i(this,void 0,void 0,(function*(){for(const t of e.fixIDs)[o.TrackHealthID.mp3HeaderExists,o.TrackHealthID.mp3HeaderValid].includes(t)?yield this.audioModule.mp3.rewrite(e.filename):[o.TrackHealthID.mp3Garbage,o.TrackHealthID.mp3MediaValid].includes(t)?yield this.audioModule.mp3.fixAudio(e.filename):[o.TrackHealthID.id3v2NoId3v1].includes(t)&&(yield this.audioModule.mp3.removeID3v1(e.filename))}))),{changedFolderIDs:[...t],changedTrackIDs:[...r]}}))}rename(e,t){return i(this,void 0,void 0,(function*(){const r=c.replaceFileSystemChars(t,"").trim();if(0===r.length)return Promise.reject(Error("Invalid Name"));const i=yield this.store.trackStore.byId(e);if(!i)return Promise.reject(Error("Track not found"));const s=c.fileExt(r),o=c.fileExt(i.name);if(s!==o)return Promise.reject(Error(`Changing File extension not supported ${s}=>${o}`));const d=n.default.join(i.path,r);if(yield a.default.pathExists(d))return Promise.reject(Error("File already exists"));yield a.default.rename(n.default.join(i.path,i.name),n.default.join(i.path,r)),i.name=r,yield this.store.trackStore.replace(i)}))}delete(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.trackStore.byIds(t),i=n.default.join(e.path,".trash");for(const e of r)yield a.default.move(n.default.join(e.path,e.name),n.default.join(i,`${Date.now()}_${e.name}`));const s=[];for(const e of r)s.includes(e.parentID)||s.push(e.parentID);return{changedFolderIDs:s,changedTrackIDs:[],removedTracks:r}}))}move(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.store.trackStore.byIds(e),i=yield this.store.folderStore.byId(t);if(!i)return Promise.reject(Error("Destination Folder not found"));for(const e of r){if(e.parentID===t)return Promise.reject(Error("File is already in folder"));if(yield a.default.pathExists(n.default.join(i.path,e.name)))return Promise.reject(Error("File name is already used in folder"))}const s=[i.id],o=[];for(const e of r)o.push(e.id),s.includes(e.parentID)||s.push(e.parentID),yield a.default.move(n.default.join(e.path,e.name),n.default.join(i.path,e.name)),e.path=c.ensureTrailingPathSeparator(i.path),e.rootID=i.rootID,e.parentID=i.id;return yield this.store.trackStore.replaceMany(r),{changedTrackIDs:o,changedFolderIDs:s}}))}refresh(e){return i(this,void 0,void 0,(function*(){const t=yield this.store.trackStore.byIds(e),r=[],i=[];for(const e of t)i.includes(e.id)||i.push(e.id),r.includes(e.parentID)||r.push(e.parentID);return{changedFolderIDs:r,changedTrackIDs:i}}))}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(s,a){function n(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=r(246),a=r(247),n=r(248),o=r(249),c=r(250),d=r(251),u=r(252),l=r(253),m=r(254),p=r(255),f=r(256),y=r(257),h=r(258),g=r(259),v=r(260),b=r(261),k=r(262);t.Store=class{constructor(e){this.db=e,this.settingsStore=new g.SettingsStore(this.db),this.trackStore=new b.TrackStore(this.db),this.folderStore=new c.FolderStore(this.db),this.userStore=new k.UserStore(this.db),this.stateStore=new v.StateStore(this.db),this.playlistStore=new u.PlaylistStore(this.db),this.podcastStore=new m.PodcastStore(this.db),this.episodeStore=new o.EpisodeStore(this.db),this.bookmarkStore=new n.BookmarkStore(this.db),this.artistStore=new a.ArtistStore(this.db),this.albumStore=new s.AlbumStore(this.db),this.playQueueStore=new l.PlayQueueStore(this.db),this.radioStore=new p.RadioStore(this.db),this.rootStore=new f.RootStore(this.db),this.metaStore=new d.MetaDataStore(this.db),this.sessionStore=new h.SessionStore(this.db),this.seriesStore=new y.SeriesStore(this.db)}reset(){return i(this,void 0,void 0,(function*(){yield this.db.reset()}))}check(){return i(this,void 0,void 0,(function*(){yield this.db.check()}))}open(){return i(this,void 0,void 0,(function*(){yield this.db.open()}))}close(){return i(this,void 0,void 0,(function*(){yield this.db.close()}))}allStores(){return[this.folderStore,this.trackStore,this.albumStore,this.artistStore,this.podcastStore,this.episodeStore,this.seriesStore,this.playlistStore,this.radioStore,this.userStore,this.rootStore]}streamStores(){return[this.trackStore,this.episodeStore]}downloadStores(){return[this.folderStore,this.trackStore,this.albumStore,this.artistStore,this.podcastStore,this.episodeStore,this.seriesStore,this.playlistStore]}findInStores(e,t){return i(this,void 0,void 0,(function*(){for(const r of t){const t=yield r.byId(e);if(t)return t}}))}findInAll(e){return i(this,void 0,void 0,(function*(){for(const t of this.allStores()){const r=yield t.byId(e);if(r)return r}}))}findMultiInAll(e){return i(this,void 0,void 0,(function*(){let t=[];for(const r of this.allStores()){const i=yield r.byIds(e);t=t.concat(i)}return t}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={name:"name",artist:"artist",genre:"genres",year:"year",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.album,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("rootIDs",e.rootID),t.terms("rootIDs",e.rootIDs),t.term("trackIDs",e.trackID),t.terms("trackIDs",e.trackIDs),t.term("seriesID",e.seriesID),t.terms("seriesID",e.seriesIDs),t.term("albumType",e.albumType),t.terms("albumType",e.albumTypes),t.term("artistID",e.artistID),t.term("genres",e.genre),t.term("mbReleaseID",e.mbReleaseID),t.term("mbArtistID",e.mbArtistID),t.term("artist",e.artist),t.term("name",e.name),t.term("slug",e.slug),t.range("year",e.toYear,e.fromYear),t.range("created",void 0,e.newerThan),t.match("name",e.query),t.get(e,n)}}t.AlbumStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={name:"name",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.artist,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("name",e.name),t.terms("name",e.names),t.term("trackIDs",e.trackID),t.terms("trackIDs",e.trackIDs),t.term("seriesIDs",e.seriesID),t.terms("seriesIDs",e.seriesIDs),t.term("genres",e.genre),t.term("rootIDs",e.rootID),t.terms("rootIDs",e.rootIDs),t.term("albumTypes",e.albumType),t.terms("albumTypes",e.albumTypes),t.term("slug",e.slug),t.term("albumIDs",e.albumID),t.term("mbArtistID",e.mbArtistID),t.range("created",void 0,e.newerThan),t.match("name",e.query),t.get(e,n)}}t.ArtistStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={created:"created",position:"position"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.bookmark,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("position",e.position),t.term("userID",e.userID),t.term("destID",e.destID),t.terms("destID",e.destIDs),t.get(e,n)}}t.BookmarkStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={podcast:"podcastID",date:"date",name:"name",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.episode,e)}transformQuery(e){const t=new s.QueryHelper;return t.terms("podcastID",e.podcastIDs),t.term("podcastID",e.podcastID),t.term("status",e.status),t.term("name",e.name),t.range("date",void 0,e.newerThan),t.match("name",e.query),t.get(e,n)}}t.EpisodeStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(4),a=r(7),n=r(8),o={artist:"tag.artist",album:"tag.album",genre:"tag.genres",created:"stat.created",parent:"parentID",title:"tag.title",year:"tag.year"};class c extends n.BaseStore{constructor(e){super(i.DBObjectType.folder,e)}transformQuery(e){const t=new a.QueryHelper;return t.term("path",e.path),t.startsWiths("path",e.inPaths?e.inPaths.map(s.ensureTrailingPathSeparator):void 0),t.startsWith("path",e.inPath?s.ensureTrailingPathSeparator(e.inPath):void 0),t.term("tag.mbReleaseID",e.mbReleaseID),t.term("tag.mbArtistID",e.mbArtistID),t.term("tag.genres",e.genre),t.term("tag.title",e.title),t.term("tag.album",e.album),t.term("rootID",e.rootID),t.terms("rootID",e.rootIDs),t.term("parentID",e.parentID),t.terms("parentID",e.parentIDs),t.term("tag.level",e.level),t.term("tag.artist",e.artist),t.terms("tag.artist",e.artists),t.term("tag.type",e.type),t.terms("tag.type",e.types),t.range("tag.year",e.toYear,e.fromYear),t.range("stat.created",void 0,e.newerThan),t.match("tag.title",e.query),t.get(e,o)}}t.FolderStore=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8);class n extends a.BaseStore{constructor(e){super(i.DBObjectType.metadata,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("name",e.name),t.term("dataType",e.dataType),t.range("date",e.olderThan,void 0),t.get(e)}}t.MetaDataStore=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={name:"name",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.playlist,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("trackIDs",e.trackID),t.terms("trackIDs",e.trackIDs),t.term("userID",e.userID),t.term("name",e.name),t.bool("isPublic",e.isPublic),t.match("name",e.query),t.range("created",void 0,e.newerThan),t.get(e,n)}}t.PlaylistStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8);class n extends a.BaseStore{constructor(e){super(i.DBObjectType.playqueue,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("userID",e.userID),t.get(e)}}t.PlayQueueStore=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={title:"tag.title",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.podcast,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("url",e.url),t.term("tag.title",e.title),t.term("status",e.status),t.range("created",void 0,e.newerThan),t.match("tag.title",e.query),t.get(e,n)}}t.PodcastStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={name:"name",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.radio,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("url",e.url),t.term("homepage",e.homepage),t.term("name",e.name),t.match("name",e.query),t.get(e,n)}}t.RadioStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={name:"name",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.root,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("name",e.name),t.term("path",e.path),t.match("name",e.query),t.get(e,n)}}t.RootStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={name:"name",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.series,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("rootIDs",e.rootID),t.terms("rootIDs",e.rootIDs),t.term("trackIDs",e.trackID),t.terms("trackIDs",e.trackIDs),t.term("folderIDs",e.folderID),t.terms("folderIDs",e.folderIDs),t.term("albumIDs",e.albumID),t.terms("albumIDs",e.albumIDs),t.term("albumTypes",e.albumType),t.terms("albumTypes",e.albumTypes),t.term("artistID",e.artistID),t.term("name",e.name),t.range("created",void 0,e.newerThan),t.match("name",e.query),t.get(e,n)}}t.SeriesStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8);class n extends a.BaseStore{constructor(e){super(i.DBObjectType.session,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("jwth",e.jwth),t.term("mode",e.mode),t.term("sessionID",e.sessionID),t.term("userID",e.userID),t.term("client",e.client),t.get(e)}}t.SessionStore=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8);class n extends a.BaseStore{constructor(e){super(i.DBObjectType.settings,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("section",e.section),t.get(e)}}t.SettingsStore=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8);class n extends a.BaseStore{constructor(e){super(i.DBObjectType.state,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("userID",e.userID),t.term("destID",e.destID),t.terms("destID",e.destIDs),t.term("destType",e.type),t.notNull("faved",e.isFaved),t.range("rated",e.maxRating,e.minRating),t.range("played",void 0,e.isPlayed?1:void 0),t.get(e)}}t.StateStore=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(4),a=r(7),n=r(8),o={artist:"tag.artist",album:"tag.album",albumartist:"tag.albumArtist",genre:"tag.genre",parent:"path",title:"tag.title",year:"tag.year",created:"stat.created"};class c extends n.BaseStore{constructor(e){super(i.DBObjectType.track,e)}transformQuery(e){const t=new a.QueryHelper;return t.terms("parentID",e.parentIDs),t.term("path",e.path),t.startsWiths("path",e.inPaths?e.inPaths.map(s.ensureTrailingPathSeparator):void 0),t.startsWith("path",e.inPath?s.ensureTrailingPathSeparator(e.inPath):void 0),t.term("tag.genre",e.genre),t.term("rootID",e.rootID),t.terms("rootID",e.rootIDs),t.term("parentID",e.parentID),t.term("tag.mbTrackID",e.mbTrackID),t.terms("tag.mbTrackID",e.mbTrackIDs),t.term("tag.artist",e.artist),t.term("tag.title",e.title),t.match("tag.title",e.query),t.term("tag.album",e.album),t.term("artistID",e.artistID),t.terms("artistID",e.artistIDs),t.term("seriesID",e.seriesID),t.terms("seriesID",e.seriesIDs),t.term("albumArtistID",e.albumArtistID),t.terms("albumArtistID",e.albumArtistIDs),t.term("albumID",e.albumID),t.terms("albumID",e.albumIDs),t.range("tag.year",e.toYear,e.fromYear),t.range("stat.created",void 0,e.newerThan),t.get(e,o)}}t.TrackStore=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),s=r(7),a=r(8),n={name:"name",created:"created"};class o extends a.BaseStore{constructor(e){super(i.DBObjectType.user,e)}transformQuery(e){const t=new s.QueryHelper;return t.term("name",e.name),t.bool("roles.admin",e.isAdmin),t.match("name",e.query),t.get(e,n)}}t.UserStore=o}]);
//# sourceMappingURL=jamserve.js.map